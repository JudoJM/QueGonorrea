"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9008],{29008:function(e,l,a){a.d(l,{e:function(){return G}});var t=a(74817),r=a(71248),s=a(26991),n=a(76785),d=a(6561),i=a(32014),o=a(78301);let c=(0,r.memo)(e=>{let{message:l}=e,a=(0,r.useMemo)(()=>(0,o.OA)(l.content),[l.content]);return a?(0,t.jsx)("div",{children:(0,t.jsx)(s.p,{children:e=>{var l;let{open:r}=e;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(s.p.Button,{className:"flex flex-row gap-1 py-2",children:[(0,t.jsx)(n.Z,{className:"".concat(r?"rotate-90 transform":"")}),(0,t.jsx)("span",{className:"text-left",children:"Found a similar public Loop that we can use as a reference! ".concat(r?"":"(click to expand)")})]}),(0,t.jsx)(s.p.Panel,{children:(0,t.jsxs)("div",{className:"flex flex-col space-y-2 pl-8",children:[(null==a?void 0:a.name)&&(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("label",{className:"font-semibold underline",children:"Name"}),(0,t.jsx)("label",{className:"text-sm",children:null==a?void 0:a.name})]}),(null==a?void 0:a.description)&&(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("label",{className:"font-semibold underline",children:"Description"}),(0,t.jsx)("label",{className:"text-sm",children:null==a?void 0:a.description})]}),(null==a?void 0:a.blocks)&&(null==a?void 0:a.blocks.length)>0&&(0,t.jsx)("div",{className:"flex flex-col pt-2",children:null==a?void 0:null===(l=a.blocks)||void 0===l?void 0:l.map((e,l)=>(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsxs)("div",{className:"flex flex-col space-y-2 rounded-lg border border-gray-300 px-3 py-2",children:[(0,t.jsx)("label",{className:"font-semibold text-sky-500",children:"".concat((0,i.jS)(e.type))}),(0,t.jsx)("div",{className:"flex overflow-hidden rounded-lg bg-transparent pl-2 text-sm text-black/80 focus:outline-none",children:(0,t.jsx)("p",{children:e.description})})]}),l+1<a.blocks.length&&(0,t.jsx)("div",{className:"flex items-center justify-center text-gray-300",children:(0,t.jsx)(d.Z,{size:24,strokeWidth:2})})]},"block-".concat(l)))})]})})]})}})}):(0,t.jsx)("div",{className:"flex flex-col space-y-2 py-2",children:(0,t.jsx)("span",{children:"Unable to parse reference Loop :("})})});c.displayName="Reference Loop";var x=a(69054),u=a(82172),m=a(12947),b=a(32068),g=a(37943),h=a(76422),p=a(38),f=a(82691),v=a(72826),k=a(28321),y=a(21216),j=a(50141);let N=e=>{let{message:l}=e,[a,s]=(0,r.useState)(!1);try{let{elementName:e,html:r,tagName:n}=JSON.parse(l.content);return(0,t.jsxs)("div",{className:"w-full max-w-lg",children:[(0,t.jsxs)("div",{className:"mb-3 flex cursor-pointer items-center gap-2 rounded-lg border-2 border-purple-300 bg-purple-100 p-3 dark:border-purple-700 dark:bg-purple-900",onClick:()=>s(!a),children:[(0,t.jsx)(v.Z,{className:"h-4 w-4 text-purple-600 dark:text-purple-400"}),(0,t.jsxs)("span",{className:"font-medium text-purple-800 dark:text-purple-200",children:["Selected Component: ",e]}),a?(0,t.jsx)(k.Z,{className:"ml-auto h-4 w-4 text-purple-600 dark:text-purple-400"}):(0,t.jsx)(y.Z,{className:"ml-auto h-4 w-4 text-purple-600 dark:text-purple-400"})]}),a&&(0,t.jsxs)("div",{className:"mb-3 rounded-lg border border-gray-200 bg-gray-50 p-3 dark:border-gray-600 dark:bg-gray-800",children:[(0,t.jsx)("div",{className:"mb-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:"Element Code:"}),(0,t.jsx)("pre",{className:"overflow-x-auto rounded bg-gray-100 p-2 text-xs text-gray-600 dark:bg-gray-900 dark:text-gray-400",children:r.length>300?"".concat(r.substring(0,300),"..."):r})]}),(0,t.jsxs)("div",{className:"rounded-lg border border-blue-200 bg-blue-50 p-4 dark:border-blue-700 dark:bg-blue-900/30",children:[(0,t.jsxs)("p",{className:"text-sm font-medium text-blue-800 dark:text-blue-200",children:["\uD83D\uDCAC What would you like to change about this ",n,"?"]}),(0,t.jsx)("p",{className:"mt-1 text-xs text-blue-600 dark:text-blue-400",children:"Type your changes in the chat below and I'll update the element for you."})]})]})}catch(e){return(0,t.jsx)("div",{className:"text-sm text-red-500",children:"Error parsing element data"})}},w=(0,r.memo)(e=>{let{message:l,messageIndex:a}=e;return"element-selected"===l.type?(0,t.jsx)("div",{className:"prose dark:text-gray-300 sm:pr-[20px]",children:(0,t.jsx)(N,{message:l})}):(0,t.jsx)("div",{className:"prose dark:text-gray-300 sm:pr-[20px]",children:(0,t.jsx)(j.s,{components:{table(e){let{children:l}=e;return(0,t.jsx)("table",{className:"border-collapse border border-black px-3 py-1 dark:border-gray-700",children:l})},th(e){let{children:l}=e;return(0,t.jsx)("th",{className:"break-words border border-black bg-[#9ca3af] px-3 py-1 text-white dark:border-gray-700 dark:bg-gray-700 dark:text-gray-200",children:l})},td(e){let{children:l}=e;return(0,t.jsx)("td",{className:"break-words border border-black px-3 py-1 text-black dark:border-gray-700 dark:text-gray-300",children:l})}},children:null==l?void 0:l.content})})});w.displayName="Message";var C=a(20117),S=a(29386),E=a(17724),O=a(34880),F=a(65414),L=a(51254);let Z=e=>{let{message:l,isLast:a,streaming:s,onError:n,onCreateBlock:d}=e,[i,c]=(0,r.useState)(null);return((0,r.useEffect)(()=>{try{let e=l.content.replace(/\s+/g," ").trim(),a=(0,o.OA)(e);if(a&&"object"==typeof a){let e={blockIndex:a.blockIndex,type:a.type,description:a.description,outputName:a.outputName};void 0!==e.blockIndex&&e.type&&e.description&&e.outputName&&c(e)}}catch(e){c(null)}},[l.content,n]),i)?(0,t.jsxs)(O.Zb,{className:"w-full border-secondary/30 bg-secondary/20",children:[(0,t.jsx)(O.Ol,{className:"pb-2",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(O.ll,{className:"text-lg font-medium",children:"Adding New Block"}),(0,t.jsxs)(E.C,{variant:"outline",className:"text-xs",children:["Position: ",i.blockIndex+1]})]})}),(0,t.jsxs)(O.aY,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsx)(E.C,{children:i.type})}),(0,t.jsxs)("div",{className:"mt-2 text-sm",children:[(0,t.jsx)("p",{className:"text-muted-foreground",children:"Description:"}),(0,t.jsx)("p",{className:"mt-1",children:i.description})]})]}),!s&&a&&(0,t.jsx)("div",{className:"flex justify-center pt-4",children:(0,t.jsx)(F.z,{onClick:()=>{try{null==d||d(i)}catch(e){n(e)}},className:"bg-[#FFA51E] text-white hover:bg-amber-500",children:"Looks Good"})})]})]}):(0,t.jsx)(O.Zb,{className:"w-full border-secondary/30 bg-secondary/20",children:(0,t.jsx)(O.aY,{className:"p-4",children:(0,t.jsx)(L.Z,{})})})};var B=a(71390);let R=(0,r.memo)(e=>{let{message:l,index:a,isLast:r,chatStatus:s,chatStyle:n,genMsgIndex:d,genState:i,genControls:v,loop:k,setChatError:y,handleLoopUpdate:j,handleUpdateMessage:N,handleCreateLoop:E,handleCreateVar:O,handleRegenerateCurBlock:F,handleUploadFiles:L,handleActivateLoop:R,handleCreateBlock:D}=e,_=!v||(null==i?void 0:i.status)==="done"||(0,C.lU)(i),U=e=>{let t=(0,o.OA)(l.content),r={...l,content:JSON.stringify({...t,details:e})};null==N||N(a,r)};switch(null==l?void 0:l.type){case"referenceLoop":return B.env.NEXT_PUBLIC_DEBUG_PROMPT?(0,t.jsx)(c,{message:l},a):null;case"outline":let I=d===a;return(0,t.jsx)(x.O,{message:l,isLast:r,state:I?i:void 0,streaming:"messaging"===s,onError:e=>y((0,S.f0)(e)),onCreateLoop:e=>null==E?void 0:E(a,e),onPause:I?null==v?void 0:v.pause:void 0,onResume:I?()=>{null==v||v.setLoop(k,!0),null==v||v.resume()}:void 0,onNextStep:I?()=>{null==v||v.setLoop(k,!0),null==v||v.runOneStep()}:void 0},a);case"validate":let M=(0,o.OA)(l.content);switch(null==M?void 0:M.decision){case"correct":return(0,t.jsx)(u.o,{justification:null==M?void 0:M.justification,isLast:r,streaming:"messaging"===s},a);case"incorrect-needs-rewrite":return F?(0,t.jsx)(m.g,{details:M.details,streaming:"messaging"===s,isLast:r,loop:k,handleLoopUpdate:j,disabled:_,blockResult:null==i?void 0:i.blockResult,onError:e=>y((0,S.f0)(e)),onContinue:null==v?void 0:v.resume,onRewriteBlock:F,onUpdateDetails:e=>U(e)},a):null;case"incorrect-needs-variable":return O?(0,t.jsx)(b.s,{details:M.details,streaming:"messaging"===s,isLast:r,loop:k,handleLoopUpdate:j,disabled:_,onError:e=>y((0,S.f0)(e)),onCreateVar:O,onUpdateDetails:e=>U(e)},a):null;case"incorrect-needs-user-intervention":return v?(0,t.jsx)(g.a,{details:M.details,isLast:r,disabled:_,streaming:"messaging"===s,onError:e=>y((0,S.f0)(e)),onContinue:()=>{null==v||v.setLoop(k,!0),null==v||v.resume("fix")},onFixLoop:()=>{null==v||v.setLoop(k,!0),null==v||v.start()}},a):null;case"incorrect-needs-file-upload":return L?(0,t.jsx)(h.N,{streaming:"messaging"===s,isLast:r,disabled:_,loopId:k.id,onError:e=>y((0,S.f0)(e)),onFilesUploaded:e=>L(e,k,j)},a):null;default:return(0,t.jsx)(p.D,{justification:null==M?void 0:M.justification,isLast:r,streaming:"messaging"===s},a)}case"success":return(0,t.jsx)(f.A,{isLast:r,disabled:(0,C.lU)(i),onError:e=>y((0,S.f0)(e)),onPublish:R},a);case"addBlock":return(0,t.jsx)(Z,{message:l,isLast:r,streaming:"messaging"===s,onError:e=>y((0,S.f0)(e)),onCreateBlock:D},a);default:return(0,t.jsx)(w,{message:l,messageIndex:a},a)}});R.displayName="MessageContent";var D=a(91835);let _=e=>{let{onClick:l,className:a,title:r,style:s,disabled:n,shape:d,type:i,children:o}=e;return(0,t.jsx)(D.Z,{content:r,children:(0,t.jsx)("button",{className:"".concat("round"===d?"h-[34px] w-[34px] rounded-full":"h-[40px] rounded-lg px-4 py-1"," ").concat("bright"===i?"text-white border border-black/5 enabled:hover:border-black/20 bg-cyan-500 disabled:opacity-50":"black"===i?"text-white border-none bg-black/50 enabled:hover:bg-black/70 disabled:opacity-50":"text-black border border-black/10 enabled:hover:border-black/20 bg-white disabled:opacity-50"," pointer-events-auto m-1 flex items-center justify-center text-sm font-medium transition ").concat(a),style:s,onClick:l,disabled:n,children:o})})};var U=a(51827),I=a(90955),M=a(48694),z=a(48120),A=a(77797),T=a(28696),q=a(39966);let P=e=>{let{chatStyle:l,messageIsStreaming:a,showScrollToBottom:s,showRegenerate:n,showContinue:d,showStop:i,initInput:o,onError:c,onScrollToBottom:x,onSend:u,onRegenerate:m,onContinue:b,onStopGenerating:g}=e,[h,p]=(0,r.useState)(void 0),f=(0,r.useRef)(null);(0,r.useEffect)(()=>{void 0!==o&&void 0===h&&p(o)},[h,o]),(0,r.useEffect)(()=>{f.current&&f.current.focus()},[]);let v=(0,r.useCallback)(()=>{!a&&h&&0!==h.trim().length&&(u({role:"user",type:"text",content:h}),p(""))},[a,h,u]),k=(0,r.useCallback)(()=>{let e=[];return s&&e.push((0,t.jsx)(_,{onClick:x,shape:"round",type:"unfilled",disabled:!s,className:"bg-gray-200 text-black hover:bg-gray-300 dark:bg-gray-800 dark:text-white dark:hover:bg-gray-700",title:"Scroll to bottom",children:(0,t.jsx)(I.Z,{size:18})},"scroll-to-bottom")),!a&&(d&&e.push((0,t.jsx)(_,{onClick:b,shape:"round",type:"unfilled",disabled:a||!d,className:"bg-gray-200 text-black hover:bg-gray-300 dark:bg-gray-800 dark:text-white dark:hover:bg-gray-700",title:"Continue last message",children:(0,t.jsx)(M.Z,{size:16})},"continue")),n&&e.push((0,t.jsx)(_,{onClick:m,shape:"round",type:"unfilled",disabled:a||!n,className:"bg-gray-200 text-black hover:bg-gray-300 dark:bg-gray-800 dark:text-white dark:hover:bg-gray-700",title:"Regenerate last message",children:(0,t.jsx)(z.Z,{size:16})},"regenerate"))),(null!=h?h:"").length>0&&e.push((0,t.jsx)(_,{onClick:()=>p(""),title:"Clear Input",shape:"round",type:"unfilled",className:"bg-gray-200 text-black hover:bg-gray-300 dark:bg-gray-800 dark:text-white dark:hover:bg-gray-700",disabled:0===(null!=h?h:"").length,children:(0,t.jsx)(A.Z,{size:18})},"clear-input")),e},[s,a,h,x,d,n,b,m]),y=(0,r.useMemo)(()=>k(),[k]);return(0,t.jsx)("div",{className:"group text-black dark:text-white",style:{overflowWrap:"anywhere"},children:(0,t.jsx)("div",{className:"relative m-auto flex w-full text-base ".concat("full"===l?"md:w-3/4 lg:w-1/2 2xl:w-2/5":""," gap-2 px-2 py-2"),style:{borderStyle:"solid"},children:(0,t.jsx)("div",{className:"w-full rounded-lg border border-dashed border-black/20 bg-white p-2 hover:border-black/30 hover:outline-none focus:border-black/30 dark:border-gray-700 dark:bg-[#1f1f1f] hover:dark:border-gray-500 focus:dark:border-gray-500",children:(0,t.jsxs)("div",{className:"flex w-full flex-col",children:[(0,t.jsx)(U.Z,{ref:f,includeBorders:!1,textClassName:"text-black dark:text-white focus:outline-none",placeholder:"Not quite right? Tell us more",value:h,onChange:p,onKeyDown:e=>{let l="ontouchstart"in window;"Enter"!==e.key||l||e.shiftKey?"Escape"===e.key&&a&&(e.preventDefault(),g()):(e.preventDefault(),v())},minRowCount:1}),(0,t.jsxs)("div",{className:"flex w-full flex-row justify-between",children:[(0,t.jsx)("div",{className:"items-left pointer-events-auto flex flex-row gap-1 transition duration-100",children:y}),a&&i?(0,t.jsx)(_,{title:"Stop generating message (esc)",shape:"round",type:"bright",onClick:g,className:"bg-gray-200 text-black hover:bg-gray-300 dark:bg-gray-800 dark:text-white dark:hover:bg-gray-700",children:(0,t.jsx)(T.Z,{size:16})},"stop-generating"):(0,t.jsx)(_,{title:"Send Message (enter)",disabled:0===(null!=h?h:"").length||a,shape:"round",type:"bright",onClick:v,className:"bg-sky-600 text-black hover:bg-sky-500 dark:bg-sky-700 dark:text-white dark:hover:bg-sky-600",children:(0,t.jsx)(q.Z,{size:16})},"send-message")]})]})})})})},V=(0,r.memo)(e=>{let{chatStyle:l,message:a,children:s}=e,[n,d]=(0,r.useState)("\uD83D\uDC69‍\uD83D\uDCBB");return(0,r.useEffect)(()=>{let e=localStorage.getItem("selectedEmoji");e&&d(e)},[]),(0,t.jsx)("div",{className:"group w-full border-b-[1px] border-[#F1F1F1] bg-[#FEFCF8] dark:border-gray-700 dark:bg-[#1f1f1f]",style:{overflowWrap:"anywhere"},children:(0,t.jsxs)("div",{className:"relative m-auto flex ".concat("full"===l?"md:w-3/4 lg:w-1/2 2xl:w-2/5":"max-w-[580px]"," gap-2 py-6 text-base"),children:[(0,t.jsx)("div",{className:"hidden h-[40px] w-[40px] text-right font-bold md:block",children:(0,t.jsx)("span",{className:"h-5 w-auto cursor-default text-3xl",children:(null==a?void 0:a.role)==="user"?n:"\uD83E\uDE84"})}),(0,t.jsxs)("div",{className:"w-full pl-1 pr-4",children:[(0,t.jsx)("div",{className:"flex flex-row justify-between",children:(0,t.jsx)("div",{className:"text-xs italic text-black/60 dark:text-gray-400",children:(null==a?void 0:a.role)==="user"?"You":"Loop Creator"})}),s]})]})})});V.displayName="Container";var W=a(43685);let K=e=>{let{onClick:l}=e;return(0,t.jsxs)("button",{className:"absolute bottom-[110px] left-1/2 z-10 flex -translate-x-1/2 transform items-center justify-center rounded-full bg-white p-2 shadow-md transition-opacity duration-200 hover:bg-gray-200 focus:outline-none dark:bg-[#2b2b2b] dark:hover:bg-[#3c3c3c]",onClick:l,children:[(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-black dark:text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})}),(0,t.jsx)("span",{className:"ml-2 text-sm text-black dark:text-gray-300",children:"Scroll to bottom"})]})},G=(0,r.memo)(e=>{let{loop:l,loopGen:a,localMsgs:s,chatStatus:n,chatError:d,chatStyle:i,genMsgIndex:o,genState:c,genControls:x,setChatError:u,handleLoopUpdate:m,handleUpdateMessage:b,handleSendMessage:g,handleStopMessage:h,handleCreateVar:p,handleCreateLoop:f,handleRegenerateCurBlock:v,handleActivateLoop:k,handleCreateBlock:y,handleUploadFiles:j}=e,N=(0,r.useRef)(!1),[w,C]=(0,r.useState)(!1),[S,E]=(0,r.useState)(!0),[O,F]=(0,r.useState)(!0),Z=(0,r.useRef)(null),B=(0,r.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Z.current&&(Z.current.scrollIntoView({behavior:e?"smooth":"auto",block:"end"}),F(!0))},[]);(0,r.useEffect)(()=>{B(!1)},[s,n,B]),(0,r.useEffect)(()=>{if(!S){let e=setTimeout(()=>{B(!0)},100);return()=>clearTimeout(e)}},[s,n,B,S]),(0,r.useLayoutEffect)(()=>{S&&(B(!1),E(!1))},[S,B]),(0,r.useEffect)(()=>{let e=new ResizeObserver(()=>{S||B(!0)});return Z.current&&e.observe(Z.current),()=>{e.disconnect()}},[S,B]),(0,r.useEffect)(()=>{let e=setTimeout(()=>{C(!s||0===s.length)},500);return()=>clearTimeout(e)},[s]),(0,r.useEffect)(()=>{var e,t;if(!a||N.current)return;N.current=!0;let r=a.userInput||l.description,s=null==a?void 0:null===(e=a.messages)||void 0===e?void 0:e.some(e=>"ai"===e.role&&"referenceLoop"!==e.type),n=(null!==(t=l.blocks)&&void 0!==t?t:[]).length>=2;s||n||!r||g({role:"user",type:"text",content:r})},[a,l,g]);let D=(0,r.useCallback)(()=>{if(Z.current){let{scrollTop:e,scrollHeight:l,clientHeight:a}=Z.current.parentElement||document.documentElement;F(1>Math.abs(l-a-e))}},[]);(0,r.useEffect)(()=>{var e;let l=null===(e=Z.current)||void 0===e?void 0:e.parentElement;if(l)return l.addEventListener("scroll",D),()=>l.removeEventListener("scroll",D)},[D]);let _=0===(null!=s?s:[]).length;return(0,t.jsxs)("div",{className:"flex h-full w-full flex-col bg-[#FEFCF8] dark:bg-[#1f1f1f]",children:[(0,t.jsxs)("div",{className:"relative flex-grow overflow-y-auto px-4",children:[_&&w&&(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4 p-10 md:p-20",children:[(0,t.jsx)("label",{className:"text-3xl text-black/80 dark:text-gray-300",children:"\uD83E\uDE84"}),(0,t.jsx)("label",{className:"text-center italic text-black/40 dark:text-gray-500",children:"Try sending a message to the Loop Creator to help you get started!"})]}),null==s?void 0:s.map((e,a)=>(null==e?void 0:e.type)==="referenceLoop"?null:(0,t.jsx)(V,{chatStyle:i,message:e,children:(0,t.jsx)(R,{message:e,index:a,isLast:a===s.length-1,chatStatus:n,chatStyle:i,genMsgIndex:o,genState:c,genControls:x,loop:l,setChatError:u,handleLoopUpdate:m,handleUpdateMessage:b,handleCreateLoop:f,handleCreateVar:p,handleRegenerateCurBlock:v,handleActivateLoop:k,handleCreateBlock:y,handleUploadFiles:e=>j&&j(e,l,m)})},a)),"messaging"===n&&(null==s||!s.length||(null==s?void 0:s.length)<2)&&(0,t.jsx)("div",{className:"flex flex-row items-center justify-center gap-2 p-2 text-sm italic text-black dark:text-gray-300",children:(0,t.jsx)(W.Z,{})}),"messaging"===n&&(null==s||!s.length||(null==s?void 0:s.length)>=2)&&(0,t.jsx)("div",{className:"flex flex-row items-center justify-center gap-2 p-2 text-sm italic text-black dark:text-gray-300",children:(0,t.jsx)(L.Z,{size:"20"})}),(0,t.jsx)("div",{ref:Z,style:{minHeight:"1px"}})]}),d&&(0,t.jsx)("div",{className:"border-t border-gray-200 p-2 text-start text-sm italic text-red-600 dark:border-gray-700",children:null!=d?d:"Unknown error"}),(0,t.jsxs)("div",{className:"relative",children:[!O&&(0,t.jsx)(K,{onClick:()=>B(!0)}),"loading"===n&&(0,t.jsxs)("div",{className:"flex flex-row items-center justify-center gap-2 p-2 text-sm italic text-black dark:text-gray-300",children:[(0,t.jsx)(L.Z,{size:"20"}),(0,t.jsx)("label",{children:"Creating Loop..."})]}),(0,t.jsx)(P,{chatStyle:i,messageIsStreaming:"idle"!==n,showScrollToBottom:!1,showRegenerate:!1,showContinue:!1,showStop:!0,initInput:"",onSend:g,onStopGenerating:h,onError:()=>{},onScrollToBottom:()=>{},onContinue:()=>{},onRegenerate:()=>{}})]})]})});G.displayName="Chat"},69054:function(e,l,a){a.d(l,{O:function(){return j}});var t=a(74817),r=a(70643),s=a.n(r),n=a(71248),d=a(19249),i=a(81173),o=a(66202),c=a.n(o),x=e=>{let{className:l}=e;return(0,t.jsx)("div",{className:c()("rounded bg-gray-300","animate-pulse",l),children:"\xa0 "})},u=a(49888),m=a.n(u),b=a(6561),g=a(4901),h=a(32014),p=e=>{let{baseBlock:l,index:a,displayedBlocksLength:r,containerClassName:s=""}=e,[d,i]=(0,n.useState)(!1),o=()=>{i(!d)};return(0,t.jsxs)("div",{className:"flex flex-col ".concat(s),children:[(0,t.jsx)("div",{className:"flex flex-col space-y-2 rounded-[14px] border-2 border-black bg-[#fdf6e9] p-3 text-[15px] shadow-[2px_2px_0_0_rgba(0,0,0,1)] dark:bg-[#374151]",children:(0,t.jsxs)("div",{className:"text-md flex flex-col rounded-lg bg-transparent py-2 pl-2 text-[#504C46] dark:text-white ".concat(m().variable," overflow-hidden focus:outline-none"),children:[(0,t.jsx)("p",{className:"".concat(m().variable," pb-2 font-alata font-bold"),children:(0,h.jS)(l.type)}),(0,t.jsx)("p",{className:"".concat(m().variable," font-alata"),children:(()=>{var e;if(d)return null==l?void 0:l.description;let a=null==l?void 0:null===(e=l.description)||void 0===e?void 0:e.substring(0,150);return(null==l?void 0:l.description)&&l.description.length>150?(0,t.jsxs)(t.Fragment,{children:[a,(0,t.jsx)("span",{onClick:o,className:"m1-1 cursor-pointer text-blue-500",children:"[...]"})]}):null==l?void 0:l.description})()})]})}),!(0,g.SC)(l)&&(0,t.jsx)("div",{className:"flex items-center justify-center text-gray-300",children:(0,t.jsx)(b.Z,{size:24,strokeWidth:2})}),!(0,g.SC)(l)&&a===r-1&&(0,t.jsx)("div",{className:"flex flex-col space-y-2 rounded-[14px] border-2 border-black bg-[#fdf6e9] p-3 text-[15px] shadow-[2px_2px_0_0_rgba(0,0,0,1)] dark:bg-[#374151]",children:(0,t.jsxs)("div",{className:"text-md flex flex-col rounded-lg bg-transparent py-2 pl-2 text-[#504C46] dark:text-white/40 ".concat(m().variable," overflow-hidden focus:outline-none"),children:[(0,t.jsx)(x,{className:"mb-2 w-[120px]"}),(0,t.jsx)(x,{className:""})]})})]})},f=a(51254),v=a(20117),k=a(78301),y=a(19760);let j=(0,n.memo)(e=>{var l,a,r,o;let{message:c,isLast:u,state:m,streaming:b,autoGen:g=!1,onError:h,onCreateLoop:j,onResume:N,onNextStep:w,onPause:C}=e,{t:S}=(0,d.Z)("loop"),[E,O]=(0,n.useState)({name:"",description:"",exampleInput:void 0,variables:[],blockOutline:[]});(0,n.useEffect)(()=>{let e=(0,k.OA)(c.content);e&&O(e),b||e||!u||(h(S("chatOutline.error_parse")),O({name:S("chatOutline.unknown"),description:S("chatOutline.error_description"),exampleInput:void 0,variables:[],blockOutline:[]}))},[u,c.content,h,b,S]);let F=(0,n.useCallback)((e,l,a)=>(0,t.jsx)(i.Z,{disabled:!l,onClick:()=>{try{null==l||l()}catch(e){h(e)}},className:"mt-4 disabled:opacity-50 ".concat(null!=a?a:"bg-[#FFA51E] enabled:hover:bg-amber-500"),children:e}),[h]),L=(0,n.useCallback)(e=>(0,t.jsx)("label",{className:"text-xs italic text-black/40",children:e}),[]);return(0,t.jsxs)("div",{className:"flex flex-col py-2",children:[(null==E?void 0:E.name)&&(0,t.jsx)("div",{className:"flex flex-row items-center justify-center",children:(0,t.jsx)("div",{className:"mb-1 rounded-none bg-transparent p-2 p-4 px-[16px] py-[6px] pl-2",children:(0,t.jsx)("p",{className:"".concat(s().variable," flex items-center font-alata text-lg leading-[24px] text-gray-700 dark:text-gray-300"),children:(null==E?void 0:E.name)+" ".concat(S("chatOutline.outline"))})})}),(null==E?void 0:E.blockOutline)&&(null==E?void 0:E.blockOutline.length)>0&&(0,t.jsxs)("div",{className:"flex flex-col items-center pt-2",children:[null==E?void 0:null===(l=E.blockOutline)||void 0===l?void 0:l.map((e,l)=>(0,t.jsx)(p,{baseBlock:e,containerClassName:"w-full",index:l,displayedBlocksLength:null==E?void 0:E.blockOutline.length},"index-"+l)),(null==E?void 0:null===(a=E.blockOutline)||void 0===a?void 0:a.length)===0&&(0,t.jsx)("div",{className:"flex flex-col space-y-2 rounded-[14px] border border-[#D7D3CC] bg-white px-3 py-2 text-[15px] dark:border-[#3E3E3E] dark:bg-[#1F1F1F]",children:(0,t.jsxs)("div",{className:"text-md flex flex-col rounded-lg bg-transparent py-2 pl-2 text-[#504C46] dark:text-gray-300 ".concat(s().variable," overflow-hidden focus:outline-none"),children:[(0,t.jsx)(x,{className:"mb-2 w-[120px]"}),(0,t.jsx)(x,{className:""})]})}),(0,t.jsxs)("div",{className:"flex w-full flex-col items-center gap-2",children:[(null==m?void 0:m.status)==="running"&&(0,t.jsxs)(t.Fragment,{children:[F(S("chatOutline.stop"),C,"text-black dark:text-white bg-gray-200 dark:bg-[#2A2A2A] enabled:hover:bg-gray-300 dark:enabled:hover:bg-gray-400 border border-gray-300 dark:border-gray-600"),L("".concat(null!==(o=v.qm[null!==(r=m.blockStatus)&&void 0!==r?r:""])&&void 0!==o?o:S("chatOutline.workingOn")," block #").concat((null==m?void 0:m.curBlockIndex)+1).concat((null==m?void 0:m.numFixesOnBlock)?" (".concat(null==m?void 0:m.numFixesOnBlock," of ").concat(y.Hh,")"):"")),(0,t.jsx)(f.Z,{className:"text-black/40 dark:text-gray-500",size:"16"})]}),(null==m?void 0:m.status)==="pausing"&&(0,t.jsxs)(t.Fragment,{children:[F(S("chatOutline.resume"),()=>null==N?void 0:N()),L(S("chatOutline.waitingToPause"))]}),(null==m?void 0:m.status)==="paused"&&(0,t.jsxs)("div",{className:"flex gap-2",children:[F(S("chatOutline.resume"),()=>null==N?void 0:N()),F(S("chatOutline.nextStep"),()=>null==w?void 0:w()),F(S("chatOutline.restart"),()=>j(!0))]}),(null==m?void 0:m.status)==="done"&&(0,t.jsxs)(t.Fragment,{children:[F(S("chatOutline.recreateLoop"),()=>j(!0)),L(S("chatOutline.finished"))]})]})]}),(null==E?void 0:E.description)&&(0,t.jsx)("div",{className:"items center flex flex-row justify-center pt-4",children:(0,t.jsx)("div",{className:"px-[16px] py-[6px]",children:(0,t.jsx)("p",{className:"".concat(s().variable," font-alata text-[17px] leading-[24px] text-black/90 dark:text-gray-300"),children:null==E?void 0:E.description})})}),!g&&!b&&(!m||(null==m?void 0:m.status)==="not-started")&&(0,t.jsx)("div",{className:"flex flex-col items-center",children:(0,t.jsx)("div",{className:"flex gap-2",children:(0,t.jsx)(i.Z,{onClick:()=>{try{j(!0)}catch(e){h(e)}},className:"mt-4 ".concat(u?"animate-bounce bg-emerald-300":"bg-slate-400"," px-4 py-2 enabled:hover:bg-emerald-400 enabled:hover:bg-emerald-500 disabled:opacity-50 dark:bg-emerald-400"),children:S("chatOutline.createLoop")})})})]})});j.displayName="Outline"},82691:function(e,l,a){a.d(l,{A:function(){return o}});var t=a(74817),r=a(51645),s=a(71248),n=a(19249),d=a(56054),i=a(81173);let o=(0,s.memo)(e=>{let{isLast:l,disabled:a,onError:o,onPublish:c}=e,{t:x}=(0,n.Z)("loop"),{user:u}=(0,r.a)(),m=(0,s.useCallback)((e,l,r)=>(0,t.jsx)(i.Z,{disabled:!l||a,onClick:()=>{try{null==l||l()}catch(e){o(e)}},className:"px-4 py-2 disabled:opacity-50 ".concat(null!=r?r:"bg-emerald-500 text-black enabled:hover:bg-emerald-400 dark:bg-[#00aaff] dark:hover:bg-white dark:hover:text-[#00aaff]"),children:e}),[a,o]);return l?(0,t.jsxs)("div",{className:"flex flex-col gap-2 dark:rounded-lg dark:bg-[#1f1f1f] dark:p-4",children:[(0,t.jsx)("label",{className:"text-lg font-semibold text-black dark:text-white",children:x("chatSuccess.loopReady")}),u?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("label",{className:"text-sm text-black dark:text-gray-300",children:x("chatSuccess.activatePrompt")}),(0,t.jsx)("div",{className:"flex flex-row justify-end p-2",children:m(x("chatSuccess.activateButton"),u?c:void 0,"bg-purple-300 dark:bg-purple-400 enabled:hover:bg-purple-400 dark:enabled:hover:bg-purple-500")})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("label",{className:"text-sm font-semibold text-emerald-600 dark:text-[#38a169]",children:x("chatSuccess.freePlan")}),(0,t.jsx)("label",{className:"text-sm italic text-slate-600 dark:text-gray-400",children:x("chatSuccess.pricingInfo")}),(0,t.jsx)("div",{className:"flex flex-row justify-end pt-2",children:(0,t.jsx)(d.Z,{mode:"button",className:"bg-emerald-500 text-white enabled:hover:bg-emerald-400 dark:bg-[#38a169] dark:hover:bg-[#2f855a]"})})]})]}):(0,t.jsx)("div",{className:"flex flex-col",children:(0,t.jsx)("label",{className:"text-black/50 dark:text-gray-400",children:x("chatSuccess.loopReady")})})});o.displayName="Loop is Ready"},82172:function(e,l,a){a.d(l,{o:function(){return r}});var t=a(74817);let r=(0,a(71248).memo)(e=>{let{justification:l,streaming:a,isLast:r}=e;return r?(0,t.jsxs)("div",{className:"flex flex-col py-2",children:[(0,t.jsx)("label",{className:"font-semibold text-green-600 dark:text-green-400",children:"Block looks good!"}),(0,t.jsx)("label",{className:"text-sm dark:text-gray-300",children:null!=l?l:"..."})]}):(0,t.jsxs)("div",{className:"flex flex-col py-2",children:[(0,t.jsx)("label",{className:"text-green-600 dark:text-green-400",children:"Block looked good!"}),(0,t.jsx)("label",{className:"text-sm text-black/50 dark:text-gray-400",children:null!=l?l:"..."})]})});r.displayName="Correct Block"},76422:function(e,l,a){a.d(l,{N:function(){return u}});var t=a(74817),r=a(71248),s=a(9143),n=a(47254),d=a(37518),i=a.n(d),o=a(75334),c=a(81173),x=a(65414);let u=(0,r.memo)(e=>{let{streaming:l,isLast:a,disabled:d,loopId:u,onFilesUploaded:m,onError:b}=e,[g,h]=(0,r.useState)("ask-for-files"),[p,f]=(0,r.useState)([]),[v,k]=(0,r.useState)(!1),[y,j]=(0,r.useState)(null),N=(0,r.useRef)(null),w=(0,r.useCallback)(async e=>{if(!e||0===e.length)return;j(null),k(!0);let l=Array.from(e),a=l.map(e=>({id:"".concat(e.name,"-").concat(e.size,"-").concat(Date.now()),fileName:e.name,type:e.type,bytes:e.size,uploading:!0}));for(let[e,t]of(f(e=>[...e,...a]),l.entries())){let l=a[e].id;try{let e=new FormData;e.append("file",t);let a=await fetch("/api/loop/".concat(u,"/upload"),{method:"POST",body:e});if(!a.ok)throw Error("Failed to upload ".concat(t.name));let r=await a.json();f(e=>e.map(e=>e.id===l?{...e,url:r.url,uploading:!1}:e))}catch(a){let e=a instanceof Error?a.message:"Upload failed – try again.";f(a=>a.map(a=>a.id===l?{...a,uploading:!1,error:e}:a))}}k(!1)},[u]),C=(0,r.useCallback)(()=>{h("files-submitted"),m(p)},[p,m]),S=e=>{f(l=>l.filter((l,a)=>a!==e))},E=e=>e&&window.open(e,"_blank"),O=async e=>{var l;(null===(l=e.target.files)||void 0===l?void 0:l.length)&&(await w(e.target.files),e.target.value="")};return"files-submitted"===g?(0,t.jsx)("div",{className:"flex flex-col gap-1",children:(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("label",{className:"text-green-600/80 dark:text-green-400",children:"Files uploaded successfully!"}),(0,t.jsxs)("div",{className:"my-2 flex flex-col rounded-lg py-2 text-black/50 dark:text-gray-300",children:[(0,t.jsxs)("label",{className:"text-sm font-semibold underline",children:["Uploaded Files (",p.length,")"]}),p.map(e=>(0,t.jsxs)("label",{className:"text-sm",children:[e.fileName," (",e.type,")"]},e.id))]})]})}):a?"ask-for-files"===g?(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsx)("label",{className:"text-lg font-bold text-orange-600 dark:text-orange-400",children:"File Upload Required!"}),(0,t.jsx)("label",{className:"dark:text-gray-300",children:"This Loop requires file uploads to continue. Please select one or more files."}),(0,t.jsxs)("div",{className:"my-2 flex flex-col gap-2 rounded-lg px-2 py-2",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsx)(o.Z,{className:"font-semibold italic dark:text-gray-200",children:"Select Files"}),(0,t.jsx)("input",{type:"file",multiple:!0,ref:N,onChange:O,className:"hidden",disabled:v||d}),(0,t.jsx)("div",{className:"mb-3",children:(0,t.jsxs)(x.z,{size:"sm",className:"border-2 border-black bg-white text-black shadow-[2px_2px_0_0_rgba(0,0,0,1)] transition-all hover:bg-gray-100 hover:shadow-[1px_1px_0_0_rgba(0,0,0,0.8)] dark:border-white dark:bg-black dark:text-white dark:shadow-[2px_2px_0_0_rgba(255,255,255,0.8)] dark:hover:bg-gray-900",onClick:()=>{var e;return null===(e=N.current)||void 0===e?void 0:e.click()},disabled:v||d,children:[(0,t.jsx)(s.Z,{size:16,className:"mr-1"}),"Upload Files"]})}),y&&(0,t.jsx)("p",{className:"mt-2 text-xs text-red-500",children:y}),p.length>0&&Array.isArray(p)&&(0,t.jsx)("ul",{className:"mt-4 space-y-2",children:p.map((e,l)=>{var a,r;return(0,t.jsxs)("li",{className:"flex flex-wrap items-center justify-between gap-2 rounded-md border-2 border-dashed border-slate-400 bg-white p-2 dark:border-white dark:bg-black",children:[e.url?(0,t.jsx)(i(),{className:"w-[180px] flex-1 truncate overflow-ellipsis pl-2 font-medium text-blue-600 dark:text-blue-300",title:e.fileName,onClick:()=>E(e.url),href:e.url||"",target:"_blank",children:e.fileName}):(0,t.jsx)("span",{className:"w-[180px] flex-1 truncate overflow-ellipsis pl-2 font-medium text-gray-600 dark:text-gray-300",title:e.fileName,children:e.fileName}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"rounded-full bg-purple-100 px-2 py-0.5 text-xs text-purple-700 dark:bg-purple-800/30 dark:text-purple-300",children:null!==(r=(null===(a=e.type)||void 0===a?void 0:a.split("/")[1])||e.type)&&void 0!==r?r:"unknown"}),(0,t.jsx)("span",{className:"rounded-full bg-amber-100 px-2 py-0.5 text-xs text-amber-700 dark:bg-amber-800/30 dark:text-amber-300",children:e.bytes?"".concat((e.bytes/1024).toFixed(1)," KB"):"—"}),e.uploading&&(0,t.jsx)("span",{className:"rounded-full bg-yellow-100 px-2 py-0.5 text-xs text-yellow-700 dark:bg-yellow-800/30 dark:text-yellow-300",children:"Uploading…"}),e.url&&(0,t.jsx)("span",{className:"rounded-full bg-green-100 px-2 py-0.5 text-xs text-green-700 dark:bg-green-800/30 dark:text-green-300",children:"Uploaded"}),e.error&&(0,t.jsx)("span",{className:"rounded-full bg-red-100 px-2 py-0.5 text-xs text-red-700 dark:bg-red-800/30 dark:text-red-300",children:"Failed"}),(0,t.jsx)(x.z,{size:"sm",variant:"ghost",className:"bg-white text-red-600 opacity-50 transition-all hover:bg-red-50 hover:text-red-600 hover:opacity-100 dark:bg-black dark:hover:bg-red-950",onClick:()=>S(l),children:(0,t.jsx)(n.Z,{size:14})})]})]},e.id)})})]}),(0,t.jsx)("div",{className:"flex justify-end pt-4",children:p.filter(e=>e.url).length>0&&!l&&(0,t.jsx)(c.Z,{disabled:d||v||p.some(e=>e.uploading),onClick:()=>{try{C()}catch(e){b(e)}},className:"mb-2 min-w-[8rem] bg-emerald-500 px-4 py-2 font-semibold enabled:hover:bg-emerald-400 disabled:opacity-50",children:"Continue with Files"})})]})]}):(0,t.jsx)("div",{className:"flex flex-col gap-1",children:(0,t.jsx)("label",{className:"text-sm text-orange-600 dark:text-orange-400",children:"Invalid state!"})}):(0,t.jsx)("div",{className:"flex flex-col gap-1",children:(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("label",{className:"text-orange-600/80 dark:text-orange-400",children:"File Upload Requested"}),(0,t.jsx)("label",{className:"text-sm text-black/50 line-through dark:text-gray-400",children:"Please upload files to continue..."})]})})});u.displayName="File Upload"},12947:function(e,l,a){a.d(l,{g:function(){return d}});var t=a(74817),r=a(71248),s=a(51827),n=a(81173);let d=(0,r.memo)(e=>{var l,a,d,i,o,c,x;let{details:u,streaming:m,isLast:b,disabled:g,blockResult:h,loop:p,handleLoopUpdate:f,onContinue:v,onRewriteBlock:k,onUpdateDetails:y,onError:j}=e,[N,w]=(0,r.useState)("ask-if-correct"),C=(0,r.useMemo)(()=>!!(null==h?void 0:h.stderr),[h]),S=(0,r.useCallback)((e,l,a)=>(0,t.jsx)("div",{children:(0,t.jsx)(n.Z,{disabled:!l||g,onClick:()=>{try{null==l||l()}catch(e){j(e)}},className:"mb-2 min-w-[8rem] px-4 py-2 font-medium disabled:opacity-50 ".concat(null!=a?a:"bg-emerald-400 enabled:hover:bg-emerald-500"),children:e})}),[g,j]);return"description-submitted"===N?(0,t.jsx)("div",{className:"flex flex-col gap-1",children:(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("label",{className:"text-green-600/80 dark:text-green-400",children:"Block description updated!"}),(0,t.jsxs)("div",{className:"my-2 flex flex-col rounded-lg border border-gray-300 px-3 py-2 text-black/50 dark:border-gray-600 dark:text-gray-300",children:[(0,t.jsx)("label",{className:"text-sm font-semibold underline",children:"New Block Description"}),(0,t.jsx)("label",{className:"text-sm",children:null!==(l=null==u?void 0:u.description)&&void 0!==l?l:"..."})]})]})}):"error-confirmed"===N?(0,t.jsx)("div",{className:"flex flex-col gap-1",children:(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("label",{className:"text-green-600/80 dark:text-green-400",children:"Block error confirmed!"}),(0,t.jsxs)("div",{className:"my-2 flex flex-col rounded-lg border border-gray-300 px-3 py-2 text-black/50 dark:border-gray-600 dark:text-gray-300",children:[(0,t.jsx)("label",{className:"text-sm font-semibold underline",children:"New Block Description"}),(0,t.jsx)("label",{className:"text-sm",children:null!==(a=null==u?void 0:u.description)&&void 0!==a?a:"..."})]})]})}):"correct"===N?(0,t.jsx)("div",{className:"flex flex-col gap-1",children:(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("label",{className:"text-green-600/80 dark:text-green-400",children:C?"Block reran":"Block output is correct"}),(0,t.jsx)("label",{className:"text-sm text-black/50 line-through dark:text-gray-400",children:null!==(d=null==u?void 0:u.msgToUser)&&void 0!==d?d:"..."})]})}):b?"ask-if-correct"===N?C?(0,t.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("label",{className:"text-lg font-bold text-orange-600 dark:text-orange-400",children:"Block Run Hit an Error!"}),(0,t.jsx)("label",{className:"text-sm dark:text-gray-300",children:null!==(o=null==u?void 0:u.msgToUser)&&void 0!==o?o:"..."})]}),!m&&(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsx)("label",{className:"text-sm font-semibold dark:text-gray-300",children:"What do you want me to do with this Block?"}),(0,t.jsxs)("div",{className:"flex flex-row gap-2 pt-2",children:[S("Rerun",v?()=>{w("correct"),null==v||v("rerun")}:void 0,"bg-gray-100 dark:bg-gray-700 enabled:hover:bg-gray-200 dark:enabled:hover:bg-gray-600 border border-gray-200 dark:border-gray-500"),S("Fix it",k?()=>{var e;w("error-confirmed"),k(null!==(e=null==u?void 0:u.description)&&void 0!==e?e:"",p,f)}:void 0,"bg-orange-300 enabled:hover:bg-orange-400")]})]})]}):(0,t.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("label",{className:"text-lg font-bold text-orange-600 dark:text-orange-400",children:"Block Output Appears Incorrect!"}),(0,t.jsx)("label",{className:"text-sm dark:text-gray-300",children:null!==(c=null==u?void 0:u.msgToUser)&&void 0!==c?c:"..."})]}),!m&&(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsx)("label",{className:"text-sm font-semibold dark:text-gray-300",children:"Is this Block's output correct or incorrect?"}),(0,t.jsxs)("div",{className:"flex flex-row gap-2 pt-2",children:[S("Looks OK",v?()=>{w("correct"),null==v||v("next")}:void 0),S("Please fix it",k?()=>{w("ask-for-description")}:void 0,"bg-orange-300 enabled:hover:bg-orange-400")]})]})]}):"ask-for-description"===N?(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("label",{className:"text-lg font-bold text-orange-600 dark:text-orange-400",children:"Block Output Appears Incorrect!"}),(0,t.jsx)("label",{className:"text-sm dark:text-gray-300",children:null!==(x=null==u?void 0:u.msgToUser)&&void 0!==x?x:"..."})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-2 rounded-lg border border-gray-300 px-3 py-2 dark:border-gray-600",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsx)("label",{className:"text-sm font-semibold underline dark:text-gray-200",children:"New Block Description"}),(0,t.jsx)(s.Z,{containerClassName:"bg-white/50 dark:bg-gray-700",value:null==u?void 0:u.description,disabled:!y,placeholder:"Fill me in...",onChange:e=>{null==y||y({...u,description:e})}})]}),(0,t.jsxs)("div",{className:"flex flex-row gap-2 pt-2",children:[S("Back",()=>{w("ask-if-correct")},"text-black/90 dark:text-white bg-gray-100 dark:bg-gray-700 enabled:hover:bg-gray-200 dark:enabled:hover:bg-gray-600 border border-gray-200 dark:border-gray-500"),S("Regenerate",k&&(null==u?void 0:u.description)?()=>{var e;w("description-submitted"),k(null!==(e=null==u?void 0:u.description)&&void 0!==e?e:"",p,f)}:void 0)]})]})]}):(0,t.jsx)("div",{className:"flex flex-col gap-1",children:(0,t.jsx)("label",{className:"text-sm text-orange-600 dark:text-orange-400",children:"Invalid message!"})}):(0,t.jsx)("div",{className:"flex flex-col gap-1",children:(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("label",{className:"text-orange-600/80 dark:text-orange-400",children:C?"Block run hit an error":"Block output appeared incorrect"}),(0,t.jsx)("label",{className:"text-sm text-black/50 line-through dark:text-gray-400",children:null!==(i=null==u?void 0:u.msgToUser)&&void 0!==i?i:"..."})]})})});d.displayName="Request Rewrite"},38:function(e,l,a){a.d(l,{D:function(){return r}});var t=a(74817);let r=(0,a(71248).memo)(e=>{let{justification:l,streaming:a,isLast:r}=e;return r?(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("label",{className:"font-semibold text-black dark:text-white",children:"Validating block..."}),(0,t.jsx)("label",{className:"text-sm text-black/80 dark:text-gray-300",children:null!=l?l:"..."})]}):(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("label",{className:"text-orange-600 dark:text-orange-400",children:"Uncertain about Block!"}),(0,t.jsx)("label",{className:"text-sm text-black/50 dark:text-gray-400",children:null!=l?l:"..."})]})});r.displayName="Validating Block"},37943:function(e,l,a){a.d(l,{a:function(){return s}});var t=a(74817),r=a(71248);let s=(0,r.memo)(e=>{var l;let{details:a,isLast:s,disabled:n,streaming:d,onError:i,onFixLoop:o,onContinue:c}=e,x=(0,r.useCallback)((e,l,a)=>(0,t.jsx)("button",{disabled:!l||n,onClick:()=>{try{null==l||l()}catch(e){i(e)}},className:"rounded-lg px-4 py-2 font-semibold disabled:opacity-50 ".concat(null!=a?a:"bg-emerald-500 text-white enabled:hover:bg-emerald-400 dark:bg-emerald-700 dark:enabled:hover:bg-emerald-600"),children:e}),[n,i]);return(0,t.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,t.jsx)("label",{className:"text-sm text-orange-600 dark:text-orange-400",children:null!==(l=null==a?void 0:a.notes)&&void 0!==l?l:"..."}),!d&&s&&(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)("label",{className:"text-sm dark:text-gray-300",children:"Resolve the above issue then either start the verification over or continue from this point"}),(0,t.jsxs)("div",{className:"flex flex-row gap-2",children:[x("Start Over",o,"text-black bg-gray-200 enabled:hover:bg-gray-300 border border-gray-300 dark:bg-gray-700 dark:border-gray-600 dark:enabled:hover:bg-gray-600"),x("Continue",c)]})]})]})});s.displayName="Request User Intervention"},32068:function(e,l,a){a.d(l,{s:function(){return x}});var t=a(74817),r=a(71248),s=a(51645),n=a(75334),d=a(7988),i=a(12957),o=a(81173),c=a(78301);let x=(0,r.memo)(e=>{var l,a,x;let{details:u,streaming:m,isLast:b,disabled:g,loop:h,handleLoopUpdate:p,onCreateVar:f,onUpdateDetails:v,onError:k}=e,{user:y}=(0,s.a)(),[j,N]=(0,r.useState)("ask-for-variable");(0,r.useEffect)(()=>{!m&&y&&(null==u?void 0:u.key)&&!(null==u?void 0:u.value)&&((0,c.rO)(null==u?void 0:u.key)&&(null==y?void 0:y.email)?v({...u,value:null==y?void 0:y.email}):(0,c.f9)(null==u?void 0:u.key)&&(null==y?void 0:y.phone)&&v({...u,value:null==y?void 0:y.phone}))},[u,v,m,y]);let w=(0,r.useCallback)(()=>{var e,l,a,t;N("variable-submitted"),f({key:null!==(e=null==u?void 0:u.key)&&void 0!==e?e:"UNKNOWN",value:null!==(l=null==u?void 0:u.value)&&void 0!==l?l:"",required:null!==(a=null==u?void 0:u.required)&&void 0!==a&&a,secret:null!==(t=null==u?void 0:u.secret)&&void 0!==t&&t},h,p)},[u,N,f]);return"variable-submitted"===j?(0,t.jsx)("div",{className:"flex flex-col gap-1",children:(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("label",{className:"text-green-600/80 dark:text-green-400",children:"Value updated!"}),(0,t.jsxs)("div",{className:"my-2 flex flex-col rounded-lg py-2 text-black/50 dark:text-gray-300",children:[(0,t.jsx)("label",{className:"text-sm font-semibold underline",children:"New Value"}),(0,t.jsx)("label",{className:"text-sm",children:null!==(l=null==u?void 0:u.key)&&void 0!==l?l:"..."})]})]})}):b?"ask-for-variable"===j?(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsx)("label",{className:"text-lg font-bold text-orange-600 dark:text-orange-400",children:"New Value Requested!"}),(0,t.jsx)("label",{className:"dark:text-gray-300",children:null!==(x=null==u?void 0:u.description)&&void 0!==x?x:"..."}),(0,t.jsxs)("div",{className:"my-2 flex flex-col gap-2 rounded-lg px-2 py-2",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsx)(n.Z,{className:"font-semibold italic dark:text-gray-200",children:"Name"}),(0,t.jsx)(d.Z,{type:"text",className:"w-full bg-white/50 px-1.5 pb-1 pt-0.5 focus:outline-none disabled:opacity-50 dark:bg-gray-700",disabled:!v,value:(null==u?void 0:u.key)||"",placeholder:"NAME...",onChange:e=>{null==v||v({...u,key:e.target.value})}})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsx)(n.Z,{className:"font-semibold italic dark:text-gray-200",children:"Value"}),(0,t.jsx)(d.Z,{type:(0,c.Se)(null==u?void 0:u.key),autoComplete:(0,c.AG)(null==u?void 0:u.key),placeholder:(0,c.qH)(null==u?void 0:u.key,"Fill me in"),className:"w-full bg-white/50 px-1.5 pb-1 pt-0.5 focus:outline-none disabled:opacity-50 dark:bg-gray-700",value:(null==u?void 0:u.value)||"",disabled:!v,onChange:e=>{null==v||v({...u,value:e.target.value})}})]}),(0,t.jsxs)("div",{className:"flex flex-row justify-between pt-4",children:[(0,t.jsxs)("div",{className:"flex w-full flex-col justify-center",children:[(0,t.jsxs)("div",{className:"flex flex-row items-center gap-1",onClick:()=>null==v?void 0:v({...u,required:!(null==u?void 0:u.required)}),children:[(0,t.jsx)(i.Z,{checked:(null==u?void 0:u.required)||!1,disabled:!v,alt:"Required?",onChange:e=>{null==v||v({...u,required:e.target.checked})}}),(0,t.jsx)(n.Z,{className:"font-bold italic dark:text-gray-200",children:"Required?"})]}),(0,t.jsxs)("div",{className:"flex flex-row items-center gap-1",onClick:()=>null==v?void 0:v({...u,secret:!(null==u?void 0:u.secret)}),children:[(0,t.jsx)(i.Z,{checked:(null==u?void 0:u.secret)||!1,disabled:!v,alt:"Secret?",onChange:e=>{null==v||v({...u,secret:e.target.checked})}}),(0,t.jsx)(n.Z,{className:"font-bold italic dark:text-gray-200",children:"Secret?"})]})]}),!m&&(0,t.jsx)("div",{className:"flex w-full justify-end",children:(0,t.jsx)(o.Z,{disabled:!w||g,onClick:()=>{try{null==w||w()}catch(e){k(e)}},className:"mb-2 min-w-[8rem] bg-emerald-500 px-4 py-2 font-semibold enabled:hover:bg-emerald-400 disabled:opacity-50",children:"Save"})})]})]})]}):(0,t.jsx)("div",{className:"flex flex-col gap-1",children:(0,t.jsx)("label",{className:"text-sm text-orange-600 dark:text-orange-400",children:"Invalid message!"})}):(0,t.jsx)("div",{className:"flex flex-col gap-1",children:(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("label",{className:"text-orange-600/80 dark:text-orange-400",children:"New Value Requested"}),(0,t.jsx)("label",{className:"text-sm text-black/50 line-through dark:text-gray-400",children:null!==(a=null==u?void 0:u.description)&&void 0!==a?a:"..."})]})})});x.displayName="Request Value"},43685:function(e,l,a){a.d(l,{Z:function(){return o}});var t=a(74817),r=a(71248),s=a(74902),n=a(17101);let d=["#3b82f6","#ef4444","#f97316","#22c55e","#eab308","#a855f7"],i={initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0,opacity:0}};function o(){let[e,l]=(0,r.useState)([]);function a(){let e=Math.floor(4*Math.random())+1,l=30*e;return{id:Date.now()+Math.random(),color:d[Math.floor(Math.random()*d.length)],x:Math.random()*(300-l),y:Math.random()*(300-l),duration:1*Math.random()+1,delay:.3*Math.random(),size:e}}return(0,r.useEffect)(()=>{l(Array.from({length:Math.floor(4*Math.random())+2},()=>a()));let e=setInterval(()=>{l(e=>{let l=[...e];if(l.length>2&&.3>Math.random()){let e=Math.floor(Math.random()*l.length);l.splice(e,1)}return l.length<5&&.5>Math.random()&&l.push(a()),l})},800);return()=>clearInterval(e)},[]),(0,t.jsx)("div",{className:"relative h-[300px] w-[300px]",children:(0,t.jsx)(s.M,{children:e.map(e=>(0,t.jsx)(n.E.div,{className:"absolute rounded-full",style:{border:"".concat(Math.max(1,e.size-1),"px solid ").concat(e.color),left:e.x,top:e.y,width:30*e.size,height:30*e.size},variants:i,initial:"initial",animate:"animate",exit:"exit",transition:{duration:e.duration,delay:e.delay,repeat:1/0,repeatType:"reverse",ease:"easeInOut"}},e.id))})})}},17724:function(e,l,a){a.d(l,{C:function(){return d}});var t=a(74817);a(71248);var r=a(82898),s=a(2002);let n=(0,r.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function d(e){let{className:l,variant:a,...r}=e;return(0,t.jsx)("div",{className:(0,s.cn)(n({variant:a}),l),...r})}}}]);