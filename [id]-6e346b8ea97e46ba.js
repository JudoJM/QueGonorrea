(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[811,3681],{60824:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/builder/[id]",function(){return r(74178)}])},65283:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(74817),a=r(23489),l=r(65414),s=r(71248),o=r(19249);function i(e){let{isOpen:t,onClose:r,onConfirm:i,itemType:d,itemName:c}=e,{t:p}=(0,o.Z)("common"),u=p("modals.deleteConfirm.title",{type:p("app"===d?"modals.deleteConfirm.thisApp":"modals.deleteConfirm.thisLoop")}),m=c||p("app"===d?"modals.deleteConfirm.thisApp":"modals.deleteConfirm.thisLoop"),[h,g]=(0,s.useState)("app"===d);return(0,n.jsx)(a.Vq,{open:t,onOpenChange:r,children:(0,n.jsxs)(a.cZ,{className:"border-3 fixed left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 transform border-black bg-pink-100 p-0 shadow-[6px_6px_0px_0px_rgba(0,0,0,1)] sm:max-w-md",children:[(0,n.jsx)("div",{className:"border-b-3 border-black bg-red-400 p-5",children:(0,n.jsx)(a.$N,{className:"text-2xl font-black text-black",children:u.toUpperCase()})}),(0,n.jsxs)("div",{className:"space-y-6 px-5 pb-5 pt-2 text-black",children:[(0,n.jsx)("p",{className:"text-lg font-semibold",children:p("modals.deleteConfirm.description",{name:m})}),"app"===d&&(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)("input",{id:"deleteAssociatedLoops",type:"checkbox",className:"h-4 w-4",checked:h,onChange:e=>g(e.target.checked)}),(0,n.jsx)("label",{htmlFor:"deleteAssociatedLoops",className:"text-sm",children:p("modals.deleteConfirm.deleteAssociatedLoops")})]}),(0,n.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,n.jsx)(l.z,{onClick:r,className:"border-3 rounded-none border-black bg-white px-4 py-2 font-bold text-black shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] transition-all hover:bg-gray-100 hover:shadow-[1px_1px_0px_0px_rgba(0,0,0,1)]",children:p("modals.deleteConfirm.cancel")}),(0,n.jsx)(l.z,{onClick:()=>{"app"===d?i(h):i(),r()},className:"border-3 rounded-none border-black bg-red-500 px-4 py-2 font-bold text-white shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] transition-all hover:bg-red-600 hover:shadow-[1px_1px_0px_0px_rgba(0,0,0,1)]",children:p("modals.deleteConfirm.confirm")})]})]})]})})}},88943:function(e,t,r){"use strict";r.d(t,{H:function(){return p}});var n=r(74817),a=r(71248),l=r(36497),s=r(5673),o=r(98769),i=r(94620),d=r(19249);function c(e){let{isOpen:t=!0,onClose:r=()=>{},onUpgrade:l=()=>{},nextCreditsTime:o=new Date(Date.now()+864e5)}=e,{t:c}=(0,d.Z)("common"),{refreshCreditBalance:p,creditBalance:u}=(0,s.$)(),[m,h]=(0,a.useState)({hours:0,minutes:0,seconds:0}),[g,x]=(0,a.useState)(!1);return((0,a.useEffect)(()=>{if(!t){x(!1);return}let e=()=>{let e=o.getTime()-Date.now();return e<=0?(g||(x(!0),p().catch(console.error)),{hours:0,minutes:0,seconds:0}):{hours:Math.floor(e/36e5),minutes:Math.floor(e%36e5/6e4),seconds:Math.floor(e%6e4/1e3)}};h(e());let r=setInterval(()=>{h(e())},1e3);return()=>clearInterval(r)},[t,o]),(0,a.useEffect)(()=>{if(t&&u&&u.genRemaining>0){let e=setTimeout(()=>{r()},500);return()=>clearTimeout(e)}},[t,u,r]),t)?(0,n.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center overflow-visible bg-black/50",children:(0,n.jsx)("div",{className:"relative w-full max-w-md transform overflow-hidden overflow-visible bg-transparent p-1",children:(0,n.jsx)("div",{className:"border-[6px] border-black shadow-[8px_8px_0px_0px_rgba(0,0,0,1)]",children:(0,n.jsxs)("div",{className:"bg-[#FFE500] p-6",children:[(0,n.jsx)("button",{onClick:r,className:"absolute right-4 top-4 z-50 rounded-full border-4 border-black bg-white p-1 hover:bg-gray-100 dark:text-black",children:(0,n.jsx)(i.Z,{size:20})}),(0,n.jsx)("div",{className:"mb-6 rotate-[-2deg]",children:(0,n.jsx)("h2",{className:"text-4xl font-black uppercase tracking-tight dark:text-black",children:c("outOfCreditsModal.title")})}),(0,n.jsx)("p",{className:"mb-6 text-xl font-bold dark:text-black",children:c("outOfCreditsModal.message")}),(0,n.jsxs)("div",{className:"mb-8 rounded-md border-4 border-black bg-white p-4",children:[(0,n.jsx)("p",{className:"mb-2 text-lg font-bold dark:text-black",children:c("outOfCreditsModal.nextCreditsIn")}),(0,n.jsxs)("div",{className:"flex justify-center space-x-4 text-center",children:[(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsx)("span",{className:"rounded-md border-4 border-black bg-[#FF6B6B] px-3 py-2 text-3xl font-black text-white dark:text-black",children:String(m.hours).padStart(2,"0")}),(0,n.jsx)("span",{className:"mt-1 text-sm font-bold dark:text-black",children:c("outOfCreditsModal.hours")})]}),(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsx)("span",{className:"rounded-md border-4 border-black bg-[#4ECDC4] px-3 py-2 text-3xl font-black text-white dark:text-black",children:String(m.minutes).padStart(2,"0")}),(0,n.jsx)("span",{className:"mt-1 text-sm font-bold dark:text-black",children:c("outOfCreditsModal.minutes")})]}),(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsx)("span",{className:"rounded-md border-4 border-black bg-[#FF9F1C] px-3 py-2 text-3xl font-black text-white dark:text-black",children:String(m.seconds).padStart(2,"0")}),(0,n.jsx)("span",{className:"mt-1 text-sm font-bold dark:text-black",children:c("outOfCreditsModal.seconds")})]})]})]}),(0,n.jsx)("button",{onClick:l,className:"w-full transform rounded-md border-4 border-black bg-[#FF2E63] px-6 py-3 text-xl font-black uppercase text-white transition hover:translate-y-[-4px] hover:shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] active:translate-y-[0px] active:shadow-none",children:c("outOfCreditsModal.upgradeNow")}),(0,n.jsx)("div",{className:"absolute left-[-20px] top-[40%] h-12 w-12 rotate-45 border-4 border-black bg-[#4ECDC4]"}),(0,n.jsx)("div",{className:"absolute bottom-[30%] right-[-10px] h-8 w-8 rounded-full border-4 border-black bg-[#FF9F1C]"})]})})})}):null}function p(e){let t,{className:r="",label:i="generation credits"}=e,[d,p]=(0,a.useState)(!1),[u,m]=(0,a.useState)(!1),[h,g]=(0,a.useState)(!1),[x,b]=(0,a.useState)({x:0,y:0}),[f,v]=(0,a.useState)({x:0,y:0}),{userUsage:y,creditBalance:k,refreshCreditBalance:w}=(0,s.$)(),_=(0,l.useRouter)(),j=(0,a.useRef)(null),N=()=>(null==y?void 0:y.daily_gen_reset_ts)?"credits-modal-shown-".concat(y.daily_gen_reset_ts):"credits-modal-shown",E=()=>({x:window.innerWidth-88,y:window.innerHeight-160}),C=e=>e.x>=0&&e.y>=0&&e.x+64<=window.innerWidth&&e.y+64<=window.innerHeight;if((0,a.useEffect)(()=>{let e=localStorage.getItem("credits-indicator-position");if(e)try{let t=JSON.parse(e);if(C(t))b(t);else{let e=E();b(e)}}catch(e){b(E())}else b(E())},[]),(0,a.useEffect)(()=>{(0!==x.x||0!==x.y)&&localStorage.setItem("credits-indicator-position",JSON.stringify(x))},[x]),(0,a.useEffect)(()=>{let e=()=>{b(E())};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,a.useEffect)(()=>{let e=e=>{if(!h)return;e.preventDefault();let t=e.clientX-f.x,r=e.clientY-f.y;b({x:Math.max(0,Math.min(t,window.innerWidth-64)),y:Math.max(0,Math.min(r,window.innerHeight-64))})},t=e=>{if(!h)return;e.preventDefault();let t=e.touches[0];if(!t)return;let r=t.clientX-f.x,n=t.clientY-f.y;b({x:Math.max(0,Math.min(r,window.innerWidth-64)),y:Math.max(0,Math.min(n,window.innerHeight-64))})},r=e=>{h&&(e.preventDefault(),e.stopPropagation(),g(!1))},n=e=>{h&&(e.preventDefault(),e.stopPropagation(),g(!1))},a=()=>{};return h?(document.addEventListener("mousemove",e,{passive:!1}),document.addEventListener("mouseup",r,{passive:!1}),document.addEventListener("mouseleave",a),document.addEventListener("touchmove",t,{passive:!1}),document.addEventListener("touchend",n,{passive:!1}),document.addEventListener("touchcancel",e=>{h&&(e.preventDefault(),e.stopPropagation(),g(!1))},{passive:!1}),document.body.style.userSelect="none",document.body.style.pointerEvents="none",j.current&&(j.current.style.pointerEvents="auto")):(document.body.style.userSelect="",document.body.style.pointerEvents=""),()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",r),document.removeEventListener("mouseleave",a),document.removeEventListener("touchmove",t),document.removeEventListener("touchend",n),document.body.style.userSelect="",document.body.style.pointerEvents=""}},[h,f]),(0,a.useEffect)(()=>{if(!y||!k||k.genRemaining>0)return;let e=N();localStorage.getItem(e)||(m(!0),localStorage.setItem(e,new Date().toISOString()))},[y,k]),(0,a.useEffect)(()=>{if(!(null==y?void 0:y.daily_gen_reset_ts))return;let e=new Date(new Date(y.daily_gen_reset_ts).getTime()+864e5),t=new Date;if(t>=e){let e=localStorage.getItem("last-credit-refresh"),r=e?parseInt(e):0;t.getTime()-r>3e5&&(localStorage.setItem("last-credit-refresh",t.getTime().toString()),w().catch(console.error))}},[null==y?void 0:y.daily_gen_reset_ts,w]),!y||!k)return null;let S=k.genRemaining,L=Math.min(S/(t="free"===y.plan?250:Math.floor(((null==y?void 0:y.plan)?o.tH[y.plan].credits:100)*k.genAllocationPct/100))*100,100),D=2*Math.PI*45,I=d||L<=50;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{ref:j,className:"fixed z-50 transition-opacity duration-200 ".concat(I?"opacity-100":"opacity-80"," ").concat(h?"cursor-grabbing":"cursor-grab"," ").concat(r),style:{left:"".concat(x.x,"px"),top:"".concat(x.y,"px"),touchAction:"none"},onMouseEnter:()=>!h&&p(!0),onMouseLeave:()=>p(!1),onMouseDown:e=>{var t;if(0!==e.button)return;e.preventDefault(),e.stopPropagation(),g(!0);let r=null===(t=j.current)||void 0===t?void 0:t.getBoundingClientRect();r&&v({x:e.clientX-r.left,y:e.clientY-r.top})},onTouchStart:e=>{var t;e.preventDefault(),e.stopPropagation(),g(!0);let r=e.touches[0],n=null===(t=j.current)||void 0===t?void 0:t.getBoundingClientRect();n&&r&&v({x:r.clientX-n.left,y:r.clientY-n.top})},onClick:()=>{if(k&&!h&&k.genRemaining<=0){m(!0);let e=N();localStorage.setItem(e,new Date().toISOString())}},children:(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsxs)("div",{className:"h-16 w-16 rounded-full border-4 border-black bg-white shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] transition-all duration-200 hover:shadow-[6px_6px_0px_0px_rgba(0,0,0,1)] dark:border-white dark:bg-gray-800 ".concat(h?"cursor-grabbing":"cursor-grab"),children:[(0,n.jsxs)("svg",{className:"h-full w-full -rotate-90",viewBox:"0 0 100 100",children:[(0,n.jsx)("circle",{cx:"50",cy:"50",r:"45",stroke:"rgb(229, 231, 235)",strokeWidth:"8",fill:"none",className:"dark:stroke-gray-600"}),(0,n.jsx)("circle",{cx:"50",cy:"50",r:"45",stroke:"currentColor",strokeWidth:"8",fill:"none",strokeDasharray:D,strokeDashoffset:D-L/100*D,strokeLinecap:"round",className:"transition-all duration-500 ".concat(L>50?"stroke-lime-400":L>25?"stroke-yellow-400":"stroke-red-400")})]}),(0,n.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,n.jsx)("span",{className:"text-sm font-black text-black dark:text-white",children:S>=1e6?(S/1e6).toFixed(1).replace(/\.0$/,"")+"m":S>=1e3?(S/1e3).toFixed(1).replace(/\.0$/,"")+"k":S.toString()})})]}),d&&(0,n.jsxs)("div",{className:"absolute bottom-full right-0 mb-2 whitespace-nowrap border-2 border-black bg-black px-3 py-2 text-sm font-bold text-white shadow-[2px_2px_0px_0px_rgba(255,255,255,1)] dark:border-white dark:bg-white dark:text-black dark:shadow-[2px_2px_0px_0px_rgba(0,0,0,1)]",children:[(0,n.jsxs)("div",{className:"font-mono text-xs",children:[(0,n.jsxs)("div",{children:["Gen: ",S.toLocaleString()," /"," ",t.toLocaleString()]}),(0,n.jsxs)("div",{children:["Run: ",k.runRemaining.toLocaleString()]}),"free"===y.plan?(0,n.jsx)("div",{className:"text-[10px] opacity-75",children:"Daily gen / Monthly run"}):(0,n.jsxs)("div",{className:"text-[10px] opacity-75",children:[k.genAllocationPct,"% gen /"," ",100-k.genAllocationPct,"% run"]})]}),(0,n.jsx)("div",{className:"absolute right-4 top-full h-0 w-0 border-l-4 border-r-4 border-t-4 border-l-transparent border-r-transparent border-t-black dark:border-t-white"})]})]})}),(0,n.jsx)(c,{isOpen:u,onClose:()=>{m(!1)},onUpgrade:()=>{_.push("/account"),m(!1)},nextCreditsTime:new Date((null==y?void 0:y.daily_gen_reset_ts)?new Date(y.daily_gen_reset_ts).getTime()+864e5:Date.now()+864e5)})]})}},51827:function(e,t,r){"use strict";var n=r(74817),a=r(71248),l=r(21555);let s=a.forwardRef((e,t)=>{let{value:r,onChange:a,onBlur:s,onKeyDown:o,disabled:i,placeholder:d,containerClassName:c="",textClassName:p="",includeBorders:u=!0,minRowCount:m=3,maxRowCount:h=20}=e;return(0,n.jsx)("div",{className:"w-full overflow-hidden ".concat(c),children:(0,n.jsx)(l.Z,{ref:t,placeholder:d,disabled:i,minRows:m,maxRows:h,className:"w-full resize-none bg-transparent text-black/90 focus:outline-none ".concat(u?"rounded-none border-2 border-black p-2 pt-2.5":""," ").concat(p),value:r,onChange:e=>null==a?void 0:a(e.target.value),onBlur:s,onKeyDown:o})})});s.displayName="AutoGrowTextarea",t.Z=s},59414:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var n=r(74817);function a(e){let{children:t,title:r,color:a,borderColor:l="border-black",titleClassName:s="text-black",className:o=""}=e;return(0,n.jsxs)("div",{className:"rounded-lg border-4 ".concat(l," ").concat(a," shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] dark:shadow-[4px_4px_0px_0px_rgba(75,85,99,1)] ").concat(o),children:[(0,n.jsx)("div",{className:"border-b-4 ".concat(l," p-4"),children:(0,n.jsx)("h3",{className:"text-lg font-bold ".concat(s),children:r})}),(0,n.jsx)("div",{className:"bg-white dark:bg-gray-800",children:t})]})}r(71248)},24767:function(e,t,r){"use strict";r.d(t,{I:function(){return s}});var n=r(74817),a=r(71248),l=r(2002);let s=a.forwardRef((e,t)=>{let{className:r,type:a,...s}=e;return(0,n.jsx)("input",{type:a,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-sky-400 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...s})});s.displayName="Input"},57678:function(e,t,r){"use strict";r.d(t,{SP:function(){return d},dr:function(){return i},mQ:function(){return o},nU:function(){return c}});var n=r(74817),a=r(71248),l=r(16279),s=r(2002);let o=l.fC,i=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)(l.aV,{ref:t,className:(0,s.cn)("inline-flex items-center justify-center bg-transparent p-1 text-muted-foreground",r),...a})});i.displayName=l.aV.displayName;let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)(l.xz,{ref:t,className:(0,s.cn)("inline-flex items-center justify-center whitespace-nowrap px-3 py-1.5 text-sm font-bold ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-yellow-300 data-[state=active]:text-black data-[state=active]:shadow-none",r),...a})});d.displayName=l.xz.displayName;let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)(l.VY,{ref:t,className:(0,s.cn)("mt-0 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",r),...a})});c.displayName=l.VY.displayName},74178:function(e,t,r){"use strict";r.r(t),r.d(t,{__N_SSP:function(){return tE},default:function(){return tC}});var n=r(74817),a=r(54389),l=r.n(a),s=r(19249),o=r(68025),i=r(71248),d=r(36497),c=r(37518),p=r.n(c),u=r(36842),m=r(34146),h=r(50860),g=r(73857),x=r(68347),b=r(94620),f=r(72826),v=r(21327),y=r(38197),k=r(1019),w=r(62965),_=r(54217),j=r(23896),N=r(18274),E=r(51254),C=r(31942),S=r(81173),L=r(65414),D=r(57678),I=r(58535);function A(e){let{question:t,value:r,onChange:a}=e;return(0,n.jsxs)("div",{className:"flex h-full flex-col justify-between",children:[(0,n.jsx)("h3",{className:"mb-8 border-4 border-black bg-white p-4 text-xl font-bold shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200 dark:shadow-[4px_4px_0px_0px_rgba(75,85,99,1)]",children:t}),(0,n.jsxs)("div",{className:"mt-auto flex gap-4",children:[(0,n.jsxs)(L.z,{type:"button",onClick:()=>a(!0),className:"h-20 flex-1 border-4 text-xl font-bold transition-all ".concat(!0===r?"border-black bg-green-500 text-white shadow-[6px_6px_0px_0px_rgba(0,0,0,1)] dark:border-gray-600 dark:bg-green-600 dark:shadow-[6px_6px_0px_0px_rgba(75,85,99,1)]":"border-black bg-white text-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] hover:translate-x-1 hover:translate-y-1 hover:bg-green-100 hover:shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200 dark:shadow-[4px_4px_0px_0px_rgba(75,85,99,1)] dark:hover:bg-green-900 dark:hover:shadow-[2px_2px_0px_0px_rgba(75,85,99,1)]"),children:[(0,n.jsx)(k.Z,{size:24,className:"mr-2"})," YES"]}),(0,n.jsxs)(L.z,{type:"button",onClick:()=>a(!1),className:"h-20 flex-1 border-4 text-xl font-bold transition-all ".concat(!1===r?"border-black bg-red-500 text-white shadow-[6px_6px_0px_0px_rgba(0,0,0,1)] dark:border-gray-600 dark:bg-red-600 dark:shadow-[6px_6px_0px_0px_rgba(75,85,99,1)]":"border-black bg-white text-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] hover:translate-x-1 hover:translate-y-1 hover:bg-red-100 hover:shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200 dark:shadow-[4px_4px_0px_0px_rgba(75,85,99,1)] dark:hover:bg-red-900 dark:hover:shadow-[2px_2px_0px_0px_rgba(75,85,99,1)]"),children:[(0,n.jsx)(b.Z,{size:24,className:"mr-2"})," NO"]})]})]})}var O=r(10178),M=r(2002);let T=i.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)(O.fC,{ref:t,className:(0,M.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",r),...a,children:(0,n.jsx)(O.z$,{className:(0,M.cn)("flex items-center justify-center text-current"),children:(0,n.jsx)(k.Z,{className:"h-4 w-4"})})})});T.displayName=O.fC.displayName;var z=r(45512),F=r(24767),P=r(44016),R=r(32382);function H(e){let{question:t,options:r,initialSelected:a,onChange:l,onSubmit:s}=e,[o,d]=(0,i.useState)(a||[]),[c,p]=(0,i.useState)(!1),[u,m]=(0,i.useState)(""),[h,g]=(0,i.useState)([]),x=(0,i.useCallback)(e=>{d(t=>{let r=t.includes(e)?t.filter(t=>t!==e):[...t,e];return l&&JSON.stringify(r)!==JSON.stringify(t)&&l(r),r})},[l]),b=()=>{if(u.trim()){let e=u.trim();g(t=>[...t,e]),d(t=>[...t,e]),m(""),p(!1),l&&l([...o,e])}};return(0,n.jsxs)("div",{className:"flex h-full flex-col justify-between",children:[(0,n.jsx)("h3",{className:"mb-8 border-4 border-black bg-white p-4 text-xl font-bold shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200 dark:shadow-[4px_4px_0px_0px_rgba(75,85,99,1)]",children:t}),(0,n.jsxs)("div",{className:"mt-auto space-y-4",children:[r.map((e,t)=>"other"===e.toLowerCase()||"custom option"===e.toLowerCase()?null:(0,n.jsx)("div",{className:"cursor-pointer border-4 border-black p-4 transition-all ".concat(o.includes(e)?"bg-blue-500 text-white shadow-[6px_6px_0px_0px_rgba(0,0,0,1)] dark:border-gray-600 dark:bg-blue-600 dark:shadow-[6px_6px_0px_0px_rgba(75,85,99,1)]":"bg-white shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] hover:translate-x-1 hover:translate-y-1 hover:bg-blue-100 hover:shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200 dark:shadow-[4px_4px_0px_0px_rgba(75,85,99,1)] dark:hover:bg-blue-900 dark:hover:shadow-[2px_2px_0px_0px_rgba(75,85,99,1)]"),onClick:()=>x(e),children:(0,n.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,n.jsx)(T,{checked:o.includes(e),onCheckedChange:()=>x(e),onClick:e=>e.stopPropagation(),id:"option-".concat(t),className:"h-6 w-6 border-2 border-black dark:border-gray-600"}),(0,n.jsx)(z._,{htmlFor:"option-".concat(t),className:"text-lg font-bold capitalize ".concat(o.includes(e)?"text-white dark:text-white":"text-black dark:text-gray-200"),onClick:()=>x(e),children:e})]})},t)),h.map((e,t)=>(0,n.jsx)("div",{className:"cursor-pointer border-4 border-black p-4 transition-all ".concat(o.includes(e)?"bg-blue-500 text-white shadow-[6px_6px_0px_0px_rgba(0,0,0,1)] dark:border-gray-600 dark:bg-blue-600 dark:shadow-[6px_6px_0px_0px_rgba(75,85,99,1)]":"bg-white shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] hover:translate-x-1 hover:translate-y-1 hover:bg-blue-100 hover:shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200 dark:shadow-[4px_4px_0px_0px_rgba(75,85,99,1)] dark:hover:bg-blue-900 dark:hover:shadow-[2px_2px_0px_0px_rgba(75,85,99,1)]"),onClick:()=>x(e),children:(0,n.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,n.jsx)(T,{checked:o.includes(e),onCheckedChange:()=>x(e),onClick:e=>e.stopPropagation(),id:"custom-option-".concat(t),className:"h-6 w-6 border-2 border-black dark:border-gray-600"}),(0,n.jsx)(z._,{htmlFor:"custom-option-".concat(t),className:"text-lg font-bold ".concat(o.includes(e)?"text-white dark:text-white":"text-black dark:text-gray-200"),onClick:()=>x(e),children:e})]})},"custom-".concat(t))),!c&&(0,n.jsxs)(L.z,{onClick:()=>p(!0),className:"flex h-[72px] w-full items-center justify-center gap-2 border-4 border-black bg-white p-4 text-lg font-bold text-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] transition-all hover:translate-x-1 hover:translate-y-1 hover:bg-gray-100 hover:shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200 dark:shadow-[4px_4px_0px_0px_rgba(75,85,99,1)] dark:hover:bg-gray-700 dark:hover:shadow-[2px_2px_0px_0px_rgba(75,85,99,1)]",children:[(0,n.jsx)(P.Z,{size:24})," Add Custom Option"]}),c&&(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)(F.I,{value:u,onChange:e=>m(e.target.value),onKeyDown:e=>{"Enter"===e.key&&u.trim()&&(e.preventDefault(),b())},placeholder:"Type your custom option...",className:"h-[72px] flex-1 border-4 border-black bg-white p-4 text-lg font-medium shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] transition-all focus:translate-x-1 focus:translate-y-1 focus:shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] focus-visible:ring-0 focus-visible:ring-offset-0 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200 dark:shadow-[4px_4px_0px_0px_rgba(75,85,99,1)] dark:placeholder:text-gray-400 dark:focus:shadow-[2px_2px_0px_0px_rgba(75,85,99,1)]"}),(0,n.jsx)(L.z,{onClick:b,disabled:!u.trim(),className:"h-[72px] w-[100px] border-4 border-black bg-blue-500 p-4 font-bold text-white shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] transition-all hover:translate-x-1 hover:translate-y-1 hover:bg-blue-600 hover:shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] disabled:opacity-50 dark:border-gray-600 dark:bg-blue-600 dark:shadow-[4px_4px_0px_0px_rgba(75,85,99,1)] dark:hover:bg-blue-700 dark:hover:shadow-[2px_2px_0px_0px_rgba(75,85,99,1)]",children:"Add"})]})]}),(0,n.jsxs)(L.z,{onClick:()=>{s(o)},disabled:0===o.length,className:"mt-4 flex h-auto w-full items-center justify-center gap-2 border-4 border-black bg-black px-6 py-3 text-lg font-bold text-white shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] transition-all hover:translate-x-1 hover:translate-y-1 hover:bg-gray-800 hover:shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] dark:border-gray-600 dark:bg-gray-800 dark:shadow-[4px_4px_0px_0px_rgba(75,85,99,1)] dark:hover:bg-gray-700 dark:hover:shadow-[2px_2px_0px_0px_rgba(75,85,99,1)] ".concat(0===o.length?"cursor-not-allowed opacity-50":""),children:["Next ",(0,n.jsx)(R.Z,{size:20})]})]})}let Z=i.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)("textarea",{className:(0,M.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...a})});function U(e){let{question:t,value:r,onChange:a,onSubmit:l}=e;return(0,n.jsxs)("div",{className:"flex h-full flex-col justify-between",children:[(0,n.jsx)("h3",{className:"mb-8 border-4 border-black bg-white p-4 text-xl font-bold shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200 dark:shadow-[4px_4px_0px_0px_rgba(75,85,99,1)]",children:t}),(0,n.jsxs)("div",{className:"mt-auto",children:[(0,n.jsx)(Z,{value:r||"",onChange:e=>a(e.target.value),placeholder:"Type your answer here...",className:"min-h-[150px] border-4 border-black bg-white p-4 text-lg font-medium shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] transition-all focus:translate-x-1 focus:translate-y-1 focus:shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] focus-visible:ring-0 focus-visible:ring-offset-0 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200 dark:shadow-[4px_4px_0px_0px_rgba(75,85,99,1)] dark:placeholder:text-gray-400 dark:focus:shadow-[2px_2px_0px_0px_rgba(75,85,99,1)]"}),(0,n.jsxs)(L.z,{onClick:l,disabled:!r,className:"mt-4 flex h-auto w-full items-center justify-center gap-2 border-4 border-black bg-black px-6 py-3 text-lg font-bold text-white shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] transition-all hover:translate-x-1 hover:translate-y-1 hover:bg-gray-800 hover:shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] dark:border-gray-600 dark:bg-gray-800 dark:shadow-[4px_4px_0px_0px_rgba(75,85,99,1)] dark:hover:bg-gray-700 dark:hover:shadow-[2px_2px_0px_0px_rgba(75,85,99,1)] ".concat(r?"":"cursor-not-allowed opacity-50"),children:["Next ",(0,n.jsx)(R.Z,{size:20})]})]})]})}Z.displayName="Textarea";var q=r(62790),B=r(21216);let W=["bg-yellow-300 dark:bg-yellow-600","bg-pink-400 dark:bg-pink-600","bg-blue-400 dark:bg-blue-600","bg-green-400 dark:bg-green-600","bg-purple-400 dark:bg-purple-600","bg-orange-400 dark:bg-orange-600","bg-red-400 dark:bg-red-600","bg-cyan-400 dark:bg-cyan-600"];function G(e){let{questions:t,handleSubmit:r}=e,[a,l]=(0,i.useState)({}),[s,o]=(0,i.useState)(0),[d,c]=(0,i.useState)(!1),[p,u]=(0,i.useState)(W[0]);(0,i.useEffect)(()=>{u(W[Math.floor(Math.random()*W.length)])},[s]);let m=(e,r)=>{let n={...a,[e]:r};l(n),"boolean"===t[e].type&&h(n)},h=e=>{s<t.length-1?setTimeout(()=>o(s+1),300):(c(!0),r(t,e))},g=()=>{s<t.length-1?o(s+1):(c(!0),r(t,a))},x=e=>{"prev"===e&&s>0?o(s-1):"next"===e&&s<t.length-1&&o(s+1)};return d?(0,n.jsxs)("div",{className:"mb-10 border-4 border-black bg-white p-8 shadow-[8px_8px_0px_0px_rgba(0,0,0,1)] dark:border-gray-600 dark:bg-gray-800 dark:shadow-[8px_8px_0px_0px_rgba(75,85,99,1)]",children:[(0,n.jsx)("h2",{className:"mb-6 text-3xl font-black text-black dark:text-gray-200",children:"RESPONSES SUBMITTED"}),(0,n.jsx)("div",{className:"space-y-6",children:t.map((e,t)=>{var r;return(0,n.jsxs)("div",{className:"border-b-2 border-black pb-4",children:[(0,n.jsx)("p",{className:"mb-2 font-bold",children:e.question}),(0,n.jsx)("p",{className:"font-medium",children:"boolean"==typeof a[t]?a[t]?"Yes":"No":Array.isArray(a[t])?a[t].join(", "):(null===(r=a[t])||void 0===r?void 0:r.toString())||"No response"})]},t)})}),(0,n.jsx)(L.z,{onClick:()=>{c(!1),o(0),l({})},className:"mt-8 h-auto border-2 border-black bg-black px-6 py-3 text-lg font-bold text-white shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] transition-all hover:translate-x-1 hover:translate-y-1 hover:bg-gray-800 hover:shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] dark:border-gray-600 dark:bg-gray-800 dark:shadow-[4px_4px_0px_0px_rgba(75,85,99,1)] dark:hover:bg-gray-700 dark:hover:shadow-[2px_2px_0px_0px_rgba(75,85,99,1)]",children:"Start Over"})]}):(0,n.jsxs)("div",{className:"".concat(p," mb-10 border-4 border-black p-4 shadow-[8px_8px_0px_0px_rgba(0,0,0,1)] dark:border-gray-600 dark:bg-opacity-90 dark:shadow-[8px_8px_0px_0px_rgba(75,85,99,1)] sm:p-8"),children:[(0,n.jsxs)("div",{className:"mb-6 flex flex-col items-center justify-between sm:flex-row",children:[(0,n.jsxs)("h2",{className:"text-2xl font-black text-black dark:text-gray-200",children:["QUESTION ",s+1,"/",t.length]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(L.z,{onClick:()=>x("prev"),disabled:0===s,className:"h-8 w-8 rounded-full border-2 border-black bg-white p-1 text-black shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] transition-all hover:translate-x-[1px] hover:translate-y-[1px] hover:shadow-[1px_1px_0px_0px_rgba(0,0,0,1)] disabled:opacity-50 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200 dark:shadow-[2px_2px_0px_0px_rgba(75,85,99,1)] dark:hover:shadow-[1px_1px_0px_0px_rgba(75,85,99,1)]",children:(0,n.jsx)(q.Z,{size:16})}),(0,n.jsx)("div",{className:"h-4 w-32 border-2 border-black bg-white dark:border-gray-600 dark:bg-gray-800",children:(0,n.jsx)("div",{className:"h-full bg-black dark:bg-gray-200",style:{width:"".concat((s+1)/t.length*100,"%")}})}),(0,n.jsx)(L.z,{onClick:()=>x("next"),disabled:s===t.length-1,className:"h-8 w-8 rounded-full border-2 border-black bg-white p-1 text-black shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] transition-all hover:translate-x-[1px] hover:translate-y-[1px] hover:shadow-[1px_1px_0px_0px_rgba(0,0,0,1)] disabled:opacity-50 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200 dark:shadow-[2px_2px_0px_0px_rgba(75,85,99,1)] dark:hover:shadow-[1px_1px_0px_0px_rgba(75,85,99,1)]",children:(0,n.jsx)(B.Z,{size:16})})]})," "]}),((e,t)=>{switch(e.type){case"boolean":return(0,n.jsx)(A,{question:e.question,value:a[t],onChange:e=>m(t,e)},t);case"multi-choice":return(0,n.jsx)(H,{question:e.question,options:e.options||[],initialSelected:a[t],onChange:e=>m(t,e),onSubmit:g},t);case"freeform":return(0,n.jsx)(U,{question:e.question,value:a[t],onChange:e=>m(t,e),onSubmit:g},t);default:return null}})(t[s],s)]})}var J=r(22580);let V=async e=>{let t=await (0,J.Z)(e,"apps");return[{title:t("examples.vocabularyBooster.title"),description:t("examples.vocabularyBooster.description"),prompt:t("examples.vocabularyBooster.prompt"),icon:"\uD83D\uDCDA"},{title:t("examples.resumeRoaster.title"),description:t("examples.resumeRoaster.description"),prompt:t("examples.resumeRoaster.prompt"),icon:"\uD83D\uDCC4"},{title:t("examples.harryPotterTrivia.title"),description:t("examples.harryPotterTrivia.description"),prompt:t("examples.harryPotterTrivia.prompt"),icon:"\uD83D\uDD2E"},{title:t("examples.zodiacGame.title"),description:t("examples.zodiacGame.description"),prompt:t("examples.zodiacGame.prompt"),icon:"\uD83E\uDDE9"},{title:t("examples.recipeGenerator.title"),description:t("examples.recipeGenerator.description"),prompt:t("examples.recipeGenerator.prompt"),icon:"\uD83C\uDF73"},{title:t("examples.interviewPrepCoach.title"),description:t("examples.interviewPrepCoach.description"),prompt:t("examples.interviewPrepCoach.prompt"),icon:"\uD83D\uDC54"},{title:t("examples.giftIdeas.title"),description:t("examples.giftIdeas.description"),prompt:t("examples.giftIdeas.prompt"),icon:"\uD83C\uDF81"},{title:t("examples.budgetBattle.title"),description:t("examples.budgetBattle.description"),prompt:t("examples.budgetBattle.prompt"),icon:"\uD83D\uDCB8"}]};function Y(e){let{numExamples:t=3,examples:r,onSelect:a}=e,l=r.slice(0,t);return(0,n.jsx)("div",{className:"grid grid-cols-1 gap-4 pb-4 2xl:grid-cols-3",children:l.map((e,t)=>(0,n.jsx)("div",{className:"cursor-pointer",onClick:()=>a(e.prompt),children:(0,n.jsxs)("div",{className:"h-full rounded-lg border-2 border-black bg-white p-4 transition-transform hover:scale-[1.02] hover:shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] dark:border-gray-600 dark:bg-cyan-900 dark:hover:shadow-[4px_4px_0px_0px_rgba(75,85,99,1)]",children:[(0,n.jsxs)("div",{className:"mb-2 flex items-center",children:[(0,n.jsx)("span",{className:"mr-2 text-2xl dark:text-white",children:e.icon}),(0,n.jsx)("h3",{className:"truncate font-bold text-black dark:text-white",children:e.title})]}),(0,n.jsx)("p",{className:"line-clamp-3 text-sm text-gray-600 dark:text-white",children:e.description})]})},t))})}var X=r(94308),$=r(81928),K=r(34533),Q=r(87444);function ee(e){let{role:t,backgroundColor:r,userAvatarUrl:a,width:l,children:s}=e,o="user"===t,i="assistant"===t,d="bg-gray-100 dark:bg-gray-800";i?d="bg-green-200 dark:bg-cyan-900":o?d="bg-blue-200 dark:bg-emerald-900":"system"===t&&(d="bg-amber-200 dark:bg-slate-700");let c=null!=r?r:d;return(0,n.jsx)("div",{className:"mb-2 pl-1 pr-1",children:(0,n.jsxs)("div",{className:"flex items-start",children:[(0,n.jsx)($.qE,{className:"mt-1 h-7 w-7 flex-shrink-0 rounded-full",children:o?(0,n.jsx)($.F$,{src:a,alt:"User avatar",className:"h-full w-full object-cover"}):i?(0,n.jsx)($.F$,{src:"/images/bud_avatar.svg",className:"h-full w-full object-cover dark:bg-white/90"}):"system"===t?(0,n.jsx)($.Q5,{className:"flex items-center justify-center bg-transparent",children:(0,n.jsx)(K.Z,{className:"h-5 w-5 text-amber-400 dark:text-amber-300"})}):(0,n.jsx)($.Q5,{className:"flex items-center justify-center bg-transparent",children:(0,n.jsx)(Q.Z,{className:"h-5 w-5 text-black dark:text-white"})})}),(0,n.jsx)("div",{className:"ml-1 max-w-full overflow-x-auto ".concat("full"===l?"flex-1":""),children:(0,n.jsx)("div",{className:"relative w-full rounded-md border-2 border-black p-2 px-3 ".concat(c," rounded-br-none rounded-tl-none shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] outline-none placeholder:text-gray-500 focus:outline-none dark:border-black dark:text-white dark:shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] "),children:s})})]})})}var et=r(50141),er=r(17724);let en=e=>{let{message:t,loading:r}=e,a=(e,r,n)=>t&&void 0!==t[e]?"No change"===t[e]?"noChange":!r&&n||r&&void 0===t[r]?"loading":"completed":"empty",l=(e,t,r,l)=>{let s=a(t,r,l),o="";switch(s){case"completed":o="✅";break;case"noChange":o="➖";break;default:o=""}return"empty"===s||"noChange"===s?null:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("span",{className:"mr-1 font-medium text-black dark:text-white",children:e}),"loading"===s?(0,n.jsx)(E.Z,{className:"ml-2 dark:text-black"}):(0,n.jsx)("span",{className:"ml-1",children:o})]},e)};return!t||void 0===t.cssRequest&&r?(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("span",{className:"mr-1 font-medium text-black dark:text-white",children:"Updating"}),(0,n.jsx)(E.Z,{className:"ml-1 dark:text-black"})]},"updating"):(0,n.jsxs)("div",{className:"planning-interface-changes",children:[l("Updating Styles","cssRequest","jsRequest",r),l("Updating Logic","jsRequest","htmlRequest",r),l("Updating Layout","htmlRequest",void 0,r)]})};var ea=e=>{let{content:t,loading:r}=e,[a,l]=(0,i.useState)({});return(0,i.useEffect)(()=>{let e=(e=>{try{return JSON.parse(e)}catch(e){return{}}})(t);l(t=>Object.keys(e).some(r=>e[r]!==t[r])?e:t)},[t]),(0,n.jsx)(en,{message:a,loading:r})},el=r(78301);function es(e){let{errorType:t,payload:r,onFix:a,onSkip:l,onSelectImage:s}=e,[o,d]=(0,i.useState)(!1),c="resource-error"===t&&"img"===r.tag||"resource-error-queue"===t,p="resource-error-queue"===t&&(r.totalErrors||0)>1;return(0,n.jsx)(ee,{role:"system",backgroundColor:"bg-red-300 dark:bg-red-900",children:(0,n.jsxs)("div",{className:"flex min-w-[300px] flex-col font-medium text-black dark:text-white",children:[(0,n.jsx)(()=>{var e,a;switch(t){case"runtime-error":return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:"font-semibold",children:"Runtime error"}),(0,n.jsx)("p",{className:"break-words",children:r.message}),r.filename&&(0,n.jsxs)("p",{className:"text-sm opacity-70",children:[r.filename,":",r.lineno,":",r.colno]})]});case"resource-error":return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("p",{className:"font-semibold capitalize",children:[null!==(e=r.tag)&&void 0!==e?e:"resource"," failed to load"]}),(0,n.jsx)("p",{className:"break-all text-sm opacity-90",children:r.src}),"img"===r.tag&&(0,n.jsx)("p",{className:"mt-1 text-sm opacity-70",children:"The image couldn't be loaded. You can select a replacement."})]});case"resource-error-queue":let l=(null===(a=r.queue)||void 0===a?void 0:a.filter(e=>"img"===e.payload.tag))||[],s=l.length;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("p",{className:"font-semibold",children:[s," image",1!==s?"s":""," failed to load"]}),l.length>0&&(0,n.jsx)("div",{className:"mt-2 text-sm opacity-90",children:l.map((e,t)=>{var r;return(0,n.jsxs)("p",{className:"break-words",children:["•"," ",e.payload.alt||(null===(r=e.payload.src)||void 0===r?void 0:r.split("/").pop())||"Untitled image"]},t)})}),(0,n.jsxs)("p",{className:"mt-2 text-sm opacity-70",children:["You can select replacement",1!==s?"s":""," for"," ",1!==s?"these images":"this image","."]})]});case"unhandledrejection":return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:"font-semibold",children:"Unhandled promise rejection"}),(0,n.jsx)("p",{className:"break-words",children:r.message})]});default:return(0,n.jsx)("p",{className:"break-words",children:r.message})}},{}),r.stack&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{className:"mt-2 self-start text-sm underline",onClick:()=>d(e=>!e),children:o?"hide details":"show details"}),o&&(0,n.jsx)("pre",{className:"mt-1 max-h-60 overflow-auto text-xs leading-5",children:r.stack})]}),(0,n.jsxs)("div",{className:"flex justify-center gap-4 py-3",children:[(0,n.jsx)(L.z,{className:"w-4 rounded-none border-4 border-black bg-gray-400 px-8 py-3 text-lg font-bold text-black shadow-[5px_5px_0_0_rgba(0,0,0,1)] transition-all hover:-translate-x-[3px] hover:-translate-y-[3px] hover:shadow-[8px_8px_0_0_rgba(0,0,0,1)]",onClick:l,children:"Skip"}),(0,n.jsx)(L.z,{className:"w-40 rounded-none border-4 border-black bg-orange-400 px-8 py-3 text-lg font-bold text-black shadow-[5px_5px_0_0_rgba(0,0,0,1)] transition-all hover:-translate-x-[3px] hover:-translate-y-[3px] hover:shadow-[8px_8px_0_0_rgba(0,0,0,1)]",onClick:c&&s?s:a,children:c?p?"Select Images":"Select Image":"Fix"})]})]})})}var eo=r(98821),ei=r.n(eo);let ed=ei()(()=>r.e(1504).then(r.t.bind(r,11504,23)),{loadableGenerated:{webpack:()=>[11504]},ssr:!1,loading:()=>(0,n.jsx)(E.Z,{className:"my-4 dark:text-black"})}),ec={tabSize:2,MozTabSize:2,OTabSize:2};function ep(e){let{oldCode:t,newCode:r,split:a=!0,showDiffOnly:l=!0,extraLinesSurroundingDiff:s=0,hideLineNumbers:o=!0}=e;return(0,n.jsx)("div",{className:"max-w-full overflow-x-auto",children:(0,n.jsx)(ed,{oldValue:t,newValue:r,splitView:a,showDiffOnly:l,extraLinesSurroundingDiff:s,hideLineNumbers:o,compareMethod:"diffWords",styles:{variables:{light:{codeFoldGutterBackground:"#f6f8fa"},dark:{codeFoldGutterBackground:"#1f2937"}},diffContainer:{fontSize:"0.75rem",lineHeight:"1rem",overflowX:"auto",...ec},content:{overflowX:"auto"},contentText:{fontSize:"0.80rem",lineHeight:"1rem",whiteSpace:"pre",wordBreak:"normal",overflowX:"auto",overflowY:"hidden",...ec},lineNumber:{fontSize:"0.65rem",padding:"0 4px",...ec},marker:{fontSize:"0.65rem",...ec},codeFold:{fontSize:"0.70rem"}}})})}var eu=e=>{let{oldCode:t,newCode:r}=e,[a,l]=(0,i.useState)(!1);return(0,n.jsxs)("details",{className:"mt-3",onToggle:e=>{e.target.open&&l(!0)},children:[(0,n.jsx)("summary",{className:"cursor-pointer select-none text-sm font-medium text-black/70 hover:text-black dark:text-white/70 dark:hover:text-white",children:"View changes from previous version"}),a&&(0,n.jsx)("div",{className:"mt-2 overflow-x-auto border-2 border-black",children:(0,n.jsx)(ep,{oldCode:t,newCode:r,split:!1})})]})},em=r(5673);function eh(e){let{onClose:t}=e,{t:r}=(0,s.Z)("apps"),{userUsage:a,creditBalance:l}=(0,em.$)(),o=(null==a?void 0:a.plan)==="free"||1e3>=((null==a?void 0:a.credit_balance)||0);if((()=>{if(!o||!(null==a?void 0:a.daily_gen_reset_ts)||!(null==a?void 0:a.daily_gen_spent))return!1;let e=new Date(a.daily_gen_reset_ts);return new Date>=new Date(e.getTime()+864e5)||250>(a.daily_gen_spent||0)})())return null;let i=o?(()=>{if(!(null==a?void 0:a.daily_gen_reset_ts))return"24 hours";let e=new Date(a.daily_gen_reset_ts),t=new Date,r=new Date(e.getTime()+864e5).getTime()-t.getTime();if(r<=0)return"24 hours";let n=Math.floor(r/36e5),l=Math.floor(r%36e5/6e4),s=Math.floor(r%6e4/1e3),o=[];return(n>0&&o.push("".concat(n," hour").concat(1!==n?"s":"")),l>0&&o.push("".concat(l," minute").concat(1!==l?"s":"")),s>0&&0===n&&o.push("".concat(s," second").concat(1!==s?"s":"")),0===o.length)?"0 seconds":1===o.length?o[0]:2===o.length?"".concat(o[0]," and ").concat(o[1]):"".concat(o[0],", ").concat(o[1],", and ").concat(o[2])})():"";return(0,n.jsx)(ee,{role:"system",backgroundColor:"bg-orange-200 dark:bg-orange-900",children:(0,n.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,n.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,n.jsx)("h3",{className:"text-lg font-bold text-black dark:text-white",children:r("builder.errors.insufficientCredits.title")}),(0,n.jsx)("p",{className:"text-sm font-medium text-black dark:text-white",children:r("builder.errors.insufficientCredits.description")})]}),o?(0,n.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,n.jsx)("p",{className:"text-sm text-black dark:text-white",children:r("builder.errors.insufficientCredits.freeTier.resetInfo",{timeRemaining:i})}),(0,n.jsx)("p",{className:"text-sm text-black dark:text-white",children:r("builder.errors.insufficientCredits.freeTier.upgradePrompt")})]}):(0,n.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,n.jsx)("p",{className:"text-sm text-black dark:text-white",children:r("builder.errors.insufficientCredits.paidTier.monthlyLimitReached")}),(0,n.jsx)("p",{className:"text-sm text-black dark:text-white",children:r("builder.errors.insufficientCredits.paidTier.upgradePrompt")})]}),(0,n.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,n.jsx)(p(),{href:"/pricing",target:"_blank",children:(0,n.jsx)(L.z,{className:"rounded-none border-2 border-black bg-blue-500 font-bold text-white shadow-[2px_2px_0_0_rgba(0,0,0,1)] transition-all hover:-translate-x-[1px] hover:-translate-y-[1px] hover:bg-blue-600 hover:shadow-[3px_3px_0_0_rgba(0,0,0,1)] dark:border-gray-600",size:"sm",children:r(o?"builder.errors.insufficientCredits.actions.upgrade":"builder.errors.insufficientCredits.actions.viewPricing")})}),t&&(0,n.jsx)(L.z,{variant:"outline",className:"rounded-none border-2 border-black bg-white font-bold text-black shadow-[2px_2px_0_0_rgba(0,0,0,1)] transition-all hover:-translate-x-[1px] hover:-translate-y-[1px] hover:bg-gray-100 hover:shadow-[3px_3px_0_0_rgba(0,0,0,1)] dark:border-gray-600 dark:bg-gray-800 dark:text-white dark:hover:bg-gray-700",size:"sm",onClick:t,children:r("builder.errors.insufficientCredits.actions.close")})]})]})})}let eg=e=>{let{url:t}=e,[r,a]=(0,i.useState)(!1);return r?(0,n.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70",children:(0,n.jsxs)("div",{className:"relative max-h-screen max-w-screen-lg",children:[(0,n.jsx)("button",{onClick:()=>a(!1),className:"absolute -right-4 -top-4 rounded-full bg-black p-1 text-white hover:bg-gray-800",children:(0,n.jsx)(b.Z,{size:20})}),(0,n.jsx)("img",{src:t,alt:"Expanded",className:"max-h-[90vh] max-w-full rounded"})]})}):(0,n.jsx)("div",{className:"mt-2 inline-block cursor-pointer overflow-hidden rounded border-2 border-gray-300",children:(0,n.jsx)("img",{src:t,alt:"User uploaded",className:"max-h-48 w-auto transition-transform hover:scale-105",onClick:()=>a(!0)})})},ex=i.memo(function(e){var t,r,a,l;let{message:s,index:o,messages:d,streaming:c,userProfile:u,setCreatedLoops:m,setActiveLoopId:h,setActiveTab:g,onRestoreVersion:b,onFixResponse:f,onSelectImage:v,htmlMetaById:y}=e;if((0,i.useCallback)(e=>navigator.clipboard.writeText(e),[]),(0,i.useCallback)(e=>console.log("Retrying message with id: ".concat(e)),[]),(0,i.useCallback)(e=>console.log("Thumbs‑up for message ".concat(e)),[]),(0,i.useCallback)(e=>console.log("Thumbs‑down for message ".concat(e)),[]),!(null==s?void 0:s.type)||"app_question_responses"===s.type)return null;if("insufficient_credits"===s.type)return(0,n.jsx)(eh,{});if("modifyUserInterface"===s.type)try{let{description:e}=null!==(t=(0,el.OA)(s.content))&&void 0!==t?t:{};return(0,n.jsx)(ee,{role:"assistant",children:(0,n.jsx)("div",{className:"prose overflow-x-auto font-medium text-black dark:text-white",children:(0,n.jsx)(et.s,{remarkPlugins:[X.Z],children:e})})})}catch(e){console.error(e)}if("planningInterfaceChanges"===s.type){let e=o===d.length-1;return(0,n.jsx)(ee,{role:"system",children:(0,n.jsx)(ea,{content:s.content,loading:e})})}if("loops"===s.type)try{let e=JSON.parse(s.content);return(0,n.jsx)(ee,{role:"assistant",backgroundColor:"bg-amber-200 dark:bg-cyan-900",width:"full",children:e.map(e=>{let{loop:t,loopGen:r}=e;return(0,n.jsxs)("div",{className:"my-2 flex flex-col rounded-lg border-2 border-black bg-white p-4 shadow-[2px_2px_0_0_rgba(0,0,0,1)] dark:bg-gray-800",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(x.Z,{className:"h-4 w-4 text-black dark:text-white"}),(0,n.jsx)(p(),{href:"/loop/".concat(t.id),target:"_blank",className:"line-clamp-1 text-pretty text-sm font-medium hover:underline dark:text-white",children:t.name})]}),(0,n.jsx)(er.C,{variant:t.published?"secondary":"outline",className:"border-2 border-black shadow-[1px_1px_0_0_rgba(0,0,0,1)] dark:border-gray-300 dark:text-white",children:t.published?"Active":"Draft"})]}),(0,n.jsx)(L.z,{variant:"outline",size:"sm",onClick:()=>{m(e=>e.some(e=>e.loop.id===t.id)?e:[...e,{loop:t,loopGen:r,status:"pending"}]),h(t.id),g("loops")},className:"mt-4 border-2 border-black bg-white text-black shadow-[2px_2px_0_0_rgba(0,0,0,1)] transition-all hover:shadow-[1px_1px_0_0_rgba(0,0,0,1)] dark:border-black dark:bg-gray-700 dark:text-white dark:hover:bg-gray-600",children:"Open in Editor"})]},t.id)})})}catch(e){console.error(e)}if(["editRequest","gather_requirements","generatingUI","appSchema","create_app","loopGen"].includes(s.type)){let e=o===d.length-1;return(0,n.jsx)(ee,{role:"system",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("span",{className:"font-medium text-black dark:text-white",children:null!==(r=({generatingUI:"Prototyping App UI",appSchema:"Orchestrating App Plan",gather_requirements:"Gathering Feedback on App Design",loopGen:"Generating Loops",create_app:"Generating App Description",editRequest:"Generating App Change"})[s.type])&&void 0!==r?r:"Generating"}),e?(0,n.jsx)(E.Z,{className:"ml-2 dark:text-black"}):(0,n.jsx)("span",{className:"ml-2",children:"✅"})]})})}if(["html","update_html","updateInterface","finalizeApp"].includes(s.type)){let{prev:e,version:t}=null!==(a=y.get("message-".concat(o)))&&void 0!==a?a:{prev:null,version:0},r=o===d.length-1,l="finalizeApp"===s.type?"Connecting Loops to App":"Generating App UI",i="html"===s.type?"Prototype Design":"finalizeApp"===s.type?"Finished App":"App Updated";return(0,n.jsxs)(ee,{role:"system",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("span",{className:"font-medium text-black dark:text-white",children:r?l:i}),r?(0,n.jsx)(E.Z,{className:"ml-2 dark:text-black"}):(0,n.jsx)("span",{className:"ml-2",children:"✅"}),!r&&(0,n.jsx)(L.z,{onClick:()=>b(s),className:"ml-4 h-auto rounded-none border-2 border-black bg-white px-3 py-0 font-bold text-black opacity-30 shadow-[2px_2px_0_0_rgba(0,0,0)] transition-all hover:translate-x-[2px] hover:translate-y-[2px] hover:bg-gray-100 hover:opacity-100 hover:shadow-[2px_2px_0_0_rgba(0,0,0)]",children:t?"v".concat(t):"Restore"})]}),e&&(0,n.jsx)(eu,{oldCode:e.content,newCode:s.content})]})}if("app-error"===s.type){let e;try{e="string"==typeof s.content?JSON.parse(s.content):s.content}catch(t){e={type:"unknown",payload:{}}}return"unknown"===e.type?(0,n.jsx)(ee,{role:"system",backgroundColor:"bg-red-300 dark:bg-red-900",children:(0,n.jsx)("div",{className:"prose overflow-x-auto font-medium text-black dark:text-white",children:String(s.content)})}):(null===(l=e.payload)||void 0===l?void 0:l.message)||"resource-error-queue"===e.type?(0,n.jsx)(es,{errorType:e.type,payload:e.payload,onFix:()=>f(s,!0),onSkip:()=>f(s,!1),onSelectImage:v}):null}return"image"===s.type?(0,n.jsx)(ee,{role:"ai"===s.role?"assistant":"user"===s.role?"user":"other",userAvatarUrl:null==u?void 0:u.avatar_url,children:(0,n.jsx)("div",{className:"prose font-medium text-black dark:text-white",children:(0,n.jsx)("img",{src:s.content,alt:"User uploaded",className:"max-h-60 max-w-xs rounded border border-gray-300 dark:border-gray-700",style:{objectFit:"contain"}})})}):("ai"===s.role||s.role,(0,n.jsx)(ee,{role:"user"===s.role?"user":"assistant",userAvatarUrl:"user"===s.role?null==u?void 0:u.avatar_url:void 0,children:(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsx)("div",{className:"prose overflow-x-auto font-medium text-black dark:text-white",children:"image"===s.type?(0,n.jsx)("img",{src:s.content,alt:"User uploaded",className:"max-h-80 w-auto rounded"}):(0,n.jsx)(et.s,{remarkPlugins:[X.Z],children:s.content||""})}),Array.isArray(s.images)&&s.images.length>0&&(0,n.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:s.images.map((e,t)=>(0,n.jsx)(eg,{url:e.url},t))}),!1]})}))});function eb(e){let{nextStep:t,onConfirm:r,onCancel:a}=e;return(0,n.jsxs)("div",{className:"flex w-[300px] flex-col",children:[(0,n.jsx)("div",{className:"prose font-medium text-black dark:text-white",children:t}),(0,n.jsxs)("div",{className:"flex justify-center gap-2 py-3",children:[(0,n.jsx)(L.z,{onClick:a,className:"rounded-none border-4 border-black bg-red-400 px-8 py-3 text-lg font-bold text-black shadow-[5px_5px_0_0_rgba(0,0,0,1)] transition-all hover:-translate-x-[3px] hover:-translate-y-[3px] hover:shadow-[8px_8px_0_0_rgba(0,0,0,1)]",children:"No"}),(0,n.jsx)(L.z,{onClick:r,className:"animate-bounce rounded-none border-4 border-black bg-green-400 px-8 py-3 text-lg font-bold text-black shadow-[5px_5px_0_0_rgba(0,0,0,1)] transition-all hover:-translate-x-[3px] hover:-translate-y-[3px] hover:shadow-[8px_8px_0_0_rgba(0,0,0,1)]",children:"Yes"})]})]})}let ef=i.memo(function(e){var t,r;let{messages:a,progress:l,streaming:o=!1,userProfile:d,imageErrorQueue:c,setCreatedLoops:u,setActiveLoopId:m,setActiveTab:h,confirmStepTransition:g,cancelStepTransition:x,onRestoreVersion:b,onFixResponse:f,onSelectImage:v,getAppUrl:y,elementEditingMode:k=!1}=e,w=(0,i.useMemo)(()=>a.filter(e=>e&&"element-selected"!==e.type),[a]),_=(0,i.useMemo)(()=>w.slice(0,-1),[w]),j=w[w.length-1],N=(0,i.useMemo)(()=>{let e=new Map,t=null,r=0;for(let n=0;n<a.length;n++){let l=a[n];l&&["html","update_html","updateInterface","finalizeApp"].includes(l.type)&&(e.set("message-".concat(n),{prev:t,version:r,idx:n}),t=l,r+=1)}return e},[a]),E=(0,i.useRef)(null),C=(0,i.useRef)(null);(0,i.useLayoutEffect)(()=>{E.current&&(E.current.scrollTop=E.current.scrollHeight)},[w.length]),(0,i.useLayoutEffect)(()=>{o&&C.current&&C.current.scrollIntoView({behavior:"auto"})},[o,null==j?void 0:j.content]),(0,i.useLayoutEffect)(()=>{C.current&&C.current.scrollIntoView({behavior:"smooth"})},[k,l.status,l.step]);let L={userProfile:d,setCreatedLoops:u,setActiveLoopId:m,setActiveTab:h,onRestoreVersion:b,onFixResponse:f,onSelectImage:v,htmlMetaById:N},{t:D}=(0,s.Z)("apps"),I={createSchema:D("builder.steps.createSchema"),generateHtml:D("builder.steps.generateHtml"),generateLoops:D("builder.steps.generateLoops"),finalize:D("builder.steps.finalize")},A=!0;if((null==j?void 0:j.type)==="app-error"){let e;try{e="string"==typeof j.content?JSON.parse(j.content):j.content,(null===(t=e.payload)||void 0===t?void 0:t.message)&&(A=!1)}catch(e){}}return(null==j?void 0:j.type)==="insufficient_credits"&&(A=!1),(0,n.jsxs)("div",{ref:E,className:"flex-1 overflow-y-auto pr-3 pt-4",children:[_.map((e,t)=>(0,n.jsx)(ex,{message:e,index:t,messages:a,streaming:!1,...L},"message-".concat(t))),j&&(0,n.jsx)(ex,{message:j,index:w.length-1,messages:a,streaming:o,...L},"tail-".concat(w.length-1)),(0,n.jsx)("div",{ref:C}),A&&"success"===l.status&&["generateHtml","finalize"].includes(l.step)&&(0,n.jsx)(ee,{role:"assistant",backgroundColor:"bg-green-200 dark:bg-cyan-700",children:(0,n.jsx)(eb,{nextStep:null!==(r=I[l.step])&&void 0!==r?r:l.step,onConfirm:g,onCancel:x})}),"success"===l.status&&"done"===l.step&&(0,n.jsx)(ee,{role:"assistant",backgroundColor:"bg-green-200 dark:bg-cyan-700",children:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("span",{className:"prose font-medium text-black dark:text-white",children:"Check out your app here:"}),(0,n.jsx)(p(),{href:y(),target:"_blank",children:(0,n.jsx)(S.Z,{className:"h-[32px] bg-sky-300 font-medium hover:bg-sky-400 dark:bg-sky-600 dark:text-white dark:hover:bg-sky-700",children:"View App"})})]})}),k&&(0,n.jsx)(ee,{role:"assistant",backgroundColor:"bg-purple-200 dark:bg-purple-900",children:(0,n.jsx)("div",{className:"font-medium text-black dark:text-white",children:(0,n.jsxs)("div",{className:"flex items-start gap-3",children:[(0,n.jsx)("div",{className:"text-2xl",children:"\uD83C\uDFAF"}),(0,n.jsxs)("div",{className:"flex-1 space-y-4",children:[(0,n.jsx)("p",{className:"mb-2 mt-2 font-bold",children:"Edit Mode Active!"}),(0,n.jsx)("p",{className:"mb-2 mt-2",children:"I can help you modify any element on your app. Here's how:"}),(0,n.jsxs)("ol",{className:"mb-1 ml-4 mt-4 list-decimal space-y-4",children:[(0,n.jsxs)("li",{children:[(0,n.jsx)("span",{className:"font-bold",children:"Click on any element"})," in the preview (text, images, buttons, etc.)"]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("span",{className:"font-bold",children:"Tell me what you'd like to change"}),", for example:"]})]}),(0,n.jsxs)("ul",{className:"mb-2 ml-8 mt-0 list-disc space-y-2 pb-2 text-sm",children:[(0,n.jsx)("li",{children:'"Change this text to say..."'}),(0,n.jsx)("li",{children:'"Make this button bigger"'}),(0,n.jsx)("li",{children:'"Update this image"'}),(0,n.jsx)("li",{children:'"Change the color to..."'})]})]})]})})})]})});var ev=r(28321),ey=r(74372),ek=r(98911),ew=r(88735),e_=r.n(ew);let ej=e=>{let{onVoiceInput:t,disabled:r=!1}=e,[a,l]=(0,i.useState)(!1),[s,o]=(0,i.useState)(!1),[d,c]=(0,i.useState)(null),[p,u]=(0,i.useState)(!1),m=(0,i.useRef)(null),h=(0,i.useRef)(null),g=(0,i.useRef)(null);(0,i.useEffect)(()=>{let e=window.SpeechRecognition||window.webkitSpeechRecognition;if(e){o(!0),m.current=new e;let r=m.current;r.continuous=!1,r.interimResults=!1,r.lang="en-US",r.maxAlternatives=1,r.onstart=()=>{l(!0),c(null),u(!1),h.current=setTimeout(()=>{m.current&&m.current.stop()},3e5),g.current=setTimeout(()=>{m.current&&a&&(m.current.stop(),c("Stopped recording due to 30 seconds of silence."),u(!0),setTimeout(()=>u(!1),3e3))},3e4)},r.onresult=e=>{var r,n,a;let l=null===(a=e.results[0])||void 0===a?void 0:null===(n=a[0])||void 0===n?void 0:null===(r=n.transcript)||void 0===r?void 0:r.trim();l?(t(l),c(null)):(c("No speech detected. Please try again."),u(!0))},r.onend=()=>{l(!1),h.current&&(clearTimeout(h.current),h.current=null),g.current&&(clearTimeout(g.current),g.current=null)},r.onerror=e=>{l(!1);let t="Voice recognition failed. ";switch(e.error){case"no-speech":t+="No speech detected. Please try speaking clearly.";break;case"audio-capture":t+="Microphone access denied or unavailable.";break;case"not-allowed":t+="Microphone permission denied. Please allow microphone access.";break;case"network":t+="Network error. Please check your connection.";break;case"service-not-allowed":t+="Speech service not available.";break;case"bad-grammar":t+="Speech not recognized. Please try again.";break;case"language-not-supported":t+="Language not supported.";break;default:t+="Error: ".concat(e.error)}c(t),u(!0),setTimeout(()=>u(!1),5e3),h.current&&(clearTimeout(h.current),h.current=null),g.current&&(clearTimeout(g.current),g.current=null)},r.onspeechstart=()=>{c(null),u(!1),g.current&&clearTimeout(g.current),g.current=setTimeout(()=>{m.current&&a&&(m.current.stop(),c("Stopped recording due to 30 seconds of silence."),u(!0),setTimeout(()=>u(!1),3e3))},3e4)},r.onspeechend=()=>{g.current&&clearTimeout(g.current),g.current=setTimeout(()=>{m.current&&a&&(m.current.stop(),c("Stopped recording due to 30 seconds of silence."),u(!0),setTimeout(()=>u(!1),3e3))},3e4)},r.onnomatch=()=>{c("Speech not recognized. Please try speaking more clearly."),u(!0)}}else o(!1),console.warn("Speech Recognition not supported in this browser");return()=>{m.current&&m.current.stop(),h.current&&clearTimeout(h.current),g.current&&clearTimeout(g.current)}},[t]);let x=(0,i.useCallback)(()=>{if(m.current&&!a&&!r)try{m.current.start()}catch(e){console.warn("Failed to start speech recognition:",e),c("Failed to start voice recognition. Please try again."),u(!0)}},[a,r]),b=(0,i.useCallback)(()=>{m.current&&a&&m.current.stop()},[a]);return s?(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsxs)("button",{type:"button",onClick:()=>{a?b():x()},disabled:r,className:"\n          rounded-none border-2 border-black p-2 font-bold transition-all duration-200\n          dark:border-gray-600 dark:shadow-[2px_2px_0px_0px_rgba(75,85,99,1)]\n          ".concat(a?"bg-red-400 text-black shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] hover:-translate-x-0.5 hover:-translate-y-0.5 hover:bg-red-500 hover:shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] dark:bg-red-600 dark:text-white dark:hover:bg-red-700":r?"cursor-not-allowed bg-gray-300 text-gray-500 shadow-[2px_2px_0px_0px_rgba(0,0,0,1)]":"bg-green-400 text-black shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] hover:-translate-x-0.5 hover:-translate-y-0.5 hover:bg-green-500 hover:shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] dark:bg-green-600 dark:text-white dark:hover:bg-green-700","\n        "),title:a?"Click to stop recording • Auto-stops after 30s of silence":r?"Voice input disabled":"Click to start voice input • Auto-stops after 30s of silence",children:[(0,n.jsx)("div",{className:"relative z-10 flex items-center justify-center",children:a?(0,n.jsx)("svg",{width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("rect",{x:"6",y:"6",width:"12",height:"12",rx:"2"})}):(0,n.jsx)("svg",{width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"0.5",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 11a7 7 0 0 1-7 7m0 0a7 7 0 0 1-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 0 1-3-3V5a3 3 0 1 1 6 0v6a3 3 0 0 1-3 3Z"})})}),(0,n.jsx)("span",{className:"sr-only",children:a?"Stop voice recording":"Start voice recording"})]}),a&&(0,n.jsx)("div",{className:"absolute -bottom-10 left-1/2 z-10 -translate-x-1/2 transform whitespace-nowrap",children:(0,n.jsx)("div",{className:"rounded-lg bg-red-500 px-3 py-1 text-xs text-white shadow-lg",children:"Recording"})}),p&&d&&(0,n.jsx)("div",{className:"absolute -top-16 left-1/2 z-50 -translate-x-1/2 transform",children:(0,n.jsxs)("div",{className:"max-w-xs rounded-lg bg-red-600 px-3 py-2 text-center text-xs text-white shadow-lg",children:[d,(0,n.jsx)("div",{className:"absolute left-1/2 top-full h-0 w-0 -translate-x-1/2 transform border-l-4 border-r-4 border-t-4 border-transparent border-t-red-600"})]})})]}):null};function eN(e){let{input:t,setInput:r,onSend:a,appId:l,streaming:s=!1,error:o,isDraggingOver:d,setIsDraggingOver:c,selectedElement:p=null,clearSelectedElement:u,onVoiceInput:m}=e,h=(0,i.useRef)(null),g=(0,i.useRef)(null),x=(0,i.useRef)(null),[v,y]=(0,i.useState)([]),[k,w]=(0,i.useState)(!1),[_,j]=(0,i.useState)(!1),[N,E]=(0,i.useState)(null),C=null!=d?d:k,S=null!=c?c:w,D=(0,i.useCallback)((e,t,r)=>{let n=e.trim()||"";if(t){let e=n;r&&(e=n||"Update the image"),n="I want to modify this element: ".concat(t.elementName,"\n\nElement HTML:\n").concat(t.html,"\n\n").concat(r?"New image URL to use: ".concat(r):"","\n\nUser request: ").concat(e,"\n\nPlease update the HTML to incorporate the user's requested changes.").concat(r?" Use the provided image URL where appropriate.":"")}return n},[]),I=(0,i.useMemo)(()=>p?N?"Describe how to use this image (or press Enter)...":"Describe your changes...":C?"Drop images here...":"What do you want to build?",[p,N,C]),A=(0,i.useMemo)(()=>!t.trim()&&0===v.length&&!(p&&N),[t,v.length,p,N]),O=(0,i.useCallback)(()=>{if(h.current){h.current.style.height="auto";let e=h.current.scrollHeight;h.current.style.height="".concat(Math.min(e,200),"px"),e>200?h.current.style.overflowY="auto":h.current.style.overflowY="hidden"}},[]);(0,i.useEffect)(()=>{let e;let t=setTimeout(()=>{e=requestAnimationFrame(O)},16);return()=>{clearTimeout(t),e&&cancelAnimationFrame(e)}},[t,O]),(0,i.useEffect)(()=>{p||E(null)},[p]);let M=(0,i.useCallback)(e=>{m&&m(e)},[m]),T=async e=>{if(!e.type.startsWith("image/")){alert("Only image files are supported");return}let n=new FormData;n.append("file",e),l&&n.append("appId",l);let a="";try{let e=await fetch("/api/uploadChatImage",{method:"POST",body:n}),t=await e.json();if(!e.ok)throw Error(t.message||"Upload failed");a=t.imageUrl}catch(e){alert("Image upload failed: "+(e.message||e));return}if(p){var s;E(a),t.trim()||(null===(s=p.tagName)||void 0===s?void 0:s.toLowerCase())!=="img"||r("Update the image src with the new image")}else y(e=>[...e,a])},z=async e=>{let t=e.target.files;if(t&&0!==t.length){for(let e=0;e<t.length;e++)await T(t[e]);x.current&&(x.current.value="")}},F=async e=>{e.preventDefault(),e.stopPropagation(),S(!1);let t=e.dataTransfer.files;if(0!==t.length)for(let e=0;e<t.length;e++){let r=t[e];r.type.startsWith("image/")&&await T(r)}};return(0,n.jsxs)("div",{children:[p&&(0,n.jsxs)("div",{className:"mb-3 rounded-lg border-2 border-purple-300 bg-purple-50 dark:border-purple-600 dark:bg-purple-900/30",children:[(0,n.jsxs)("div",{className:"flex cursor-pointer items-center justify-between p-3",onClick:()=>j(!_),children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(f.Z,{className:"h-4 w-4 text-purple-600 dark:text-purple-400"}),(0,n.jsxs)("span",{className:"font-medium text-purple-800 dark:text-purple-200",children:["Selected Component: ",p.elementName]}),_?(0,n.jsx)(ev.Z,{className:"h-4 w-4 text-purple-600 dark:text-purple-400"}):(0,n.jsx)(B.Z,{className:"h-4 w-4 text-purple-600 dark:text-purple-400"})]}),(0,n.jsx)("button",{onClick:e=>{e.stopPropagation(),null==u||u(),j(!1),E(null)},className:"text-purple-600 hover:text-purple-800 dark:text-purple-400 dark:hover:text-purple-200",children:(0,n.jsx)(b.Z,{className:"h-4 w-4"})})]}),_&&(0,n.jsxs)("div",{className:"border-t border-purple-200 p-3 dark:border-purple-700",children:[(0,n.jsx)("div",{className:"mb-2 text-sm font-medium text-purple-700 dark:text-purple-300",children:"Element Code:"}),(0,n.jsx)("pre",{className:"max-h-32 overflow-x-auto rounded bg-purple-100 p-2 text-xs text-purple-800 dark:bg-purple-900/50 dark:text-purple-200",children:p.html})]}),N&&(0,n.jsxs)("div",{className:"border-t border-purple-200 p-3 dark:border-purple-700",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(ey.Z,{className:"h-4 w-4 text-purple-600 dark:text-purple-400"}),(0,n.jsx)("span",{className:"text-sm text-purple-700 dark:text-purple-300",children:"Image ready to apply to element"})]}),(0,n.jsx)("div",{className:"mt-2",children:(0,n.jsx)(e_(),{src:N,alt:"Image to apply",width:100,height:100,className:"h-20 w-auto rounded border border-purple-300 dark:border-purple-600"})})]}),(0,n.jsx)("div",{className:"border-t border-purple-200 p-3 dark:border-purple-700",children:(0,n.jsxs)("p",{className:"text-sm font-medium text-purple-800 dark:text-purple-200",children:["\uD83D\uDCAC"," ",N?"Describe how to use this image or press Enter to apply it":"What would you like to change about this ".concat(p.tagName,"?")]})})]}),v.length>0&&(0,n.jsx)("div",{className:"mb-2 flex flex-wrap gap-2",children:v.map((e,t)=>(0,n.jsxs)("div",{className:"relative inline-block",children:[(0,n.jsx)(e_(),{src:e,alt:"Pending upload",width:80,height:80,className:"h-20 w-auto rounded border border-gray-300"}),(0,n.jsx)("button",{type:"button",className:"absolute right-0 top-0 rounded-bl bg-white/80 px-1 text-xs text-red-600 hover:bg-white",onClick:()=>y(e=>e.filter((e,r)=>r!==t)),children:"\xd7"})]},t))}),(0,n.jsxs)("div",{ref:g,onDragOver:e=>{e.preventDefault(),e.stopPropagation(),S(!0)},onDragLeave:e=>{e.preventDefault(),e.stopPropagation(),S(!1)},onDrop:F,className:"flex items-center ".concat(C?"rounded-lg ring-2 ring-blue-500":""),children:[m&&(0,n.jsxs)("div",{className:"mr-3 flex flex-shrink-0 flex-col gap-2",children:[(0,n.jsx)(ej,{onVoiceInput:M,disabled:s}),(0,n.jsxs)("button",{onClick:()=>{x.current&&x.current.click()},className:"rounded-none border-2 border-black bg-purple-400 p-2 font-bold text-black shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] transition-all duration-200 hover:-translate-x-0.5 hover:-translate-y-0.5 hover:bg-purple-500 hover:shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] dark:border-gray-600 dark:bg-purple-600 dark:text-white dark:shadow-[2px_2px_0px_0px_rgba(75,85,99,1)] dark:hover:bg-purple-700",type:"button",children:[(0,n.jsx)("svg",{width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{d:"M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"})}),(0,n.jsx)("span",{className:"sr-only",children:"Upload image"})]})]}),(0,n.jsx)("div",{className:"relative flex-1",children:(0,n.jsx)(Z,{ref:h,value:t,onChange:e=>r(e.target.value),onKeyDown:e=>{if("Enter"===e.key&&!e.shiftKey&&(e.preventDefault(),v.length>0||t.trim()||p&&N)){let e=v.map(e=>({url:e,type:"image"})),n=D(t,p,N);p&&(null==u||u(),E(null)),a({content:n,images:e.length>0?e:void 0}),y([]),r("")}},onPaste:async e=>{var t;let r=null===(t=e.clipboardData)||void 0===t?void 0:t.items;if(r){for(let t of r)if(-1!==t.type.indexOf("image")){let r=t.getAsFile();r&&(e.preventDefault(),await T(r));break}}},placeholder:I,className:"w-full resize-none rounded-lg rounded-br-none rounded-tl-none border-2 border-black bg-white p-2.5 text-black shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] outline-none placeholder:text-gray-500 focus:outline-none dark:border-gray-600 dark:bg-slate-800 dark:text-white dark:shadow-[3px_3px_0px_0px_rgba(75,85,99,1)] dark:placeholder:text-gray-200",rows:1})}),(0,n.jsx)("input",{type:"file",ref:x,onChange:z,accept:"image/*",multiple:!0,className:"hidden","aria-label":"Upload image"}),(0,n.jsxs)(L.z,{onClick:()=>{if(v.length>0||t.trim()||p&&N){let e=v.map(e=>({url:e,type:"image"})),n=D(t,p,N);p&&(null==u||u(),E(null)),a({content:n,images:e.length>0?e:void 0}),y([]),r("")}},className:"ml-3 rounded-none border-2 border-black bg-pink-400 p-2.5 font-bold text-black shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] transition-colors hover:bg-pink-500 dark:border-gray-600 dark:bg-pink-600 dark:text-white dark:shadow-[3px_3px_0px_0px_rgba(75,85,99,1)] dark:hover:bg-pink-700",disabled:A,children:[(0,n.jsx)(ek.Z,{size:18}),(0,n.jsx)("span",{className:"sr-only",children:"Send"})]})]}),o&&(0,n.jsx)("p",{className:"mt-2 text-sm text-red-500 dark:text-red-400",children:o})]})}let eE=i.memo(function(e){let{isVisible:t,isSmallScreen:r,widthPercentage:a,messages:l,input:o,setInput:d,error:c,onSend:p,onVoiceInput:u,streaming:m=!1,getAppUrl:h,appId:g,imageErrorQueue:x,setCreatedLoops:b,setActiveLoopId:f,setActiveTab:v,userProfile:y,confirmStepTransition:k,cancelStepTransition:w,progress:_,onRestoreVersion:j,onFixResponse:N,selectedElement:E,clearSelectedElement:C,onSelectImage:S,elementEditingMode:L=!1}=e,[D,I]=(0,i.useState)(!0),[A,O]=(0,i.useState)([]),{lang:M}=(0,s.Z)();(0,i.useEffect)(()=>{V(M).then(e=>{O([...e].sort(()=>.5-Math.random()).slice(0,3))})},[M]);let T=(0,i.useCallback)(()=>{w()},[w]),z=(0,i.useMemo)(()=>o.trim().length>0,[o]);return((0,i.useEffect)(()=>{z&&I(!1)},[z]),(0,i.useEffect)(()=>{l.length>1&&I(!1)},[l]),t)?(0,n.jsxs)("div",{className:"flex h-full w-full flex-col bg-[#FEFCF8] dark:bg-[#1a1a1a] md:w-auto",style:{width:"".concat(a,"%")},children:[(0,n.jsx)(ef,{messages:l,progress:_,streaming:m,userProfile:y,setCreatedLoops:b,setActiveLoopId:f,setActiveTab:v,confirmStepTransition:k,cancelStepTransition:T,onRestoreVersion:j,onFixResponse:N,onSelectImage:S,getAppUrl:h,imageErrorQueue:x,elementEditingMode:L}),(0,n.jsxs)("div",{className:"bg-white p-4 dark:bg-[#1a1a1a]",children:[D&&(0,n.jsx)("div",{className:"mb-4",children:(0,n.jsx)(Y,{numExamples:r?2:3,examples:A,onSelect:e=>{d(e),I(!1),p({content:e})}})}),(0,n.jsx)(eN,{input:o,setInput:d,onSend:p,appId:g,streaming:m,error:c,selectedElement:E,clearSelectedElement:C,onVoiceInput:u})]})]}):null},(e,t)=>["isVisible","isSmallScreen","widthPercentage","messages","input","error","streaming","appId","imageErrorQueue","progress","selectedElement","elementEditingMode","onVoiceInput"].every(r=>e[r]===t[r]));function eC(e){let{onMouseDown:t,isDragging:r}=e;return(0,n.jsx)("div",{className:"group relative hidden w-0 cursor-col-resize border-r-2 border-black bg-transparent dark:border-gray-600 md:block",onMouseDown:t})}var eS=r(63292),eL=r(11691),eD=r(22621),eI=r(18355),eA=r(85658),eO=r(4901);function eM(e){let{loops:t,handleLoopSelect:r}=e,a=e=>{switch(e){case"api-trigger":return(0,n.jsx)(h.Z,{className:"h-5 w-5 dark:text-gray-200"});case"time":return(0,n.jsx)(eS.Z,{className:"h-5 w-5 dark:text-gray-200"});case"email-trigger":return(0,n.jsx)(eL.Z,{className:"h-5 w-5 dark:text-gray-200"});case"hook":return(0,n.jsx)(eD.Z,{className:"h-5 w-5 dark:text-gray-200"});case"sms-trigger":case"whatsapp-trigger":return(0,n.jsx)(eI.Z,{className:"h-5 w-5 dark:text-gray-200"});default:return(0,n.jsx)(eA.Z,{className:"h-5 w-5 dark:text-gray-200"})}},l=e=>e?"complete":"pending",s=e=>{let t=null==e?void 0:e.blocks[0];return t&&eO.Ae.includes(t.type)?t.type:"api-trigger"};return(0,n.jsx)("div",{className:"bg-radial-dots h-full w-full p-4 dark:bg-gray-900 dark:bg-none",children:(0,n.jsx)("div",{className:"mx-auto max-w-4xl space-y-4",children:t.map(e=>{let t=s(e),o=l(e.published);return(0,n.jsx)("div",{onClick:()=>r(e.id),className:"group cursor-pointer pt-4",children:(0,n.jsx)("div",{className:"border-4 border-black bg-white shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] transition-transform hover:-translate-y-1 hover:translate-x-1 dark:border-gray-600 dark:bg-gray-800 dark:shadow-[4px_4px_0px_0px_rgba(75,85,99,1)]",children:(0,n.jsxs)("div",{className:"flex items-center justify-between p-4",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("div",{className:"p-2 ".concat("api-trigger"===t?"bg-blue-300 dark:bg-blue-600":"time"===t?"bg-yellow-300 dark:bg-yellow-600":"email-trigger"===t?"bg-green-300 dark:bg-green-600":"bg-purple-300 dark:bg-purple-600"," border-2 border-black dark:border-gray-600"),children:a(t)}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"font-mono text-lg font-bold text-black dark:text-gray-200",children:e.name}),e.lastUpdated&&(0,n.jsxs)("p",{className:"font-mono text-sm text-gray-600 dark:text-gray-400",children:["Last updated:"," ",new Date(e.lastUpdated).toLocaleString()]})]})]}),(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[(0,n.jsx)("div",{className:"font-mono border-2 border-black px-3 py-1 text-sm font-bold dark:border-gray-600 ".concat("complete"===o?"bg-green-300 text-black dark:bg-green-600 dark:text-white":"bg-yellow-300 text-black dark:bg-yellow-600 dark:text-white"),children:o.toUpperCase()}),(0,n.jsx)(B.Z,{className:"h-5 w-5 text-black transition-transform group-hover:translate-x-1 dark:text-gray-200"})]})]})})},e.id)})})})}var eT=r(26003),ez=r(72904);let eF=e=>{let{content:t,onSave:r,type:a,children:l}=e,[s,o]=(0,i.useState)(!1),[d,c]=(0,i.useState)(t),[p,u]=(0,i.useState)(!1);return s?(0,n.jsxs)("div",{className:"relative rounded border-2 border-black p-2 dark:border-gray-600",children:[(0,n.jsx)("textarea",{value:d,onChange:e=>c(e.target.value),className:"w-full resize-none rounded border border-gray-300 p-2 dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200",rows:3,disabled:p}),(0,n.jsxs)("div",{className:"mt-2 flex justify-end gap-2",children:[(0,n.jsx)("button",{onClick:async()=>{u(!0);try{await r(d),o(!1)}catch(e){console.error("Failed to save:",e)}finally{u(!1)}},className:"rounded bg-green-500 p-1 text-white hover:bg-green-600 disabled:opacity-50",disabled:p,children:(0,n.jsx)(k.Z,{className:"h-4 w-4"})}),(0,n.jsx)("button",{onClick:()=>{c(t),o(!1)},className:"rounded bg-red-500 p-1 text-white hover:bg-red-600",disabled:p,children:(0,n.jsx)(b.Z,{className:"h-4 w-4"})})]})]}):(0,n.jsxs)("div",{className:"group relative",children:[l,(0,n.jsx)("button",{onClick:()=>o(!0),className:"absolute right-2 top-2 hidden rounded bg-white p-1 text-gray-600 opacity-0 transition-opacity group-hover:opacity-100 dark:bg-gray-800 dark:text-gray-300",children:(0,n.jsx)(eT.Z,{className:"h-4 w-4"})})]})};var eP=e=>{let{content:t,onSectionUpdate:r}=e,[a,l]=(0,i.useState)(t);i.useEffect(()=>{l(t)},[t]);let s=async(e,t)=>{r&&(await r(e,t),l(r=>r.replace(e,t)))};return(0,n.jsx)(ez.UG,{components:{h1:e=>{let{children:t,...r}=e;return(0,n.jsx)("h1",{className:"mb-6 -rotate-1 transform border-4 border-black bg-yellow-300 p-4 text-3xl font-bold text-black shadow-[8px_8px_0px_0px_rgba(0,0,0,1)] dark:border-gray-600 dark:bg-amber-600 dark:text-white dark:shadow-[8px_8px_0px_0px_rgba(75,85,99,1)]",...r,children:t})},h2:e=>{let{children:t,...r}=e;return(0,n.jsx)("h2",{className:"mb-6 -rotate-1 transform border-4 border-black bg-yellow-300 p-4 text-2xl font-bold text-black shadow-[6px_6px_0px_0px_rgba(0,0,0,1)] dark:border-gray-600 dark:bg-amber-600 dark:text-white dark:shadow-[6px_6px_0px_0px_rgba(75,85,99,1)]",...r,children:t})},h3:e=>{let{children:t,...r}=e;return(0,n.jsx)("h3",{className:"mb-6 transform border-4 border-black bg-yellow-300 p-4 text-xl font-bold text-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] dark:border-gray-600 dark:bg-amber-600 dark:text-white dark:shadow-[4px_4px_0px_0px_rgba(75,85,99,1)]",...r,children:t})},h4:e=>{let{children:t,...r}=e;return(0,n.jsx)("h4",{className:"mb-4 mt-8 text-xl font-bold text-black dark:text-gray-200",...r,children:t})},p:e=>{let{children:t,...r}=e;return(0,n.jsx)("p",{className:"mb-4 text-lg text-black dark:text-gray-200",...r,children:t})},strong:e=>{let{children:t,...r}=e;return(0,n.jsx)("strong",{className:"font-bold text-pink-600 dark:text-pink-400",...r,children:t})},ul:e=>{let{children:t,...r}=e;return(0,n.jsx)("ul",{className:"mb-6 list-disc space-y-2 pl-8 text-black dark:text-gray-200",...r,children:t})},ol:e=>{let{children:t,...r}=e;return(0,n.jsx)("ol",{className:"mb-6 list-decimal space-y-2 pl-8 text-black dark:text-gray-200",...r,children:t})},li:e=>{let{children:t,...a}=e,l=i.Children.toArray(t).map(e=>String(e)).join(" ");return l&&r?(0,n.jsx)(eF,{content:l,onSave:async e=>s(l,e),type:"ListItem",children:(0,n.jsx)("li",{className:"mb-2 bg-blue-100 p-2 text-black dark:bg-blue-900 dark:text-gray-200",...a,children:t})}):(0,n.jsx)("li",{className:"mb-2 bg-blue-100 p-2 text-black dark:bg-blue-900 dark:text-gray-200",...a,children:t})},blockquote:e=>{let{children:t,...a}=e,l=i.Children.toArray(t).map(e=>String(e)).join(" ");return l&&r?(0,n.jsx)(eF,{content:l,onSave:async e=>s(l,e),type:"Blockquote",children:(0,n.jsx)("blockquote",{className:"mb-4 border-l-4 border-gray-300 pl-4 text-lg italic text-gray-600 dark:text-gray-400",...a,children:t})}):(0,n.jsx)("blockquote",{className:"mb-4 border-l-4 border-gray-300 pl-4 text-lg italic text-gray-600 dark:text-gray-400",...a,children:t})},code:e=>{let{children:t,...a}=e,l=i.Children.toArray(t).map(e=>String(e)).join(" ");return l&&r?(0,n.jsx)(eF,{content:l,onSave:async e=>s(l,e),type:"Code",children:(0,n.jsx)("code",{className:"font-mono rounded bg-gray-100 px-2 py-1 text-sm text-black dark:bg-gray-800 dark:text-gray-200",...a,children:t})}):(0,n.jsx)("code",{className:"font-mono rounded bg-gray-100 px-2 py-1 text-sm text-black dark:bg-gray-800 dark:text-gray-200",...a,children:t})}},children:a})},eR=r(59414),eH=r(51827);let eZ=ei()(()=>r.e(1947).then(r.t.bind(r,11947,23)),{loadableGenerated:{webpack:()=>[11947]},ssr:!1});function eU(e){var t;let{data:r,description:a,onUpdate:l,streaming:s}=e,[o,d]=(0,i.useState)(!1),[c,p]=(0,i.useState)(r),[u,m]=(0,i.useState)(a||""),h=(0,i.useRef)(null);(0,i.useEffect)(()=>{o||(p(r),m(a||""))},[r,a,o]),(0,i.useEffect)(()=>{if(s){var e;null===(e=h.current)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"end"})}},[r,a,s]);let g=a&&(null==r?void 0:r.appName)&&(null==r?void 0:r.interfaceDescription),x=e=>{let t={text:"",input:void 0,output:void 0};t.text=e.split(/Example (Input|Output):\s*```json[\s\S]*?```/g)[0].trim();let r=e.match(/```json([\s\S]*?)```/g);return r&&r.forEach((e,r)=>{let n=e.replace(/```json\s*|\s*```/g,"");try{let e=JSON.parse(n);0===r&&(t.input=e),1===r&&(t.output=e)}catch(e){console.error("Failed to parse JSON:",e)}}),t},f=(e,t)=>{let{text:r,input:n,output:a}=x(u),l="input"===t?e:n,s="output"===t?e:a;m(r+(l?"\n\nExample Input:\n```json\n".concat(JSON.stringify(l,null,2),"\n```\n"):"")+(s?"\n\nExample Output:\n```json\n".concat(JSON.stringify(s,null,2),"\n```\n"):""))},v=e=>{if(e&&e.length)return e.split(/```(?:json)?([\s\S]*?)```/).map((e,t)=>{if(t%2==0)return(0,n.jsx)("p",{className:"mb-4 text-black dark:text-gray-200",children:e},t);try{let r=JSON.parse(e.trim());return(0,n.jsx)("div",{className:"mb-4 overflow-x-auto rounded-md bg-[#1d1f21] p-4 shadow-inner dark:bg-[#1d1f21]",children:(0,n.jsx)(eZ,{src:r,name:!1,theme:"tomorrow",displayDataTypes:!1,displayObjectSize:!1,enableClipboard:!1,quotesOnKeys:!1,collapsed:!1})},t)}catch(r){return(0,n.jsx)("pre",{className:"font-mono mb-4 overflow-x-auto rounded-md bg-[#1d1f21] p-4 text-white shadow-inner",children:(0,n.jsx)("code",{children:e.trim()})},t)}})},y=(e,t,r)=>{p(n=>{let a=[...(null==n?void 0:n.loops)||[]];return a[e]={...a[e],[t]:r},{...n,loops:a}})},w=e=>{let t={text:"",input:void 0,output:void 0};t.text=e.split(/Example (Input|Output):\s*```json[\s\S]*?```/g)[0].trim();let r=e.match(/```json([\s\S]*?)```/g);return r&&r.forEach((e,r)=>{let n=e.replace(/```json\s*|\s*```/g,"");try{let e=JSON.parse(n);0===r&&(t.input=e),1===r&&(t.output=e)}catch(e){console.error("Failed to parse JSON:",e)}}),t};return(0,n.jsxs)("div",{className:"flex h-full flex-col overflow-hidden ",children:[(0,n.jsx)("div",{className:"flex justify-end space-x-2",children:o?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(S.Z,{onClick:()=>{var e;let t={...c,loops:null==c?void 0:null===(e=c.loops)||void 0===e?void 0:e.map(e=>({...e,description:e.description}))};null==l||l(t,u),d(!1)},className:"flex items-center gap-2 border-2 border-black bg-green-400 font-medium shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] hover:translate-x-[1px] hover:translate-y-[1px] hover:shadow-[1px_1px_0px_0px_rgba(0,0,0,1)] enabled:hover:bg-green-500 dark:border-gray-600 dark:bg-green-600 dark:shadow-[2px_2px_0px_0px_rgba(75,85,99,1)] dark:enabled:hover:bg-green-700",children:[(0,n.jsx)(k.Z,{className:"h-4 w-4"}),"Save"]}),(0,n.jsxs)(S.Z,{onClick:()=>{p(r),m(a||""),d(!1)},variant:"destructive",className:"flex items-center gap-2 border-2 border-black bg-red-400 font-medium shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] hover:translate-x-[1px] hover:translate-y-[1px] hover:shadow-[1px_1px_0px_0px_rgba(0,0,0,1)] enabled:hover:bg-red-500 dark:border-gray-600 dark:bg-red-600 dark:shadow-[2px_2px_0px_0px_rgba(75,85,99,1)] dark:enabled:hover:bg-red-700",children:[(0,n.jsx)(b.Z,{className:"h-4 w-4"}),"Cancel"]})]}):g&&(0,n.jsxs)(L.z,{onClick:()=>d(!0),className:"flex items-center gap-2 border-2 border-dotted border-black bg-transparent font-medium text-black hover:translate-x-[1px] hover:translate-y-[1px] hover:bg-blue-300 hover:shadow-[1px_1px_0px_0px_rgba(0,0,0,1)] dark:border-gray-600 dark:bg-blue-600 dark:shadow-[2px_2px_0px_0px_rgba(75,85,99,1)] dark:hover:bg-blue-700",children:[(0,n.jsx)(eT.Z,{className:"h-4 w-4"}),"Edit Plan"]})}),o?(0,n.jsxs)("div",{className:"space-y-8",children:[(0,n.jsx)(eR.Z,{title:"App Description",color:"bg-purple-400 dark:bg-purple-600",borderColor:"border-black dark:border-gray-600",titleClassName:"text-black dark:text-white",className:"dark:bg-gray-800",children:(0,n.jsxs)("div",{className:"space-y-4 p-6",children:[(0,n.jsx)("div",{children:(0,n.jsx)(eH.Z,{value:u.split(/```json/)[0],onChange:e=>{let t=x(u);m(e+(t.input?"\n```json\n".concat(JSON.stringify(t.input,null,2),"\n```\n"):"")+(t.output?"\n```json\n".concat(JSON.stringify(t.output,null,2),"\n```\n"):""))},containerClassName:"min-h-[100px] w-full bg-white dark:bg-gray-700",textClassName:"dark:text-gray-200",placeholder:"Enter app description..."})}),x(u).input&&(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("h3",{className:"font-medium text-black dark:text-gray-200",children:"Example Input"}),(0,n.jsx)("div",{className:"rounded-md bg-[#1d1f21] p-4 shadow-inner",children:(0,n.jsx)(eZ,{src:x(u).input,name:!1,theme:"tomorrow",displayDataTypes:!1,displayObjectSize:!1,enableClipboard:!1,onEdit:e=>{f(e.updated_src,"input")},onAdd:e=>{f(e.updated_src,"input")},onDelete:e=>{f(e.updated_src,"input")}})})]}),x(u).output&&(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("h3",{className:"font-medium text-black dark:text-gray-200",children:"Example Output"}),(0,n.jsx)("div",{className:"rounded-md bg-[#1d1f21] p-4 shadow-inner",children:(0,n.jsx)(eZ,{src:x(u).output,name:!1,theme:"tomorrow",displayDataTypes:!1,displayObjectSize:!1,enableClipboard:!1,onEdit:e=>{f(e.updated_src,"output")},onAdd:e=>{f(e.updated_src,"output")},onDelete:e=>{f(e.updated_src,"output")}})})]}),(0,n.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"You can use markdown formatting and edit JSON examples directly"})]})}),(0,n.jsx)(eR.Z,{title:"Name",color:"bg-blue-400 dark:bg-blue-600",borderColor:"border-black dark:border-gray-600",titleClassName:"text-black dark:text-white",className:"dark:bg-gray-800",children:(0,n.jsx)("div",{className:"p-6",children:(0,n.jsx)(F.I,{value:(null==c?void 0:c.appName)||"",onChange:e=>p(t=>({...t,appName:e.target.value})),className:"w-full bg-white dark:bg-gray-700 dark:text-gray-200",placeholder:"Enter app name..."})})}),(0,n.jsx)(eR.Z,{title:"Interface",color:"bg-[#FFD166] dark:bg-amber-600",borderColor:"border-black dark:border-gray-600",titleClassName:"text-black dark:text-white",className:"dark:bg-gray-800",children:(0,n.jsx)("div",{className:"p-6",children:(0,n.jsx)(eH.Z,{value:(null==c?void 0:c.interfaceDescription)||"",onChange:e=>p(t=>({...t,interfaceDescription:e})),containerClassName:"min-h-[200px] w-full bg-white dark:bg-gray-700",textClassName:"dark:text-gray-200",placeholder:"Enter interface description..."})})}),null==c?void 0:null===(t=c.loops)||void 0===t?void 0:t.map((e,t)=>(0,n.jsx)(eR.Z,{title:"Loop ".concat(t+1),color:eq(t),borderColor:"border-black dark:border-gray-600",titleClassName:"text-black dark:text-white",className:"dark:bg-gray-800",children:(0,n.jsxs)("div",{className:"space-y-4 p-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Loop Name"}),(0,n.jsx)(F.I,{value:e.name,onChange:e=>y(t,"name",e.target.value),className:"w-full bg-white dark:bg-gray-700 dark:text-gray-200",placeholder:"Enter loop name..."})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Loop Description"}),(0,n.jsx)(Z,{value:w(e.description).text,onChange:r=>{let{input:n,output:a}=w(e.description);y(t,"description",r.target.value.trim()+(n?"\n\nExample Input:\n```json\n".concat(JSON.stringify(n,null,2),"\n```\n"):"")+(a?"\n\nExample Output:\n```json\n".concat(JSON.stringify(a,null,2),"\n```\n"):""))},className:"min-h-[150px] w-full bg-white dark:bg-gray-700 dark:text-gray-200",placeholder:"Enter loop description..."})]}),w(e.description).input&&(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("h3",{className:"font-medium text-black dark:text-gray-200",children:"Example Input"}),(0,n.jsx)("div",{className:"rounded-md bg-[#1d1f21] p-4 shadow-inner",children:(0,n.jsx)(eZ,{src:w(e.description).input,name:!1,theme:"tomorrow",displayDataTypes:!1,displayObjectSize:!1,enableClipboard:!1,onEdit:r=>{let n=e.description.split(/```json/)[0].trim(),a=w(e.description);a.input=r.updated_src,y(t,"description",n+"\n\nExample Input:\n```json\n".concat(JSON.stringify(a.input,null,2),"\n```\n")+(a.output?"\n\nExample Output:\n```json\n".concat(JSON.stringify(a.output,null,2),"\n```\n"):""))},onAdd:r=>{let n=e.description.split(/```json/)[0].trim(),a=w(e.description);a.input=r.updated_src,y(t,"description",n+"\n\nExample Input:\n```json\n".concat(JSON.stringify(a.input,null,2),"\n```\n")+(a.output?"\n\nExample Output:\n```json\n".concat(JSON.stringify(a.output,null,2),"\n```\n"):""))},onDelete:r=>{let n=e.description.split(/```json/)[0].trim(),a=w(e.description);a.input=r.updated_src,y(t,"description",n+"\n\nExample Input:\n```json\n".concat(JSON.stringify(a.input,null,2),"\n```\n")+(a.output?"\n\nExample Output:\n```json\n".concat(JSON.stringify(a.output,null,2),"\n```\n"):""))}})})]}),w(e.description).output&&(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("h3",{className:"font-medium text-black dark:text-gray-200",children:"Example Output"}),(0,n.jsx)("div",{className:"rounded-md bg-[#1d1f21] p-4 shadow-inner",children:(0,n.jsx)(eZ,{src:w(e.description).output,name:!1,theme:"tomorrow",displayDataTypes:!1,displayObjectSize:!1,enableClipboard:!1,onEdit:r=>{let n=e.description.split(/```json/)[0].trim(),a=w(e.description);a.output=r.updated_src,y(t,"description",n+(a.input?"\n\nExample Input:\n```json\n".concat(JSON.stringify(a.input,null,2),"\n```\n"):"")+"\n\nExample Output:\n```json\n".concat(JSON.stringify(a.output,null,2),"\n```\n"))},onAdd:r=>{let n=e.description.split(/```json/)[0].trim(),a=w(e.description);a.output=r.updated_src,y(t,"description",n+(a.input?"\n\nExample Input:\n```json\n".concat(JSON.stringify(a.input,null,2),"\n```\n"):"")+"\n\nExample Output:\n```json\n".concat(JSON.stringify(a.output,null,2),"\n```\n"))},onDelete:r=>{let n=e.description.split(/```json/)[0].trim(),a=w(e.description);a.output=r.updated_src,y(t,"description",n+(a.input?"\n\nExample Input:\n```json\n".concat(JSON.stringify(a.input,null,2),"\n```\n"):"")+"\n\nExample Output:\n```json\n".concat(JSON.stringify(a.output,null,2),"\n```\n"))}})})]})]})},t))]}):(0,n.jsxs)("div",{className:"min-h-0 flex-1 space-y-4 overflow-y-auto px-1 pt-4",children:[a&&(0,n.jsx)("div",{className:"mb-8",children:(0,n.jsx)(eP,{content:a})}),(null==r?void 0:r.appName)&&(0,n.jsx)(eR.Z,{title:"Name",color:"bg-blue-400 dark:bg-blue-600",borderColor:"border-black dark:border-gray-600",titleClassName:"text-black dark:text-white",className:"dark:bg-gray-800",children:(0,n.jsx)("div",{className:"p-6 text-black dark:text-gray-200",children:v(r.appName)})}),(null==r?void 0:r.interfaceDescription)&&(0,n.jsx)(eR.Z,{title:"Interface",color:"bg-[#FFD166] dark:bg-amber-600",borderColor:"border-black dark:border-gray-600",titleClassName:"text-black dark:text-white",className:"dark:bg-gray-800",children:(0,n.jsx)("div",{className:"p-6 text-black dark:text-gray-200",children:v(r.interfaceDescription)})}),(null==r?void 0:r.loops)&&r.loops.length>0?r.loops.map((e,t)=>(0,n.jsx)(eR.Z,{title:e.name,color:eq(t),borderColor:"border-black dark:border-gray-600",titleClassName:"text-black dark:text-white",className:"dark:bg-gray-800",children:(0,n.jsx)("div",{className:"p-6 text-black dark:text-gray-200",children:v(e.description)})},t)):null,(0,n.jsx)("div",{ref:h})]})]})}function eq(e){let t=["bg-green-400 dark:bg-green-600","bg-fuchsia-400 dark:bg-fuchsia-600","bg-blue-400 dark:bg-blue-600","bg-yellow-400 dark:bg-amber-600","bg-purple-500 dark:bg-purple-600"];return t[e%t.length]}var eB=r(27820),eW=r(90767);function eG(e){let{isOpen:t,onClose:r,onSelectImage:a,searchQuery:l="web design",progress:s,totalErrors:o=1,currentErrorIndex:d=0,currentErrorSrc:c}=e,[p,u]=(0,i.useState)([]),[m,h]=(0,i.useState)(!1),[g,x]=(0,i.useState)(!1),[f,v]=(0,i.useState)(null),[y,k]=(0,i.useState)(l),[w,_]=(0,i.useState)(null),[j,N]=(0,i.useState)(1),[E,C]=(0,i.useState)(!0),[S,D]=(0,i.useState)(0),I=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r?x(!0):(h(!0),u([]),N(1)),v(null);let n="/api/unsplash?query=".concat(encodeURIComponent(e),"&per_page=").concat(16,"&page=").concat(t);try{let e=await fetch(n);if(!e.ok){let t=await e.text();throw console.error("❌ API Error Response:",t),Error("API Error ".concat(e.status,": ").concat(t))}let a=await e.json(),l=a.results||[];D(a.total||0),r?u(e=>[...e,...l]):u(l);let s=Math.ceil((a.total||0)/16);C(t<s&&16===l.length),r&&N(t)}catch(t){console.error("\uD83D\uDCA5 Fetch failed:",t),console.error("\uD83D\uDCCB Error details:",{message:t instanceof Error?t.message:String(t),stack:t instanceof Error?t.stack:void 0}),v(t instanceof Error?t.message:"Failed to load images"),r||(u(A(e)),C(!1))}finally{h(!1),x(!1)}},A=e=>{let t=["800x600","800x400","600x600","800x500"],r=["4F46E5","EF4444","10B981","F59E0B","8B5CF6","EC4899"];return Array.from({length:16},(n,a)=>({id:"placeholder-".concat(a),urls:{thumb:"https://via.placeholder.com/200x150/".concat(r[a%r.length],"/FFFFFF?text=").concat(encodeURIComponent(e)),small:"https://via.placeholder.com/400x300/".concat(r[a%r.length],"/FFFFFF?text=").concat(encodeURIComponent(e)),regular:"https://via.placeholder.com/".concat(t[a%t.length],"/").concat(r[a%r.length],"/FFFFFF?text=").concat(encodeURIComponent(e)),full:"https://via.placeholder.com/".concat(t[a%t.length],"/").concat(r[a%r.length],"/FFFFFF?text=").concat(encodeURIComponent(e))},alt_description:"".concat(e," placeholder image ").concat(a+1),user:{name:"Placeholder",username:"placeholder"},links:{download_location:""}}))};(0,i.useEffect)(()=>{t&&(k(l),_(null),I(l))},[t,l]);let O=e=>{_(e)};return t?(0,n.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,n.jsxs)("div",{className:"max-h-[90vh] w-full max-w-4xl overflow-hidden rounded-lg bg-white shadow-xl dark:bg-gray-800",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between border-b p-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("h2",{className:"text-xl font-semibold",children:["Replace Broken Image ",d+1," of ",o]}),c&&(0,n.jsxs)("p",{className:"mt-1 break-all text-sm text-gray-500",children:["Replacing: ",c.split("/").pop()]}),S>0&&!f&&(0,n.jsxs)("p",{className:"mt-1 text-xs text-gray-400",children:["Showing ",p.length," of ",S.toLocaleString()," ","results"]})]}),(0,n.jsx)(L.z,{variant:"ghost",size:"sm",onClick:r,className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700",children:(0,n.jsx)(b.Z,{className:"h-5 w-5"})})]}),(0,n.jsx)("div",{className:"border-b p-4",children:(0,n.jsxs)("form",{onSubmit:e=>{e.preventDefault(),y.trim()&&(_(null),I(y.trim()))},className:"flex gap-2",children:[(0,n.jsxs)("div",{className:"relative flex-1",children:[(0,n.jsx)(eB.Z,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 transform text-gray-400"}),(0,n.jsx)("input",{type:"text",value:y,onChange:e=>k(e.target.value),placeholder:"Search for images...",className:"w-full rounded-lg border py-2 pl-10 pr-4 text-black focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,n.jsx)(L.z,{type:"submit",disabled:m,children:"Search"})]})}),(0,n.jsxs)("div",{className:"max-h-[60vh] overflow-y-auto p-4",children:[f&&(0,n.jsxs)("div",{className:"py-8 text-center",children:[(0,n.jsx)("p",{className:"mb-4 text-red-500",children:f}),(0,n.jsx)("p",{className:"text-sm text-gray-500",children:"Using placeholder images instead"})]}),m?(0,n.jsxs)("div",{className:"py-8 text-center",children:[(0,n.jsx)("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-b-2 border-blue-500"}),(0,n.jsx)("p",{className:"mt-2 text-gray-500",children:"Loading images..."})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"grid grid-cols-2 gap-4 md:grid-cols-4",children:p.map(e=>(0,n.jsxs)("div",{className:"cursor-pointer overflow-hidden rounded-lg border-2 transition-all ".concat((null==w?void 0:w.id)===e.id?"border-blue-500 ring-2 ring-blue-200":"border-gray-200 hover:border-gray-300"),onClick:()=>O(e),children:[(0,n.jsx)("img",{src:e.urls.thumb,alt:e.alt_description||"Image",className:"h-32 w-full object-cover"}),(0,n.jsx)("div",{className:"bg-gray-50 p-2 dark:bg-gray-700",children:(0,n.jsx)("p",{className:"truncate text-xs text-gray-600 dark:text-gray-300",children:e.user.name})})]},e.id))}),E&&p.length>0&&!f&&(0,n.jsx)("div",{className:"mt-6 flex justify-center",children:(0,n.jsx)(L.z,{onClick:()=>{!g&&E&&I(y.trim(),j+1,!0)},disabled:g,variant:"outline",className:"flex items-center gap-2",children:g?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"h-4 w-4 animate-spin rounded-full border-b-2 border-blue-500"}),"Loading more..."]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(P.Z,{className:"h-4 w-4"}),"Show More Images"]})})}),0===p.length&&!m&&!f&&(0,n.jsx)("div",{className:"py-8 text-center text-gray-500",children:"No images found. Try a different search term."}),!E&&p.length>0&&!f&&(0,n.jsx)("div",{className:"mt-6 text-center text-sm text-gray-500",children:"All available images loaded"})]})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between border-t p-4",children:[(0,n.jsx)("div",{className:"text-sm text-gray-500",children:w?(0,n.jsxs)("span",{children:["Selected: ",w.alt_description||"Image"]}):(0,n.jsx)("span",{children:"Select an image to continue"})}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)(L.z,{variant:"outline",onClick:r,children:"Cancel"}),(0,n.jsxs)(L.z,{onClick:()=>{w&&(a(w.urls.regular,w.alt_description),_(null),d>=o-1&&r())},disabled:!w,className:"bg-blue-500 text-white hover:bg-blue-600",children:[(0,n.jsx)(eW.Z,{className:"mr-2 h-4 w-4"}),"Use This Image"]})]})]})]})}):null}var eJ=r(29025),eV=r(20373),eY=r.n(eV),eX=r(74870),e$=r(29386),eK=r(82681),eQ=r(80843);class e0 extends i.Component{static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){console.error("Iframe error:",e,t)}render(){return this.state.hasError?this.props.fallback||(0,n.jsx)("div",{children:"Error loading preview. Please try again."}):this.props.children}constructor(e){super(e),this.state={hasError:!1}}}let e1="allow-same-origin allow-scripts";var e2=function(e){let{preview:t}=e,r=(0,i.useRef)(null),a=(0,i.useRef)(null),[l,s]=(0,i.useState)(!0),o=(0,i.useRef)(t);return(0,i.useEffect)(()=>{o.current=t},[t]),(0,i.useEffect)(()=>{var e,t;let n=!0,l=null,i=null===(t=r.current)||void 0===t?void 0:null===(e=t.contentWindow)||void 0===e?void 0:e.document;i&&(i.open(),i.write(o.current),i.close());let d=setInterval(()=>{var e,t;let i=null===(t=(n?a:r).current)||void 0===t?void 0:null===(e=t.contentWindow)||void 0===e?void 0:e.document;i&&(i.open(),i.write(o.current),i.close()),l=setTimeout(()=>{s(n=!n)},1e3)},2e3);return()=>{clearInterval(d),l&&clearTimeout(l)}},[]),(0,n.jsxs)("div",{className:"relative h-full w-full",children:[(0,n.jsx)("iframe",{ref:r,title:"Streaming iframe #1",className:"\n          absolute inset-0 h-full w-full\n          ".concat(l?"z-0 opacity-100":"-z-10 opacity-0","\n        "),sandbox:e1}),(0,n.jsx)("iframe",{ref:a,title:"Streaming iframe #2",className:"\n          absolute inset-0 h-full w-full\n          ".concat(l?"-z-10 opacity-0":"z-0 opacity-100","\n        "),sandbox:e1})]})},e4=r(63063),e5=r(12274);function e3(){let e=(0,e5._)(["\n    <style>\n      .hovered-element {\n        outline: 2px solid #00AEEF !important;\n        background-color: rgba(0, 174, 239, 0.2) !important;\n      }\n      .edit-mode-cursor * {\n        cursor: pointer !important;\n      }\n      .edit-mode-cursor *[disabled],\n      .edit-mode-cursor *[disabled]:hover,\n      .edit-mode-cursor *[style*=\"pointer-events: none\"],\n      .edit-mode-cursor *[style*=\"pointer-events:none\"] {\n        cursor: pointer !important;\n        pointer-events: auto !important;\n      }\n    </style>\n    <script>\n    (function () {\n      // Only inject if not already present\n      if (window.elementSelectorInjected) return;\n      window.elementSelectorInjected = true;\n\n      // State management\n      let editModeEnabled = false;\n      let eventListenersAttached = false;\n      let currentHighlightedElement = null;\n      let lastMouseX = -1;\n      let lastMouseY = -1;\n      let disabledElementOverlays = [];\n\n      function send(type, payload) {\n        window.parent.postMessage({ source: 'app-iframe', type, payload }, '*');\n      }\n\n      // Helper function to find the best element to select from a list\n      function findBestElement(elements) {\n        // Define priority order for interactive elements\n        const interactiveTags = ['button', 'input', 'select', 'textarea', 'a'];\n        \n        // First, look for interactive elements (buttons, inputs, etc.)\n        for (const tag of interactiveTags) {\n          const element = elements.find(el => el.tagName.toLowerCase() === tag);\n          if (element) {\n            return element;\n          }\n        }\n        \n        // Then look for elements with common interactive classes or attributes\n        const interactiveElement = elements.find(el => {\n          const className = el.className || '';\n          const hasInteractiveClass = className.includes('btn') || \n                                     className.includes('button') || \n                                     className.includes('control') ||\n                                     className.includes('input');\n          const hasClickHandler = el.onclick || el.getAttribute('onclick');\n          const hasRole = el.getAttribute('role') === 'button' || \n                         el.getAttribute('role') === 'link';\n          \n          return hasInteractiveClass || hasClickHandler || hasRole;\n        });\n        \n        if (interactiveElement) {\n          return interactiveElement;\n        }\n        \n        // Finally, prefer elements that are not generic containers\n        const nonContainerElement = elements.find(el => {\n          const tag = el.tagName.toLowerCase();\n          return tag !== 'div' && tag !== 'span' && tag !== 'section' && tag !== 'article';\n        });\n        \n        if (nonContainerElement) {\n          return nonContainerElement;\n        }\n        \n        // Default to the first element\n        return elements[0];\n      }\n\n      // Helper function to get clean HTML without selector artifacts\n      function getCleanElementHTML(element) {\n        // Store original class state\n        const originalClassValue = element.getAttribute('class');\n        const hadHoveredClass = element.classList.contains('hovered-element');\n        \n        // Temporarily remove hovered-element class\n        if (hadHoveredClass) {\n          element.classList.remove('hovered-element');\n          \n          // If classList is empty after removal, remove class attribute entirely\n          if (element.classList.length === 0) {\n            element.removeAttribute('class');\n          }\n        }\n        \n        // Get the HTML\n        let html = element.outerHTML;\n        \n        // Clean up any remaining empty class attributes (defensive)\n        html = html.replace(/s+class=\"\"s*/g, ' ').replace(/s+class=''s*/g, ' ');\n        html = html.replace(/s+class=\"\"s*>/g, '>').replace(/s+class=''s*>/g, '>');\n        html = html.replace(/s*class=\"\"s*/g, '').replace(/s*class=''s*/g, '');\n        \n        // Restore original class state\n        if (hadHoveredClass) {\n          if (originalClassValue === null) {\n            element.removeAttribute('class');\n          } else {\n            element.setAttribute('class', originalClassValue);\n          }\n        }\n        \n        return html;\n      }\n\n      // Function to create transparent clickable overlays over disabled elements\n      function createDisabledElementOverlays() {\n        // Clean up existing overlays first\n        removeDisabledElementOverlays();\n        \n        const disabledElements = document.querySelectorAll('[disabled]');\n        \n        disabledElements.forEach(disabledEl => {\n          const rect = disabledEl.getBoundingClientRect();\n          \n          // Skip elements that are not visible or have no dimensions\n          if (rect.width === 0 || rect.height === 0) return;\n          \n          const overlay = document.createElement('div');\n          overlay.className = 'disabled-element-overlay';\n          overlay.style.cssText = \n            'position: absolute;' +\n            'left: ' + (rect.left + window.scrollX) + 'px;' +\n            'top: ' + (rect.top + window.scrollY) + 'px;' +\n            'width: ' + rect.width + 'px;' +\n            'height: ' + rect.height + 'px;' +\n            'background: transparent;' +\n            'z-index: 10000;' +\n            'pointer-events: auto;' +\n            'cursor: pointer;';\n          \n          // Store reference to the disabled element\n          overlay.disabledElement = disabledEl;\n          \n          // Add click handler to select the disabled element\n          overlay.addEventListener('click', (event) => {\n            event.preventDefault();\n            event.stopPropagation();\n            \n            const targetElement = overlay.disabledElement;\n            const tagName = targetElement.tagName.toLowerCase();\n            \n            // Clean up highlighting first  \n            if (currentHighlightedElement) {\n              currentHighlightedElement.classList.remove('hovered-element');\n              currentHighlightedElement = null;\n            }\n            \n            // Get clean HTML without any selector artifacts\n            const elementHtml = getCleanElementHTML(targetElement);\n\n            // Send element info to parent\n            send('element-selected', {\n              tagName,\n              html: elementHtml,\n              textContent: targetElement.textContent?.trim() || '',\n            });\n          });\n          \n          // Add hover handlers to highlight the disabled element\n          overlay.addEventListener('mouseenter', () => {\n            if (currentHighlightedElement) {\n              currentHighlightedElement.classList.remove('hovered-element');\n            }\n            disabledEl.classList.add('hovered-element');\n            currentHighlightedElement = disabledEl;\n          });\n          \n          overlay.addEventListener('mouseleave', () => {\n            if (currentHighlightedElement === disabledEl) {\n              disabledEl.classList.remove('hovered-element');\n              currentHighlightedElement = null;\n            }\n          });\n          \n          document.body.appendChild(overlay);\n          disabledElementOverlays.push(overlay);\n        });\n      }\n\n      // Function to remove all disabled element overlays\n      function removeDisabledElementOverlays() {\n        disabledElementOverlays.forEach(overlay => {\n          if (overlay.parentNode) {\n            overlay.parentNode.removeChild(overlay);\n          }\n        });\n        disabledElementOverlays = [];\n      }\n\n      // Function to update overlay positions (for when elements move or page scrolls)\n      function updateDisabledElementOverlays() {\n        disabledElementOverlays.forEach(overlay => {\n          const disabledEl = overlay.disabledElement;\n          if (disabledEl) {\n            const rect = disabledEl.getBoundingClientRect();\n            overlay.style.left = (rect.left + window.scrollX) + 'px';\n            overlay.style.top = (rect.top + window.scrollY) + 'px';\n            overlay.style.width = rect.width + 'px';\n            overlay.style.height = rect.height + 'px';\n          }\n        });\n      }\n\n      function handleMouseOver(event) {\n        // Only respond if edit mode is enabled\n        if (!editModeEnabled) return;\n        \n        // Throttle mousemove events - only process if mouse actually moved\n        if (event.clientX === lastMouseX && event.clientY === lastMouseY) {\n          return;\n        }\n        lastMouseX = event.clientX;\n        lastMouseY = event.clientY;\n        \n        // Always use elementsFromPoint to get the actual element at mouse coordinates\n        // This bypasses browser restrictions on disabled elements\n        const elementsAtPoint = document.elementsFromPoint(event.clientX, event.clientY);\n        \n        // Filter out body, html, and the document itself\n        const validElements = elementsAtPoint.filter(el => \n          el !== document.body && \n          el !== document.documentElement &&\n          el !== document\n        );\n        \n        if (validElements.length === 0) return;\n        \n        \n        // Prioritize interactive elements (buttons, inputs, selects, etc.)\n        // Look for the most relevant element, not just the first one\n        const targetElement = findBestElement(validElements);\n\n        // Only update if we're hovering over a different element\n        if (targetElement === currentHighlightedElement) return;\n\n        // Remove previous highlight\n        if (currentHighlightedElement) {\n          currentHighlightedElement.classList.remove('hovered-element');\n        }\n\n        // Highlight new element\n        targetElement.classList.add('hovered-element');\n        currentHighlightedElement = targetElement;\n      }\n\n      function handleMouseOut(event) {\n        // Only respond if edit mode is enabled\n        if (!editModeEnabled) return;\n        \n        if (event.target === currentHighlightedElement) {\n          event.target.classList.remove('hovered-element');\n          currentHighlightedElement = null;\n        }\n      }\n\n      function handleClick(event) {\n        // Only respond if edit mode is enabled\n        if (!editModeEnabled) return;\n        \n        // Prevent default behavior\n        event.preventDefault();\n        event.stopPropagation();\n\n        // Always use elementsFromPoint to get the actual element at click coordinates\n        // This bypasses browser restrictions on disabled elements\n        const elementsAtPoint = document.elementsFromPoint(event.clientX, event.clientY);\n        \n        // Filter out body, html, and the document itself\n        const validElements = elementsAtPoint.filter(el => \n          el !== document.body && \n          el !== document.documentElement &&\n          el !== document\n        );\n        \n        if (validElements.length === 0) return;\n        \n        // Prioritize interactive elements (buttons, inputs, selects, etc.)\n        const targetElement = findBestElement(validElements);\n\n        // Get element info\n        const tagName = targetElement.tagName.toLowerCase();\n        \n        // Clean up highlighting first\n        if (currentHighlightedElement) {\n          currentHighlightedElement.classList.remove('hovered-element');\n          currentHighlightedElement = null;\n        }\n        \n        // Get clean HTML without any selector artifacts\n        const elementHtml = getCleanElementHTML(targetElement);\n\n        // Send element info to parent\n        send('element-selected', {\n          tagName,\n          html: elementHtml,\n          textContent: targetElement.textContent?.trim() || '',\n        });\n      }\n\n      function cleanupHighlights() {\n        // Remove any remaining highlights\n        if (currentHighlightedElement) {\n          currentHighlightedElement.classList.remove('hovered-element');\n          currentHighlightedElement = null;\n        }\n        \n        // Remove highlights from all elements (fallback cleanup)\n        const highlightedElements = document.querySelectorAll('.hovered-element');\n        highlightedElements.forEach(el => {\n          el.classList.remove('hovered-element');\n        });\n      }\n\n      function enableEditMode() {\n        if (!eventListenersAttached) {\n          // Attach event listeners at document level to ensure they always fire\n          // even for disabled elements\n          document.addEventListener('mousemove', handleMouseOver, false);\n          document.addEventListener('mouseout', handleMouseOut, true);\n          document.addEventListener('click', handleClick, true);\n          eventListenersAttached = true;\n        }\n        editModeEnabled = true;\n        \n        // Add pointer cursor for all elements\n        document.body.classList.add('edit-mode-cursor');\n        \n        // Create overlays for disabled elements\n        createDisabledElementOverlays();\n        \n        // Add scroll and resize listeners to update overlay positions\n        window.addEventListener('scroll', updateDisabledElementOverlays, true);\n        window.addEventListener('resize', updateDisabledElementOverlays, true);\n      }\n\n      function disableEditMode() {\n        editModeEnabled = false;\n        // Clean up any highlights immediately\n        cleanupHighlights();\n        \n        // Remove pointer cursor\n        document.body.classList.remove('edit-mode-cursor');\n        \n        // Remove disabled element overlays\n        removeDisabledElementOverlays();\n        \n        // Remove scroll and resize listeners\n        window.removeEventListener('scroll', updateDisabledElementOverlays, true);\n        window.removeEventListener('resize', updateDisabledElementOverlays, true);\n        \n        // Note: We keep event listeners attached for performance\n        // They just return early when editModeEnabled = false\n      }\n\n      // Listen for toggle messages from parent\n      window.addEventListener('message', function(e) {\n        if (e.data && e.data.type === 'element-selector-toggle' && e.data.source === 'app-parent') {\n          if (e.data.payload && e.data.payload.enabled) {\n            enableEditMode();\n          } else {\n            disableEditMode();\n          }\n        }\n      });\n\n      // Always attach event listeners on DOM ready (they check editModeEnabled)\n      function attachEventListeners() {\n        if (!eventListenersAttached) {\n          // Use document-level listeners to ensure they work with disabled elements\n          document.addEventListener('mousemove', handleMouseOver, false);\n          document.addEventListener('mouseout', handleMouseOut, true);\n          document.addEventListener('click', handleClick, true);\n          eventListenersAttached = true;\n        }\n      }\n\n      // Wait for DOM to be ready\n      if (document.readyState === 'loading') {\n        document.addEventListener('DOMContentLoaded', attachEventListeners);\n      } else {\n        attachEventListeners();\n      }\n\n      // Clean up function (for backwards compatibility)\n      window.removeElementSelector = function() {\n        disableEditMode();\n        \n        if (eventListenersAttached) {\n          document.removeEventListener('mousemove', handleMouseOver, false);\n          document.removeEventListener('mouseout', handleMouseOut, true);\n          document.removeEventListener('click', handleClick, true);\n          eventListenersAttached = false;\n        }\n        \n        // Ensure cursor class is removed\n        document.body.classList.remove('edit-mode-cursor');\n        \n        // Remove any remaining overlays\n        removeDisabledElementOverlays();\n        \n        window.elementSelectorInjected = false;\n      };\n\n      // Expose toggle functions for debugging\n      window.enableElementSelector = enableEditMode;\n      window.disableElementSelector = disableEditMode;\n      window.refreshDisabledElementOverlays = createDisabledElementOverlays;\n    })();\n    </script>\n  "],["\n    <style>\n      .hovered-element {\n        outline: 2px solid #00AEEF !important;\n        background-color: rgba(0, 174, 239, 0.2) !important;\n      }\n      .edit-mode-cursor * {\n        cursor: pointer !important;\n      }\n      .edit-mode-cursor *[disabled],\n      .edit-mode-cursor *[disabled]:hover,\n      .edit-mode-cursor *[style*=\"pointer-events: none\"],\n      .edit-mode-cursor *[style*=\"pointer-events:none\"] {\n        cursor: pointer !important;\n        pointer-events: auto !important;\n      }\n    </style>\n    <script>\n    (function () {\n      // Only inject if not already present\n      if (window.elementSelectorInjected) return;\n      window.elementSelectorInjected = true;\n\n      // State management\n      let editModeEnabled = false;\n      let eventListenersAttached = false;\n      let currentHighlightedElement = null;\n      let lastMouseX = -1;\n      let lastMouseY = -1;\n      let disabledElementOverlays = [];\n\n      function send(type, payload) {\n        window.parent.postMessage({ source: 'app-iframe', type, payload }, '*');\n      }\n\n      // Helper function to find the best element to select from a list\n      function findBestElement(elements) {\n        // Define priority order for interactive elements\n        const interactiveTags = ['button', 'input', 'select', 'textarea', 'a'];\n        \n        // First, look for interactive elements (buttons, inputs, etc.)\n        for (const tag of interactiveTags) {\n          const element = elements.find(el => el.tagName.toLowerCase() === tag);\n          if (element) {\n            return element;\n          }\n        }\n        \n        // Then look for elements with common interactive classes or attributes\n        const interactiveElement = elements.find(el => {\n          const className = el.className || '';\n          const hasInteractiveClass = className.includes('btn') || \n                                     className.includes('button') || \n                                     className.includes('control') ||\n                                     className.includes('input');\n          const hasClickHandler = el.onclick || el.getAttribute('onclick');\n          const hasRole = el.getAttribute('role') === 'button' || \n                         el.getAttribute('role') === 'link';\n          \n          return hasInteractiveClass || hasClickHandler || hasRole;\n        });\n        \n        if (interactiveElement) {\n          return interactiveElement;\n        }\n        \n        // Finally, prefer elements that are not generic containers\n        const nonContainerElement = elements.find(el => {\n          const tag = el.tagName.toLowerCase();\n          return tag !== 'div' && tag !== 'span' && tag !== 'section' && tag !== 'article';\n        });\n        \n        if (nonContainerElement) {\n          return nonContainerElement;\n        }\n        \n        // Default to the first element\n        return elements[0];\n      }\n\n      // Helper function to get clean HTML without selector artifacts\n      function getCleanElementHTML(element) {\n        // Store original class state\n        const originalClassValue = element.getAttribute('class');\n        const hadHoveredClass = element.classList.contains('hovered-element');\n        \n        // Temporarily remove hovered-element class\n        if (hadHoveredClass) {\n          element.classList.remove('hovered-element');\n          \n          // If classList is empty after removal, remove class attribute entirely\n          if (element.classList.length === 0) {\n            element.removeAttribute('class');\n          }\n        }\n        \n        // Get the HTML\n        let html = element.outerHTML;\n        \n        // Clean up any remaining empty class attributes (defensive)\n        html = html.replace(/\\s+class=\"\"\\s*/g, ' ').replace(/\\s+class=''\\s*/g, ' ');\n        html = html.replace(/\\s+class=\"\"\\s*>/g, '>').replace(/\\s+class=''\\s*>/g, '>');\n        html = html.replace(/\\s*class=\"\"\\s*/g, '').replace(/\\s*class=''\\s*/g, '');\n        \n        // Restore original class state\n        if (hadHoveredClass) {\n          if (originalClassValue === null) {\n            element.removeAttribute('class');\n          } else {\n            element.setAttribute('class', originalClassValue);\n          }\n        }\n        \n        return html;\n      }\n\n      // Function to create transparent clickable overlays over disabled elements\n      function createDisabledElementOverlays() {\n        // Clean up existing overlays first\n        removeDisabledElementOverlays();\n        \n        const disabledElements = document.querySelectorAll('[disabled]');\n        \n        disabledElements.forEach(disabledEl => {\n          const rect = disabledEl.getBoundingClientRect();\n          \n          // Skip elements that are not visible or have no dimensions\n          if (rect.width === 0 || rect.height === 0) return;\n          \n          const overlay = document.createElement('div');\n          overlay.className = 'disabled-element-overlay';\n          overlay.style.cssText = \n            'position: absolute;' +\n            'left: ' + (rect.left + window.scrollX) + 'px;' +\n            'top: ' + (rect.top + window.scrollY) + 'px;' +\n            'width: ' + rect.width + 'px;' +\n            'height: ' + rect.height + 'px;' +\n            'background: transparent;' +\n            'z-index: 10000;' +\n            'pointer-events: auto;' +\n            'cursor: pointer;';\n          \n          // Store reference to the disabled element\n          overlay.disabledElement = disabledEl;\n          \n          // Add click handler to select the disabled element\n          overlay.addEventListener('click', (event) => {\n            event.preventDefault();\n            event.stopPropagation();\n            \n            const targetElement = overlay.disabledElement;\n            const tagName = targetElement.tagName.toLowerCase();\n            \n            // Clean up highlighting first  \n            if (currentHighlightedElement) {\n              currentHighlightedElement.classList.remove('hovered-element');\n              currentHighlightedElement = null;\n            }\n            \n            // Get clean HTML without any selector artifacts\n            const elementHtml = getCleanElementHTML(targetElement);\n\n            // Send element info to parent\n            send('element-selected', {\n              tagName,\n              html: elementHtml,\n              textContent: targetElement.textContent?.trim() || '',\n            });\n          });\n          \n          // Add hover handlers to highlight the disabled element\n          overlay.addEventListener('mouseenter', () => {\n            if (currentHighlightedElement) {\n              currentHighlightedElement.classList.remove('hovered-element');\n            }\n            disabledEl.classList.add('hovered-element');\n            currentHighlightedElement = disabledEl;\n          });\n          \n          overlay.addEventListener('mouseleave', () => {\n            if (currentHighlightedElement === disabledEl) {\n              disabledEl.classList.remove('hovered-element');\n              currentHighlightedElement = null;\n            }\n          });\n          \n          document.body.appendChild(overlay);\n          disabledElementOverlays.push(overlay);\n        });\n      }\n\n      // Function to remove all disabled element overlays\n      function removeDisabledElementOverlays() {\n        disabledElementOverlays.forEach(overlay => {\n          if (overlay.parentNode) {\n            overlay.parentNode.removeChild(overlay);\n          }\n        });\n        disabledElementOverlays = [];\n      }\n\n      // Function to update overlay positions (for when elements move or page scrolls)\n      function updateDisabledElementOverlays() {\n        disabledElementOverlays.forEach(overlay => {\n          const disabledEl = overlay.disabledElement;\n          if (disabledEl) {\n            const rect = disabledEl.getBoundingClientRect();\n            overlay.style.left = (rect.left + window.scrollX) + 'px';\n            overlay.style.top = (rect.top + window.scrollY) + 'px';\n            overlay.style.width = rect.width + 'px';\n            overlay.style.height = rect.height + 'px';\n          }\n        });\n      }\n\n      function handleMouseOver(event) {\n        // Only respond if edit mode is enabled\n        if (!editModeEnabled) return;\n        \n        // Throttle mousemove events - only process if mouse actually moved\n        if (event.clientX === lastMouseX && event.clientY === lastMouseY) {\n          return;\n        }\n        lastMouseX = event.clientX;\n        lastMouseY = event.clientY;\n        \n        // Always use elementsFromPoint to get the actual element at mouse coordinates\n        // This bypasses browser restrictions on disabled elements\n        const elementsAtPoint = document.elementsFromPoint(event.clientX, event.clientY);\n        \n        // Filter out body, html, and the document itself\n        const validElements = elementsAtPoint.filter(el => \n          el !== document.body && \n          el !== document.documentElement &&\n          el !== document\n        );\n        \n        if (validElements.length === 0) return;\n        \n        \n        // Prioritize interactive elements (buttons, inputs, selects, etc.)\n        // Look for the most relevant element, not just the first one\n        const targetElement = findBestElement(validElements);\n\n        // Only update if we're hovering over a different element\n        if (targetElement === currentHighlightedElement) return;\n\n        // Remove previous highlight\n        if (currentHighlightedElement) {\n          currentHighlightedElement.classList.remove('hovered-element');\n        }\n\n        // Highlight new element\n        targetElement.classList.add('hovered-element');\n        currentHighlightedElement = targetElement;\n      }\n\n      function handleMouseOut(event) {\n        // Only respond if edit mode is enabled\n        if (!editModeEnabled) return;\n        \n        if (event.target === currentHighlightedElement) {\n          event.target.classList.remove('hovered-element');\n          currentHighlightedElement = null;\n        }\n      }\n\n      function handleClick(event) {\n        // Only respond if edit mode is enabled\n        if (!editModeEnabled) return;\n        \n        // Prevent default behavior\n        event.preventDefault();\n        event.stopPropagation();\n\n        // Always use elementsFromPoint to get the actual element at click coordinates\n        // This bypasses browser restrictions on disabled elements\n        const elementsAtPoint = document.elementsFromPoint(event.clientX, event.clientY);\n        \n        // Filter out body, html, and the document itself\n        const validElements = elementsAtPoint.filter(el => \n          el !== document.body && \n          el !== document.documentElement &&\n          el !== document\n        );\n        \n        if (validElements.length === 0) return;\n        \n        // Prioritize interactive elements (buttons, inputs, selects, etc.)\n        const targetElement = findBestElement(validElements);\n\n        // Get element info\n        const tagName = targetElement.tagName.toLowerCase();\n        \n        // Clean up highlighting first\n        if (currentHighlightedElement) {\n          currentHighlightedElement.classList.remove('hovered-element');\n          currentHighlightedElement = null;\n        }\n        \n        // Get clean HTML without any selector artifacts\n        const elementHtml = getCleanElementHTML(targetElement);\n\n        // Send element info to parent\n        send('element-selected', {\n          tagName,\n          html: elementHtml,\n          textContent: targetElement.textContent?.trim() || '',\n        });\n      }\n\n      function cleanupHighlights() {\n        // Remove any remaining highlights\n        if (currentHighlightedElement) {\n          currentHighlightedElement.classList.remove('hovered-element');\n          currentHighlightedElement = null;\n        }\n        \n        // Remove highlights from all elements (fallback cleanup)\n        const highlightedElements = document.querySelectorAll('.hovered-element');\n        highlightedElements.forEach(el => {\n          el.classList.remove('hovered-element');\n        });\n      }\n\n      function enableEditMode() {\n        if (!eventListenersAttached) {\n          // Attach event listeners at document level to ensure they always fire\n          // even for disabled elements\n          document.addEventListener('mousemove', handleMouseOver, false);\n          document.addEventListener('mouseout', handleMouseOut, true);\n          document.addEventListener('click', handleClick, true);\n          eventListenersAttached = true;\n        }\n        editModeEnabled = true;\n        \n        // Add pointer cursor for all elements\n        document.body.classList.add('edit-mode-cursor');\n        \n        // Create overlays for disabled elements\n        createDisabledElementOverlays();\n        \n        // Add scroll and resize listeners to update overlay positions\n        window.addEventListener('scroll', updateDisabledElementOverlays, true);\n        window.addEventListener('resize', updateDisabledElementOverlays, true);\n      }\n\n      function disableEditMode() {\n        editModeEnabled = false;\n        // Clean up any highlights immediately\n        cleanupHighlights();\n        \n        // Remove pointer cursor\n        document.body.classList.remove('edit-mode-cursor');\n        \n        // Remove disabled element overlays\n        removeDisabledElementOverlays();\n        \n        // Remove scroll and resize listeners\n        window.removeEventListener('scroll', updateDisabledElementOverlays, true);\n        window.removeEventListener('resize', updateDisabledElementOverlays, true);\n        \n        // Note: We keep event listeners attached for performance\n        // They just return early when editModeEnabled = false\n      }\n\n      // Listen for toggle messages from parent\n      window.addEventListener('message', function(e) {\n        if (e.data && e.data.type === 'element-selector-toggle' && e.data.source === 'app-parent') {\n          if (e.data.payload && e.data.payload.enabled) {\n            enableEditMode();\n          } else {\n            disableEditMode();\n          }\n        }\n      });\n\n      // Always attach event listeners on DOM ready (they check editModeEnabled)\n      function attachEventListeners() {\n        if (!eventListenersAttached) {\n          // Use document-level listeners to ensure they work with disabled elements\n          document.addEventListener('mousemove', handleMouseOver, false);\n          document.addEventListener('mouseout', handleMouseOut, true);\n          document.addEventListener('click', handleClick, true);\n          eventListenersAttached = true;\n        }\n      }\n\n      // Wait for DOM to be ready\n      if (document.readyState === 'loading') {\n        document.addEventListener('DOMContentLoaded', attachEventListeners);\n      } else {\n        attachEventListeners();\n      }\n\n      // Clean up function (for backwards compatibility)\n      window.removeElementSelector = function() {\n        disableEditMode();\n        \n        if (eventListenersAttached) {\n          document.removeEventListener('mousemove', handleMouseOver, false);\n          document.removeEventListener('mouseout', handleMouseOut, true);\n          document.removeEventListener('click', handleClick, true);\n          eventListenersAttached = false;\n        }\n        \n        // Ensure cursor class is removed\n        document.body.classList.remove('edit-mode-cursor');\n        \n        // Remove any remaining overlays\n        removeDisabledElementOverlays();\n        \n        window.elementSelectorInjected = false;\n      };\n\n      // Expose toggle functions for debugging\n      window.enableElementSelector = enableEditMode;\n      window.disableElementSelector = disableEditMode;\n      window.refreshDisabledElementOverlays = createDisabledElementOverlays;\n    })();\n    </script>\n  "]);return e3=function(){return e},e}function e6(){let e=(0,e5._)(["\n    <script>\n    (function () {\n      // Initial data injected from parent\n      const initialData = ",";\n      \n      // Store reference to the Map for initialization\n      let storageMap = null;\n      \n      /** Returns a Map-backed storage facade matching the Web-Storage API with message passing. */\n      function createStorage () {\n        const mem = new Map();\n        \n        // Pre-populate with initial data\n        Object.entries(initialData).forEach(([key, value]) => {\n          mem.set(key, value);\n        });\n        \n        // Store reference for initialization\n        storageMap = mem;\n        \n        // Function to send messages to parent\n        function sendToParent(operation, key, value) {\n          window.parent.postMessage({\n            source: 'app-iframe',\n            type: 'localStorage-change',\n            payload: { operation, key, value }\n          }, '*');\n        }\n        \n        return {\n          getItem: k => mem.has(k) ? mem.get(k) : null,\n          \n          setItem: (k, v) => {\n            const key = String(k);\n            const value = String(v);\n            mem.set(key, value);\n            sendToParent('setItem', key, value);\n          },\n          \n          removeItem: k => {\n            const key = String(k);\n            mem.delete(key);\n            sendToParent('removeItem', key);\n          },\n          \n          clear: () => {\n            mem.clear();\n            sendToParent('clear');\n          },\n          \n          key: i => Array.from(mem.keys())[i] ?? null,\n          \n          get length() { return mem.size; }\n        };\n      }\n\n      /*\n      try {\n        // Accessing the real property inside a sandbox *will* throw,\n        // so probe in a try/catch before re-defining it.\n        void window.localStorage;\n      } catch (_) {\n      */ // We're allowing same origin (for now), add this back later\n        Object.defineProperty(window, 'localStorage', {\n          value: createStorage(),\n          writable: false,\n          enumerable: false,\n          configurable: false\n        });\n      //  }\n      \n      // Listen for additional initialization data from parent (for runtime updates)\n      window.addEventListener('message', function(e) {\n        if (e.data && e.data.type === 'localStorage-init') {\n          const additionalData = e.data.payload || {};\n          \n          // Populate the Map directly to avoid triggering parent messages\n          if (storageMap) {\n            Object.entries(additionalData).forEach(([key, value]) => {\n              if (!storageMap.has(key)) { // Only add if not already present\n                storageMap.set(key, value);\n              }\n            });\n          }\n        }\n      });\n    })();\n    </script>\n  "]);return e6=function(){return e},e}function e8(){let e=(0,e5._)(["\n    <script>\n    (function () {\n      function send(type, payload) {\n        window.parent.postMessage({ source: 'app-iframe', type, payload }, '*');\n      }\n\n      /* error capture - handles both runtime and resource errors */\n      window.addEventListener('error', function(e) {\n        var t = e.target;\n        \n        // Resource loading errors (SCRIPT, LINK, IMG, etc.)\n        if (t && t.tagName) {\n          if (t.tagName === 'SCRIPT' || t.tagName === 'LINK') { \n            send('resource-error', {\n              tag: t.tagName.toLowerCase(),\n              src: t.src || t.href,\n              message: 'failed to load (network/MIME/CORS)'\n            });\n          } else if (t.tagName === 'IMG') { \n            // Image components without a src might be used dynamically for modals, etc.\n            if(!t.getAttribute('src')) return;\n            send('resource-error', {\n              tag: t.tagName.toLowerCase(),\n              src: t.src || t.currentSrc || null,\n              alt: t.alt || null,\n              message: 'failed to load (image)'\n            });\n          }\n        } else {\n          // Runtime JavaScript errors\n          console.error(\"in iframe\");\n          console.error(e);\n          console.error(e.error);\n          send('runtime-error', {\n            message: e.message,\n            filename: e.filename,\n            lineno: e.lineno,\n            colno: e.colno,\n            stack: e.error && e.error.stack\n          });\n        }\n      }, true);\n      \n      /* unhandled rejection capture */\n      window.addEventListener('unhandledrejection', function(e) {\n        var r = e.reason || {};\n        send('unhandledrejection', {\n          message: r.message || String(r),\n          stack: r.stack\n        });\n      }, true);\n\n      /* message listener for image replacement */ \n      window.addEventListener('message', function(e) {\n        if (e.data.type === 'replace-image') {\n          var payload = e.data.payload;\n          var oldSrc = payload.oldSrc;\n          var newSrc = payload.newSrc;\n          var altText = payload.altText;\n          \n          // Find all images with the broken src\n          var brokenImages = document.querySelectorAll('img[src=\"' + oldSrc + '\"]');\n          for (var i = 0; i < brokenImages.length; i++) {\n            var img = brokenImages[i];\n            img.src = newSrc;\n            if (altText) img.alt = altText;\n          }\n          \n          // Also handle images that might have failed to load previously\n          var allImages = document.querySelectorAll('img');\n          for (var j = 0; j < allImages.length; j++) {\n            var img2 = allImages[j];\n            if (img2.src === oldSrc || img2.getAttribute('data-original-src') === oldSrc) {\n              img2.src = newSrc;\n              if (altText) img2.alt = altText;\n            }\n          }\n        }\n      });\n    })();\n    </script>\n  "]);return e8=function(){return e},e}class e9{static getInstance(){return e9.instance||(e9.instance=new e9),e9.instance}getState(){return Object.fromEntries(this.state)}setState(e){this.state=new Map(Object.entries(e))}getItem(e){var t;return console.log(this.state.get(e)),null!==(t=this.state.get(e))&&void 0!==t?t:null}setItem(e,t){this.state.set(e,t)}removeItem(e){this.state.delete(e)}clear(){this.state.clear()}key(e){var t;return null!==(t=Array.from(this.state.keys())[e])&&void 0!==t?t:null}get length(){return this.state.size}handleMessage(e){switch(e.payload.operation){case"setItem":e.payload.key&&void 0!==e.payload.value&&this.setItem(e.payload.key,e.payload.value);break;case"removeItem":e.payload.key&&this.removeItem(e.payload.key);break;case"clear":this.clear()}}getInitData(){return{type:"localStorage-init",payload:this.getState()}}constructor(){this.state=new Map}}e9.instance=null;let e7=["http://localhost:3000","http://127.0.0.1:3000","https://magicloops.dev"];var te=i.memo(function(e){let{preview:t,streaming:r,onElementSelected:a,onImageError:l,onOtherError:s,elementEditingMode:o=!1,onIframeReady:d}=e,c=(0,i.useRef)(null),p=(0,i.useMemo)(()=>{let e="ml=".concat(Date.now().toString(36)),r=function(e){let t=String.raw(e8());return/<head[^>]*>/i.test(e)?e.replace(/<head([^>]*)>/i,"<head$1>".concat(t)):e.replace(/<script/i,"".concat(t,"<script"))}(t.replace(/<script(?![^>]*\bcrossorigin\b)([^>]*src=["']([^"']+)["'][^>]*)>/gi,(e,t,r)=>r.includes("cdn.tailwindcss.com")?e:'<script crossorigin="anonymous"'.concat(t,">")).replace(/<script([^>]*\bsrc=['"])([^'"]+)(['"][^>]*)>/gi,(t,r,n,a)=>{if(/^(data:|blob:|about:)/i.test(n)||n.includes("cdn.tailwindcss.com")||new RegExp("[?&]".concat(e.split("=")[0],"=")).test(n))return t;let l=n.includes("?")?"&":"?",s="".concat(n).concat(l).concat(e);return"<script".concat(r).concat(s).concat(a,">")}));return function(e,t){let r=t?JSON.stringify(t):"{}",n=String.raw(e6(),r);return/<head[^>]*>/i.test(e)?e.replace(/<head([^>]*)>/i,"<head$1>".concat(n)):e.replace(/<script/i,"".concat(n,"<script"))}(r=function(e){let t=String.raw(e3());return/<head[^>]*>/i.test(e)?e.replace(/<head([^>]*)>/i,"<head$1>".concat(t)):e.replace(/<script/i,"".concat(t,"<script"))}(r),e9.getInstance().getState())},[t]);return((0,i.useEffect)(()=>{let e=e9.getInstance(),t=t=>{try{var r;if(!e7.includes(t.origin)||"object"!=typeof t.data||null===t.data||"app-iframe"!==t.data.source)return;if((0,e4.q)("app-iframe message received"),(0,e4.q)(t.data),"localStorage-change"===t.data.type){e.handleMessage(t.data);return}if("localStorage-request-init"===t.data.type)return;"element-selected"===t.data.type?null==a||a(t):"resource-error"===t.data.type&&(null===(r=t.data.payload)||void 0===r?void 0:r.tag)==="img"?null==l||l(t):null==s||s(t)}catch(e){console.error("Error processing message:",e)}};return window.addEventListener("message",t),()=>window.removeEventListener("message",t)},[a,l,s]),(0,i.useEffect)(()=>{var e;(null===(e=c.current)||void 0===e?void 0:e.contentWindow)&&c.current.contentWindow.postMessage({source:"app-parent",type:"element-selector-toggle",payload:{enabled:o}},"*")},[o]),(0,i.useEffect)(()=>{c.current&&d&&d(c.current)},[d]),r)?(0,n.jsx)(e2,{preview:t}):(0,n.jsx)("iframe",{ref:c,sandbox:"allow-scripts allow-same-origin allow-forms allow-pointer-lock allow-modals allow-downloads allow-popups allow-presentation",srcDoc:p,className:"h-full w-full",title:"App iframe"})},(e,t)=>e.preview===t.preview&&e.streaming===t.streaming&&e.elementEditingMode===t.elementEditingMode),tt=r(36811),tr=r(48192),tn=r.n(tr),ta=e=>{let{width:t=150,height:r=150,className:a}=e;return(0,n.jsx)("div",{className:"absolute z-20 flex h-full w-full items-start justify-center bg-transparent p-6 pt-[25vh]",children:(0,n.jsxs)("svg",{width:t,height:r,viewBox:"0 0 150 150",xmlns:"http://www.w3.org/2000/svg",className:"".concat(tn().svg," ").concat(a||""),children:[(0,n.jsx)("defs",{children:(0,n.jsxs)("filter",{id:"dropShadow",x:"-20%",y:"-20%",width:"200%",height:"200%",children:[(0,n.jsx)("feOffset",{in:"SourceAlpha",dx:"2.5",dy:"2.5",result:"offset"}),(0,n.jsx)("feBlend",{in:"SourceGraphic",in2:"offset",mode:"normal"})]})}),(0,n.jsx)("rect",{className:"".concat(tn().rect," ").concat(tn().rect1),x:"5",y:"5",width:"40",height:"40",fill:"#FF6B6B",stroke:"#000",strokeWidth:"2.5",filter:"url(#dropShadow)"}),(0,n.jsx)("rect",{className:"".concat(tn().rect," ").concat(tn().rect2),x:"55",y:"5",width:"40",height:"40",fill:"#4ECDC4",stroke:"#000",strokeWidth:"2.5",filter:"url(#dropShadow)"}),(0,n.jsx)("rect",{className:"".concat(tn().rect," ").concat(tn().rect3),x:"105",y:"5",width:"40",height:"40",fill:"#FFD93D",stroke:"#000",strokeWidth:"2.5",filter:"url(#dropShadow)"}),(0,n.jsx)("rect",{className:"".concat(tn().rect," ").concat(tn().rect4),x:"5",y:"55",width:"40",height:"40",fill:"#FF8811",stroke:"#000",strokeWidth:"2.5",filter:"url(#dropShadow)"}),(0,n.jsx)("rect",{className:"".concat(tn().rect," ").concat(tn().rect5),x:"55",y:"55",width:"40",height:"40",fill:"#00BBF9",stroke:"#000",strokeWidth:"2.5",filter:"url(#dropShadow)"}),(0,n.jsx)("rect",{className:"".concat(tn().rect," ").concat(tn().rect6),x:"105",y:"55",width:"40",height:"40",fill:"#FF9A8B",stroke:"#000",strokeWidth:"2.5",filter:"url(#dropShadow)"}),(0,n.jsx)("rect",{className:"".concat(tn().rect," ").concat(tn().rect7),x:"5",y:"105",width:"40",height:"40",fill:"#45B69C",stroke:"#000",strokeWidth:"2.5",filter:"url(#dropShadow)"}),(0,n.jsx)("rect",{className:"".concat(tn().rect," ").concat(tn().rect8),x:"55",y:"105",width:"40",height:"40",fill:"#E84855",stroke:"#000",strokeWidth:"2.5",filter:"url(#dropShadow)"}),(0,n.jsx)("rect",{className:"".concat(tn().rect," ").concat(tn().rect9),x:"105",y:"105",width:"40",height:"40",fill:"#9B5DE5",stroke:"#000",strokeWidth:"2.5",filter:"url(#dropShadow)"})]})})},tl=r(22897);let ts=i.forwardRef((e,t)=>{let{children:r,...a}=e;return(0,n.jsx)(tl.fC,{...a,children:r})});ts.displayName="NeoDropdown";let to=i.forwardRef((e,t)=>{let{className:r,children:a,...l}=e;return(0,n.jsxs)(tl.xz,{ref:t,className:(0,M.cn)("flex items-center justify-between gap-2 rounded-none border-4 border-black bg-yellow-300 px-3 py-1 text-lg font-bold shadow-[6px_6px_0px_0px_rgba(0,0,0,1)] outline-none transition-all hover:translate-x-[3px] hover:translate-y-[3px] hover:shadow-[3px_3px_0px_0px_rgba(0,0,0,1)] active:translate-x-[6px] active:translate-y-[6px] active:shadow-none dark:text-black",r),...l,children:[a,(0,n.jsx)(ev.Z,{className:"h-5 w-5"})]})});to.displayName="NeoDropdownTrigger";let ti=i.forwardRef((e,t)=>{let{className:r,sideOffset:a=4,...l}=e;return(0,n.jsx)(tl.Uv,{children:(0,n.jsx)(tl.VY,{ref:t,sideOffset:a,className:(0,M.cn)("z-50 min-w-[12rem] overflow-hidden border-4 border-black bg-white p-3 shadow-[8px_8px_0px_0px_rgba(0,0,0,1)] data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r),...l})})});ti.displayName="NeoDropdownContent";let td=i.forwardRef((e,t)=>{let{className:r,inset:a,...l}=e;return(0,n.jsx)(tl.ck,{ref:t,className:(0,M.cn)("border-3 relative my-2 flex cursor-pointer select-none items-center rounded-none border-black bg-pink-300 px-6 py-3 text-base font-extrabold text-black outline-none transition-colors hover:-translate-y-1 hover:bg-pink-400 focus:bg-pink-400 data-[disabled]:pointer-events-none data-[disabled]:opacity-50","transform hover:shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] active:translate-x-1 active:translate-y-1 active:shadow-none",a&&"pl-8",r),...l})});td.displayName="NeoDropdownItem",i.forwardRef((e,t)=>{let{className:r,children:a,checked:l,...s}=e;return(0,n.jsxs)(tl.oC,{ref:t,className:(0,M.cn)("border-3 relative my-2 flex cursor-pointer select-none items-center rounded-none border-black bg-cyan-300 py-3 pl-6 pr-10 text-base font-extrabold text-black outline-none transition-colors hover:-translate-y-1 hover:bg-cyan-400 focus:bg-cyan-400 data-[disabled]:pointer-events-none data-[disabled]:opacity-50","transform hover:shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] active:translate-x-1 active:translate-y-1 active:shadow-none",r),checked:l,...s,children:[a,(0,n.jsx)(tl.wU,{className:"absolute right-2 inline-flex h-6 w-6 items-center justify-center",children:(0,n.jsx)(k.Z,{className:"h-5 w-5"})})]})}).displayName="NeoDropdownCheckboxItem",i.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,n.jsx)(tl.Z0,{ref:t,className:(0,M.cn)("my-3 h-[4px] bg-black",r),...a})}).displayName="NeoDropdownSeparator";var tc=e=>{let{preview:t,designView:r,updateHtml:a,streaming:l,messages:s,onElementSelected:o,onImageError:d,onOtherError:c,elementEditingMode:p=!1,onIframeReady:u}=e,m=(0,i.useMemo)(()=>s.filter(e=>null!=e&&!!e.type&&("html"===e.type||"update_html"===e.type||"updateInterface"===e.type||"finalizeApp"===e.type)).map((e,t)=>{let r=e.content;if("update_html"===e.type)try{let t=JSON.parse(e.content);t.html&&(r=t.html)}catch(t){r=e.content}return{version:t?"Version ".concat(t):"Prototype",content:r}}).reverse(),[s]);return(0,n.jsxs)("div",{className:"ph-no-capture relative h-full w-full bg-[#282c34]",children:[l&&"html"!==r&&(0,n.jsx)(ta,{}),p&&"html"!==r&&(0,n.jsx)("div",{className:"absolute left-4 top-4 z-10 rounded bg-orange-500 px-3 py-1 text-sm font-medium text-white shadow-lg",children:"\uD83C\uDFAF Click any element to edit"}),"html"!==r&&(0,n.jsx)("div",{className:"absolute right-4 top-4 z-10",children:(0,n.jsxs)(ts,{children:[(0,n.jsx)(to,{className:"opacity-50 hover:opacity-100",children:(0,n.jsx)(tt.Z,{className:"h-6 w-6"})}),(0,n.jsx)(ti,{className:"max-h-[300px] min-w-[150px] overflow-y-auto",children:m.map(e=>(0,n.jsxs)(td,{className:"flex items-center justify-between gap-2 px-4 py-2 text-sm",onClick:()=>a(e.content),children:[(0,n.jsx)("span",{children:e.version}),(0,n.jsx)("span",{className:"text-xs text-gray-500"})]},e.version))})]})}),t?"html"===r?(0,n.jsx)(eQ.Z,{className:"h-full",code:t,language:"html",disabled:!1,onChange:eY().debounce(a,300),streaming:l}):(0,n.jsx)(e0,{children:(0,n.jsx)(te,{preview:t,streaming:l,onElementSelected:o,onImageError:d,onOtherError:c,elementEditingMode:p,onIframeReady:u})}):(0,n.jsx)("div",{className:"bg-radial-dots flex h-full items-center justify-center dark:bg-gray-900",children:(0,n.jsxs)("div",{className:"border-2 border-black bg-white p-8 text-center shadow-[8px_8px_0px_0px_rgba(0,0,0,1)] dark:border-gray-600 dark:bg-gray-800 dark:shadow-[8px_8px_0px_0px_rgba(75,85,99,1)]",children:[(0,n.jsx)(g.Z,{className:"mx-auto mb-4 h-12 w-12 dark:text-gray-200"}),(0,n.jsx)("p",{className:"text-lg font-bold text-black dark:text-gray-200",children:"Your UI design will appear here"})]})})]})},tp=r(22524),tu=r(88593),tm=r(64544);function th(e){let{app:t,toast:r,onCancel:a,variant:l="section"}=e,{t:o}=(0,s.Z)("common"),c=(0,d.useRouter)(),[u,m]=(0,i.useState)(t.subdomain),[h,g]=(0,i.useState)(!1),[x,b]=(0,i.useState)(null),[f,v]=(0,i.useState)(!1),y=(0,i.useRef)(null);(0,i.useEffect)(()=>{var e;let n=(e=t.schema.appName||"")?e.toLowerCase().replace(/[^a-z0-9-]+/g,"-").replace(/^-+|-+$/g,"").replace(/--+/g,"-"):"";t.schema.appName&&t.subdomain&&n&&n!==t.subdomain&&!t.lastPublishedAt&&"section"===l&&(!y.current||y.current.appName!==t.schema.appName||y.current.subdomain!==t.subdomain)&&(y.current={appName:t.schema.appName||"",subdomain:t.subdomain},g(!0),(0,eX.Dq)(t.id,n).then(e=>{var t;let a=(null==e?void 0:null===(t=e.appGen)||void 0===t?void 0:t.subdomain)||n;m(a),b(null),r({title:o("subdomain.appLinkUpdated.title"),description:o("subdomain.appLinkUpdated.description",{subdomain:a}),className:"border-2 border-black bg-yellow-300 font-bold text-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] dark:border-gray-200 dark:bg-yellow-600 dark:text-white dark:shadow-[4px_4px_0px_0px_rgba(255,255,255,0.3)]"}),c.asPath!=="/builder/".concat(a)&&c.replace("/builder/".concat(a))}).catch(e=>{let t=o("subdomain.error.default");e&&"object"==typeof e&&"message"in e&&"string"==typeof e.message&&(t=e.message),b(t),r({title:o("subdomain.error.title"),description:t,variant:"destructive",className:"border-2 border-black bg-yellow-300 font-bold text-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] dark:border-gray-200 dark:bg-yellow-600 dark:text-white dark:shadow-[4px_4px_0px_0px_rgba(255,255,255,0.3)]"})}).finally(()=>g(!1)))},[t.schema.appName,t.subdomain,t.lastPublishedAt,t.id,c,r,l,o]);let w=async e=>{e.preventDefault(),b(null),g(!0);try{var n;let e=await (0,eX.Dq)(t.id,u),a=(null==e?void 0:null===(n=e.appGen)||void 0===n?void 0:n.subdomain)||u;m(a),r({title:o("subdomain.success.title"),description:o("subdomain.success.description"),className:"border-2 border-black bg-yellow-300 font-bold text-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] dark:border-gray-200 dark:bg-yellow-600 dark:text-white dark:shadow-[4px_4px_0px_0px_rgba(255,255,255,0.3)]"}),c.replace("/builder/".concat(a))}catch(t){let e=o("subdomain.error.default");t&&"object"==typeof t&&"message"in t&&"string"==typeof t.message&&(e=t.message),b(e),r({title:o("subdomain.error.title"),description:e,variant:"destructive",className:"border-2 border-black bg-yellow-300 font-bold text-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] dark:border-gray-200 dark:bg-yellow-600 dark:text-white dark:shadow-[4px_4px_0px_0px_rgba(255,255,255,0.3)]"})}finally{g(!1)}},_=async e=>{e&&(await navigator.clipboard.writeText(e),v(!0),r&&r({title:o("subdomain.copied.title"),description:o("subdomain.copied.description"),className:"border-2 border-black bg-yellow-300 font-bold text-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] dark:border-gray-200 dark:bg-yellow-600 dark:text-white dark:shadow-[4px_4px_0px_0px_rgba(255,255,255,0.3)]"}),setTimeout(()=>v(!1),1500))},j=(0,tm.T)(u);return"modal"===l?(0,n.jsxs)("form",{onSubmit:w,className:"space-y-6 p-8",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"mb-1 block font-bold text-black dark:text-white",children:o("subdomain.title")}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(F.I,{value:u,onChange:e=>m(e.target.value.toLowerCase()),placeholder:o("subdomain.placeholder"),pattern:"[a-z0-9-]+",title:o("subdomain.pattern"),required:!0,className:"font-mono flex-1 rounded-none border-2 border-black bg-white text-black shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] focus-visible:ring-0 dark:border-cyan-500 dark:bg-[#1a1a1a] dark:text-white dark:shadow-[2px_2px_0px_0px_rgba(6,182,212,1)]"}),(0,n.jsx)(S.Z,{type:"button",className:"flex items-center justify-center bg-gray-200 text-black hover:bg-gray-300 dark:bg-gray-800 dark:text-white dark:hover:bg-gray-700",onClick:()=>_(j),style:{minWidth:44,width:44,height:44,padding:0},"aria-label":o("subdomain.copy"),title:o("subdomain.copy"),disabled:h,children:f?(0,n.jsx)(k.Z,{className:"h-5 w-5"}):(0,n.jsx)(tp.Z,{className:"h-5 w-5"})}),(0,n.jsx)(S.Z,{type:"button",className:"flex items-center justify-center bg-sky-200 text-black hover:bg-sky-300 dark:bg-gray-800 dark:text-white dark:hover:bg-gray-700",style:{minWidth:44,width:44,height:44,padding:0},"aria-label":o("subdomain.view"),title:o("subdomain.view"),disabled:h,children:(0,n.jsx)(p(),{href:j,target:"_blank",rel:"noopener noreferrer",children:(0,n.jsx)(tu.Z,{className:"h-5 w-5"})})})]}),(0,n.jsx)("div",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:j}),x&&(0,n.jsx)("p",{className:"font-mono mt-2 text-sm font-bold text-red-500 dark:text-red-400",children:x})]}),(0,n.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,n.jsx)(S.Z,{type:"button",onClick:a,disabled:h,className:"bg-gray-200 hover:bg-gray-300 dark:bg-gray-800 dark:text-white dark:hover:bg-gray-700",children:o("subdomain.cancel")}),(0,n.jsx)(S.Z,{type:"submit",disabled:h,className:"bg-pink-500 text-white hover:bg-pink-400 dark:bg-gray-800 dark:text-white dark:hover:bg-gray-700",children:h?o("subdomain.updating"):o("subdomain.update")})]})]}):(0,n.jsxs)("form",{onSubmit:w,className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(F.I,{value:u,onChange:e=>m(e.target.value.toLowerCase()),placeholder:o("subdomain.placeholder"),pattern:"[a-z0-9-]+",title:o("subdomain.pattern"),required:!0,className:"font-mono flex-1 rounded-none border-2 border-black bg-white text-black shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] focus-visible:ring-0 dark:border-cyan-500 dark:bg-[#1a1a1a] dark:text-white dark:shadow-[2px_2px_0px_0px_rgba(6,182,212,1)]"}),(0,n.jsx)("div",{className:"flex items-center gap-2",children:(0,n.jsx)(S.Z,{type:"button",className:"ml-1 flex items-center justify-center bg-gray-200 text-black hover:bg-gray-300 dark:bg-gray-800 dark:text-white dark:hover:bg-gray-700",onClick:()=>_(j),style:{minWidth:44,width:44,height:44,padding:0},"aria-label":o("subdomain.copy"),title:o("subdomain.copy"),disabled:h,children:f?(0,n.jsx)(k.Z,{className:"h-5 w-5"}):(0,n.jsx)(tp.Z,{className:"h-5 w-5"})})})]}),(0,n.jsx)("div",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:j}),x&&(0,n.jsx)("p",{className:"font-mono mt-2 text-sm font-bold text-red-500 dark:text-red-400",children:x})]}),(0,n.jsxs)("div",{className:"flex justify-center gap-2",children:[(0,n.jsx)(S.Z,{type:"submit",disabled:h,className:"bg-pink-500 text-white hover:bg-pink-400 dark:bg-gray-800 dark:text-white dark:hover:bg-gray-700",children:h?o("subdomain.updating"):o("subdomain.updateLink")}),(0,n.jsx)(S.Z,{type:"button",className:"bg-sky-500 text-white hover:bg-sky-600",children:(0,n.jsx)(p(),{href:j,target:"_blank",rel:"noopener noreferrer",children:"View App"})})]})]})}var tg=r(50453),tx=r(65283);function tb(e){let{open:t,onClose:r,children:a}=e;return t?(0,n.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40",onClick:r,children:(0,n.jsxs)("div",{className:"relative w-full max-w-lg rounded-lg bg-white shadow-lg dark:bg-gray-900",onClick:e=>e.stopPropagation(),role:"dialog","aria-modal":"true",children:[a,(0,n.jsx)("button",{onClick:r,className:"absolute right-2 top-2 text-gray-400 hover:text-gray-700 dark:hover:text-white","aria-label":"Close modal",children:(0,n.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]})}):null}function tf(e){let{children:t}=e;return(0,n.jsx)("div",{className:"p-4",children:t})}var tv=r(27019);function ty(e){let{active:t}=e,r=(0,i.useRef)(null),[a,l]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{if(t){l(!0);let e=setTimeout(()=>l(!1),3e3);return()=>clearTimeout(e)}l(!1)},[t]),(0,i.useEffect)(()=>{let e;if(!a||window.matchMedia("(prefers-reduced-motion: reduce)").matches)return;let t=r.current;if(!t)return;let n=t.getContext("2d");if(!n)return;let l=window.innerWidth,s=window.innerHeight;t.width=l,t.height=s;let o=["#3b82f6","#ef4444","#f97316","#22c55e","#eab308","#a855f7"],i=Array.from({length:window.innerWidth<768?75:150}).map(()=>({x:Math.random()*l,y:Math.random()*s-s,size:6+4*Math.random(),color:o[Math.floor(Math.random()*o.length)],velocityX:(Math.random()-.5)*6,velocityY:3*Math.random()+3,rotation:360*Math.random(),rotationSpeed:(Math.random()-.5)*10})),d=()=>{l=window.innerWidth,s=window.innerHeight,t.width=l,t.height=s};window.addEventListener("resize",d);let c=()=>{n.clearRect(0,0,l,s),i.forEach(e=>{e.x+=e.velocityX,e.y+=e.velocityY,e.rotation+=e.rotationSpeed,e.y>s&&(e.y=-10),e.x>l&&(e.x=0),e.x<0&&(e.x=l),n.save(),n.translate(e.x,e.y),n.rotate(e.rotation*Math.PI/180),n.fillStyle=e.color,n.fillRect(-e.size/2,-e.size/2,e.size,e.size),n.restore()}),e=requestAnimationFrame(c)};return c(),()=>{cancelAnimationFrame(e),window.removeEventListener("resize",d)}},[a]),a?(0,n.jsx)("canvas",{ref:r,className:"pointer-events-none fixed inset-0 z-50"}):null}var tk=r(4193);function tw(e){let{open:t,onClose:r,onViewLayout:a,app:l,toast:s}=e,o="https://".concat(l.subdomain,".magicloops.app");return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(ty,{active:t}),(0,n.jsxs)(tb,{open:t,onClose:r,children:[(0,n.jsx)("div",{className:"border-b-4 border-black bg-yellow-300 p-4 dark:border-cyan-500 dark:bg-purple-950",children:(0,n.jsx)("div",{className:"flex flex-col items-center",children:(0,n.jsx)("h2",{className:"mt-2 text-center text-xl font-black uppercase text-black dark:text-white",children:"Your App is Ready!"})})}),(0,n.jsx)(tf,{children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)(tv.Z,{sizeMultiplier:.7,animate:!0}),(0,n.jsx)("p",{className:"mb-2",children:"Your app has been created and is ready to use!"}),(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4",children:[(0,n.jsxs)("div",{className:"mt-4 flex flex-col items-center",children:[(0,n.jsx)(tk.ZP,{value:o,size:180}),(0,n.jsx)("div",{className:"mt-2 text-sm text-black dark:text-white",children:"Scan to open this app on your phone"})]}),(0,n.jsx)("div",{className:"mt-4",children:(0,n.jsx)(th,{app:l,toast:s,variant:"section"})})]})]})})]})]})}var t_=r(31031);function tj(e){var t;let{user:r}=e,a=(0,d.useRouter)();(0,u.U0)();let{userProfile:l}=(0,eJ.U)(),{toast:o}=(0,N.pm)(),[c,A]=(0,i.useState)("schema"),[O,M]=(0,i.useState)("html"),T=(0,i.useRef)(!1),[z,F]=(0,i.useState)(""),[P,R]=(0,i.useState)(!1),[H,Z]=(0,i.useState)(!1),[U,q]=(0,i.useState)(!1),[B,W]=(0,i.useState)(!1),[J,V]=(0,i.useState)(!1),[Y,X]=(0,i.useState)(null);(0,i.useEffect)(()=>{let e=()=>R(window.innerWidth<1024);return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let $="string"==typeof a.query.id?a.query.id:void 0,K=(0,i.useCallback)(()=>{let e="https://".concat($,".magicloops.app");return(0,t_.r8)()?"http://localhost:3000/app/".concat($):e},[$]),{appGen:Q,messages:ee,preview:et,description:er,questions:en,schema:ea,loading:es,error:eo,progress:ei,isProcessing:ed,sendMessage:ec,updateHtml:ep,restoreVersion:eu,fixResponse:em,stopMessageStream:eh,createdLoops:eg,setCreatedLoops:ex,activeLoopId:eb,setActiveLoopId:ef,handleFinishLoop:ev,handleSubmitQuestions:ey,showCompletionModal:ek,setShowCompletionModal:ew,confirmStepTransition:e_,cancelStepTransition:ej,handleSchemaUpdate:eN,addErrorMessage:eS,elementEditingMode:eL,setElementEditingMode:eD,addElementMessage:eI,selectedElement:eA,clearSelectedElement:eO,setDescription:eT,setMessages:ez}=function(e){let{appGenSubdomain:t,setActiveTab:r,setDesignView:n,setInput:a,isSmallScreen:l}=e,o=(0,d.useRouter)(),c=(0,u.U0)(),{t:p}=(0,s.Z)("apps"),[m,h]=(0,i.useState)(null),[g,x]=(0,i.useState)([]),[b,f]=(0,i.useState)(""),[v,y]=(0,i.useState)([]),[k,w]=(0,i.useState)(),[_,j]=(0,i.useState)(""),[N,E]=(0,i.useState)(!0),[C,S]=(0,i.useState)(null),[L,D]=(0,i.useState)({step:"idle",status:"idle",error:null}),[I,A]=(0,i.useState)({mode:!1,selectedElement:null}),O=(0,i.useRef)(!1),M=(0,i.useRef)(!1),T=(0,i.useMemo)(()=>(0,eV.debounce)(e=>{j(e)},50),[j]),[z,F]=(0,i.useState)(!1),P=(0,i.useRef)(),[R,H]=(0,i.useState)(!1),[Z,U]=(0,i.useState)([]),[q,B]=(0,i.useState)(null),W=(0,i.useCallback)(()=>{D(e=>({...e,status:"success",error:null}))},[]),G=(0,i.useCallback)(e=>{D(t=>({...t,status:"error",error:(0,e$.f0)(e)}))},[]),J=(0,i.useCallback)(async()=>{let{step:e}=L;if(e&&"running"!==L.status&&(null==m?void 0:m.id))switch(e){case"gatherReqs":case"generateLoops":break;case"createSchema":null==k||k.interfaceDescription;break;case"generateHtml":if((null==k?void 0:k.loops)&&k.loops.length>0)ea(k.loops);else{D({step:"generateHtml",status:"success"});let e=await (0,eX.z3)(m.id,{state:"done"});D({step:e.state,status:"success"}),h(e)}break;case"finalize":let t=await (0,eX.z3)(m.id,{state:"done"});D({step:t.state,status:"success"}),h(t)}},[L,b,k]),V=(0,i.useCallback)(()=>{let e={content:"What would you like to change?",type:"text",role:"ai"};x(t=>[...t,e]),D(e=>({...e,status:"idle"}))},[x]),Y=(0,i.useCallback)(e=>{D({step:e,status:"running",error:null})},[]),X=(0,i.useCallback)(function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.includes(L.step)},[L.step]),$=(0,i.useCallback)(e=>L.status===e,[L.status]),K=(0,i.useCallback)(function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return X(...t)&&$("running")},[X,$]),Q=K("gatherReqs","generateHtml","finalize","updateHtml");(0,i.useEffect)(()=>{Q&&!O.current&&_.toLowerCase().includes("<body")&&(n("ui"),O.current=!0)},[Q,_,n]);let ee=(0,i.useCallback)(async e=>{var t;let r=null!==(t=null==m?void 0:m.id)&&void 0!==t?t:e;if(r){(0,eK.fJ)(c,eK.ju.app_refresh_loops,{appId:r});try{let e=await (0,eX.e_)(r);(null==e?void 0:e.length)?(e.map(e=>({loop:e.loop,loopGen:e.loopGen,status:e.loop.published?"finished":"pending"})),U(t=>{let r=[...t];for(let{loop:t,loopGen:n}of e){let e=r.findIndex(e=>e.loop.id===t.id),a=t.published?"finished":"pending";-1===e?r.push({loop:t,loopGen:n,status:a}):r[e]={...r[e],loop:t,loopGen:n,status:a}}return r}),(0,eK.S_)(c,eK.ju.app_refresh_loops,{appId:r,loopCount:e.length,loopIds:e.map(e=>e.loop.id)})):(0,eK.S_)(c,eK.ju.app_refresh_loops,{appId:r,loopCount:0})}catch(e){console.error("Failed to refresh loops:",e),(0,eK.gT)(c,eK.ju.app_refresh_loops,{error:e,appId:r},!0)}}},[null==m?void 0:m.id,Z,U,c]);(0,i.useEffect)(()=>{(async()=>{if(!M.current){M.current=!0,E(!0),Y("init"),(0,eK.fJ)(c,eK.ju.app_init,{subdomain:t});try{if(t){var e,s,o;let{appGen:i}=await (0,eX.qY)(t);if(!i)throw Error("AppGen not found");if(h(i),x(i.messages),f(i.description),w(i.schema),(null==i?void 0:null===(e=i.messages)||void 0===e?void 0:e.length)>1&&a(""),i.html&&(T(i.html),r("design"),n("ui")),(null==i?void 0:null===(s=i.messages)||void 0===s?void 0:s.length)>1){let e=i.messages,t=eY().last(e);if((null==t?void 0:t.type)==="gather_requirements"){let e=(0,el.OA)(t.content);(null==e?void 0:e.questions)&&y(e.questions)}}(!i.messages||(null===(o=i.messages)||void 0===o?void 0:o.length)<=1)&&l&&r("chat"),Y(i.state),await ee(i.id),(0,eK.S_)(c,eK.ju.app_init,{appId:i.id})}else console.error("No App Gen ID found!"),(0,eK.gT)(c,eK.ju.app_init,{error:Error("No App Gen ID found!")},!0);W()}catch(e){console.error("initAppGen failed:",e),S("Failed to load or create AppGen. Please try again."),G("Failed to load or create AppGen. Please try again."),(0,eK.gT)(c,eK.ju.app_init,{error:e},!0)}finally{E(!1)}}})()},[t,T,o,l]),(0,i.useEffect)(()=>{if(!g.length)return;let e=g[g.length-1];if("loops"===e.type)try{let t=JSON.parse(e.content);U(e=>{let r=[...e];for(let{loop:e,loopGen:n}of t)if(!r.find(t=>t.loop.id===e.id)){let t=e.published?"finished":"pending";r.push({loop:e,loopGen:n,status:t})}return r}),!q&&(null==t?void 0:t.length)&&B(t[0].loop.id)}catch(e){console.error("Failed to parse loops message:",e)}},[g,q]);let et=(0,i.useCallback)(async e=>{var t;let n;if(!(null==m?void 0:m.id))return;S(null),null===(t=P.current)||void 0===t||t.abort();let l="string"==typeof e?e:e.content;if("string"==typeof l){let e=l.match(/\[IMAGE_UPLOAD:([^\]]+)\]/);e&&(l=l.replace(/\[IMAGE_UPLOAD:[^\]]+\]/g,"").trim(),n=[{url:e[1],type:"image"}])}I.selectedElement&&"string"==typeof l&&!l.includes("I want to modify this element:")&&(l="I want to modify this element: ".concat(I.selectedElement.elementName,"\n\nElement HTML:\n").concat(I.selectedElement.html,"\n\nUser request: ").concat(l,"\n\nPlease update the HTML to incorporate the user's requested changes."),A(e=>({...e,selectedElement:null})));let s={type:"user_input",role:"user",content:l,images:n||("object"==typeof e?e.images:void 0)};Y(m.state);let o=g.length;x(e=>(o=e.length+1,[...e,s])),a(""),P.current=new AbortController;let i=P.current.signal,d={appId:m.id};(0,eK.fJ)(c,eK.ju.app_send_message,d);let p=!1;try{let e=[];if(await (0,eX.hx)(m.id,s,i,(t,n)=>{if(n){let e=(0,e$.f0)(n);e.includes("Insufficient generation credits")?x(t=>{let r=[...t];return r.push({type:"insufficient_credits",role:"ai",content:e}),r}):S(e);return}e=t,x(e=>{let n=[...e];return t.forEach((e,t)=>{if(n[o+1+t]=e,"create_app"===e.type){p||(p=!0,r("schema"),Y("gatherReqs"));let t=(0,el.OA)(e.content);(null==t?void 0:t.description)&&f(t.description)}else if("gather_requirements"===e.type){p||(p=!0,r("schema"),Y("gatherReqs"));let t=(0,el.OA)(e.content);(null==t?void 0:t.questions)&&y(t.questions)}else e.type}),n})}),i.aborted){(0,eK._$)(c,eK.ju.app_send_message,{...d,reason:"abort"});return}(0,eK.S_)(c,eK.ju.app_send_message,d),W(),e.forEach((e,t)=>{if("create_app"===e.type){let r=(0,el.OA)(e.content);(null==r?void 0:r.description)?(x(e=>{let t=[...e];return(0,eX.z3)(m.id,{messages:t}),t}),(0,eK.S_)(c,eK.ju.app_create_outline,{appId:m.id}),er(r.description)):(0,eK.gT)(c,"create outline",{error:Error("outline parse fail"),partialContent:e.content.slice(0,100),...d,index:o+t+1},!0)}else if("modifyUserInterface"===e.type)try{let t=(0,el.OA)(e.content);(null==t?void 0:t.description)&&es(t.description)}catch(e){console.error(e)}})}catch(t){(0,eK.gT)(c,eK.ju.app_send_message,{error:t,...d},!0);let e=(0,e$.f0)(t);e.includes("Insufficient generation credits")?x(t=>{let r=[...t];return r.push({type:"insufficient_credits",role:"ai",content:e}),r}):(S(e),G(t))}},[null==m?void 0:m.id,g,c,T,x,I.selectedElement]),er=(0,i.useCallback)(async e=>{if(!(null==m?void 0:m.id))return;Y("createSchema"),x(e=>{let t=[...e];return t.push({type:"appSchema",role:"ai",content:"Generating Schema"}),t}),r("schema"),P.current=new AbortController;let t=P.current.signal,n={appId:m.id};(0,eK.fJ)(c,eK.ju.app_create_schema,n);try{let r=[];if(await (0,eX._1)(m.id,e,t,(e,t)=>{if(t){S((0,e$.f0)(t));return}r=e,x(t=>{let r=[...t];return e.forEach((e,t)=>{if("appSchema"===e.type){let t=(0,el.OA)(e.content);t&&w(t)}}),r})}),t.aborted){(0,eK._$)(c,eK.ju.app_create_schema,{...n,reason:"abort"});return}(0,eK.S_)(c,eK.ju.app_create_schema,n),r.forEach((e,t)=>{if("appSchema"===e.type){let t=(0,el.OA)(e.content);(null==t?void 0:t.interfaceDescription)?(W(),en(t)):(0,eK.gT)(c,"create loop",{error:Error("outline parse fail"),partialContent:e.content.slice(0,100),...n},!0)}})}catch(e){(0,eK.gT)(c,"send message",{error:e,...n},!0),S((0,e$.f0)(e)),G(e)}},[null==m?void 0:m.id,g,x,c,W]),en=(0,i.useCallback)(async e=>{var t,a;if(!(null==m?void 0:m.id))return;let l=e.interfaceDescription;if(!l)return;Y("generateHtml");let s={appId:m.id};(0,eK.fJ)(c,eK.ju.app_generate_html,s),F(!0),S(null),r("design"),n("html"),O.current=!1,null===(t=P.current)||void 0===t||t.abort(),P.current=new AbortController;let o=m.html;try{await (0,eX.yd)(m.id,{content:l,type:"generatingUI",role:"ai"},P.current.signal,(e,t)=>{if(t){S((0,e$.f0)(t));return}x(t=>{let r=[...t],n=eY().findLastIndex(r,e=>"appSchema"===e.type);return e.forEach((e,t)=>{r[n+1+t]=e,"html"===e.type&&(o=e.content,T(e.content))}),r})});let t=await (0,eX.z3)(m.id,{html:o});h(t),r("design"),n("ui"),W(),(0,eK.S_)(c,eK.ju.app_generate_html,{appId:m.id}),null===(a=e.loops)||void 0===a||a.length}catch(e){S("Failed to generate UI. Please try again."),G("Failed to generate UI. Please try again."),(0,eK.gT)(c,eK.ju.app_generate_html,{error:e,appId:m.id},!0)}finally{F(!1)}},[m,g,T,W,x]),ea=(0,i.useCallback)(async e=>{if(!(null==m?void 0:m.id)||!(null==e?void 0:e.length))return;x(e=>[...e,{type:"loopGen",role:"ai",content:"Generating Loops"}]),Y("generateLoops");let t={numLoops:e.length,appId:m.id};(0,eK.fJ)(c,eK.ju.app_generate_loops,t),r("loops");let n=[],a=[];for(let t of e)try{let e=await (0,eX.hP)({description:t.description,name:t.name,source:"appBuilder",lang:"en",appId:m.id});(null==e?void 0:e.loop)&&(null==e?void 0:e.loopGen)&&(a.push(e),n.push({...t,id:e.loop.id}))}catch(e){console.error("Error generating loop:",e),G(e),(0,eK.gT)(c,eK.ju.app_generate_loops,{error:e,loopName:t.name,appId:m.id},!0)}w(e=>{let t={...e,loops:n};return(0,eX.z3)(m.id,{schema:t,state:"generateLoops"}),t}),(0,eK.S_)(c,eK.ju.app_generate_loops,{numLoops:e.length,appId:m.id,loopIds:a.map(e=>e.loop.id)}),x(e=>{let t=[...e];return t.push({type:"loops",role:"ai",content:JSON.stringify(a)}),(0,eX.z3)(m.id,{messages:t}),t})},[null==m?void 0:m.id,x]),es=(0,i.useCallback)(async e=>{if(!(null==m?void 0:m.id))return;r("design"),n("html"),"finalize"===m.state?Y("finalize"):Y("generateHtml"),P.current=new AbortController;let t=P.current.signal,a={index:g.length,appId:m.id};(0,eK.fJ)(c,eK.ju.app_update_html,a);let l=!1;try{let s=[];if(await (0,eX.xN)(m.id,e,t,(e,t)=>{if(t){S((0,e$.f0)(t));return}s=e,x(t=>{let a=[...t],s=eY().findLastIndex(a,e=>"modifyUserInterface"===e.type);return e.forEach((e,t)=>{if(a[s+1+t]=e,"editRequest"===e.type){let t=null==e?void 0:e.content;if(t)try{let e=(0,el.fC)(t,"html");T(e)}catch(e){console.error(e)}}if("updateInterface"===e.type){l||(l=!0,r("design"),n("html"),O.current=!1);let t=null==e?void 0:e.content;t&&T(t)}}),a})}),t.aborted){(0,eK._$)(c,eK.ju.app_update_html,{...a,reason:"abort"});return}s.forEach((e,t)=>{if("updateInterface"===e.type){let t=null==e?void 0:e.content;t&&T(t)}}),(0,eK.S_)(c,eK.ju.app_update_html,a),r("design"),n("ui"),W(),x(e=>{let t=[...e];return t.push({type:"text",role:"ai",content:"The app has been updated, try it out!"}),(0,eX.z3)(m.id,{messages:t}),t})}catch(e){(0,eK.gT)(c,eK.ju.app_finalize,{error:e,...a},!0),S((0,e$.f0)(e)),G((0,e$.f0)(e))}},[null==m?void 0:m.id,g,x,r,n,Y,S,G,W,h,T]),eo=(0,i.useCallback)(async()=>{if(!(null==m?void 0:m.id))return;r("design"),n("html"),Y("finalize"),P.current=new AbortController;let e=P.current.signal,t={index:g.length,appId:m.id};(0,eK.fJ)(c,eK.ju.app_finalize,t);let a=!1;try{if(await (0,eX.Hg)(m.id,e,(e,t)=>{if(t){S((0,e$.f0)(t));return}x(t=>{let l=[...t],s=eY().findLastIndex(l,e=>e&&"loops"===e.type),o=s>=0?s+1:l.length;return e.forEach((e,t)=>{if(l[o+t]=e,"editRequest"===e.type){let t=null==e?void 0:e.content;t&&T(t)}if("finalizeApp"===e.type){a||(a=!0,r("design"),n("html"),O.current=!1);let t=null==e?void 0:e.content;t&&T(t)}}),l})}),e.aborted){(0,eK._$)(c,eK.ju.app_finalize,{...t,reason:"abort"});return}(0,eK.S_)(c,eK.ju.app_finalize,t),r("design"),n("ui"),W(),x(e=>{let t=[...e];return t.push({type:"finalized",role:"ai",content:"The app has been finished, try it out!"}),(0,eX.z3)(m.id,{messages:t}),t});let l=await (0,eX.z3)(m.id,{state:"finalize"});h(l)}catch(e){(0,eK.gT)(c,eK.ju.app_finalize,{error:e,...t},!0),S((0,e$.f0)(e)),G((0,e$.f0)(e))}},[null==m?void 0:m.id,g,x,r,n,Y,S,G,W,h,T]),ei=(0,i.useCallback)(async(e,t)=>{var n;if(!(null==m?void 0:m.id))return;S(null),null===(n=P.current)||void 0===n||n.abort();let l="";e.map((e,r)=>{let n=t[r];n=Array.isArray(n)?n.length>1?n.slice(0,-1).join(" and ")+" and "+n.slice(-1):n[0]:"boolean"==typeof n?n?"Yes":"No":(null==n?void 0:n.toString())||"No response",l+="\n> ".concat(e.question,"\n").concat(n,"\n")});let s={content:l,role:"user",type:"app_question_responses"};Y("gatherReqs"),r("schema"),x(e=>[...e,s]),a(""),y([]),P.current=new AbortController;let o=P.current.signal,i={appId:m.id};(0,eK.fJ)(c,eK.ju.app_submit_questions,i);try{let e=g.length,t=[];if(await (0,eX.hx)(m.id,s,o,(r,n)=>{if(n){S((0,e$.f0)(n));return}t=r,x(t=>{let n=[...t];return r.forEach((t,r)=>{if(n[e+1+r]=t,"create_app"===t.type){let e=(0,el.OA)(t.content);(null==e?void 0:e.description)&&f(e.description)}else if("gather_requirements"===t.type){let e=(0,el.OA)(t.content);(null==e?void 0:e.questions)&&y(e.questions)}else t.type}),n})}),o.aborted){(0,eK._$)(c,eK.ju.app_submit_questions,{...i,reason:"abort"});return}(0,eK.S_)(c,eK.ju.app_submit_questions,i),x(e=>{let t=[...e];return(0,eX.z3)(m.id,{messages:t}),t}),t.forEach((t,r)=>{if("create_app"===t.type){let n=(0,el.OA)(t.content);(null==n?void 0:n.description)?(W(),(0,eK.S_)(c,eK.ju.app_create_outline,{appId:m.id}),er(n.description)):(0,eK.gT)(c,"create outline",{error:Error("outline parse fail"),partialContent:t.content.slice(0,100),...i,index:e+r+1},!0)}else if("modifyUserInterface"===t.type)try{let e=(0,el.OA)(t.content);(null==e?void 0:e.description)&&es(e.description)}catch(e){console.error(e)}})}catch(e){(0,eK.gT)(c,eK.ju.app_submit_questions,{error:e,...i},!0),S((0,e$.f0)(e)),G(e)}},[null==m?void 0:m.id,g,c,x]),ed=(0,i.useCallback)(e=>{if(null==m?void 0:m.id){(0,eK.fJ)(c,eK.ju.app_finish_loop,{loopId:e,appId:m.id}),Y("generateLoops");try{U(t=>{let r=[...t];return r=r.map(t=>t.loop.id===e?{...t,status:"finished"}:t)});let t=Z.find(t=>"pending"===t.status&&t.loop.id!==e);t?B(t.loop.id):(W(),eo(),r("design"),B(null)),ee(),(0,eK.S_)(c,eK.ju.app_finish_loop,{loopId:e,appId:m.id})}catch(t){(0,eK.gT)(c,eK.ju.app_finish_loop,{error:t,loopId:e,appId:m.id},!0)}}},[Z,U,eo,null==m?void 0:m.id,c]),ec=(0,i.useCallback)(e=>{e&&x(t=>{if(t.length&&"error"===t[t.length-1].type)return t;let r=[...t,{content:e,type:"app-error",role:"ai"}];return null==m||m.id,r})},[null==m?void 0:m.id,x]),ep=(0,i.useCallback)(e=>{if(!e)return;let{tagName:t,html:r,textContent:n}=e,a=t;if(n&&n.length<50)a="".concat(t,' ("').concat(n,'")');else if(r.includes("class=")){let e=r.match(/class=["']([^"']+)["']/);e&&(a="".concat(t,".").concat(e[1].split(" ")[0]))}A(e=>({mode:!1,selectedElement:{elementName:a,html:r,tagName:t,textContent:n}}))},[]),eu=(0,i.useCallback)(async(e,t)=>{if(e){if(t){var r,n,a;let t="string"==typeof e.content?JSON.parse(e.content):e.content;if(!t||"object"!=typeof t||!t.payload){et(e.content);return}let{type:l,payload:s}=t,o=["⚠️  Fix the following *".concat(l,"* in the user-generated app:"),"","**Message:** ".concat(null!==(r=s.message)&&void 0!==r?r:"(no message)")];s.filename&&o.push("**Location:** ".concat(s.filename,":").concat(null!==(n=s.lineno)&&void 0!==n?n:0,":").concat(null!==(a=s.colno)&&void 0!==a?a:0)),s.src&&o.push("**Resource:** ".concat(s.src)),s.stack&&o.push("","```stack",s.stack.trim(),"```"),et(o.join("\n"));return}x(t=>t.filter(t=>t!==e))}},[null==m?void 0:m.id,x]),em=(0,i.useCallback)(async e=>{if((null==m?void 0:m.id)&&!z){(0,eK.fJ)(c,eK.ju.app_update_html,{appId:m.id});try{T(e),await (0,eX.z3)(m.id,{html:e}),h(t=>t&&{...t,html:e}),(0,eK.S_)(c,eK.ju.app_update_html,{appId:m.id})}catch(e){(0,eK.gT)(c,eK.ju.app_update_html,{error:e,appId:m.id},!0)}}},[null==m?void 0:m.id,z,T,c]),eh=(0,i.useCallback)(async e=>{if(e){let t=e.content;if("update_html"===e.type)try{let r=JSON.parse(e.content);r.html&&(t=r.html)}catch(r){t=e.content}await em(t),r("design"),n("ui");return}},[r,n,em]),eg=(0,i.useCallback)(()=>{var e;null===(e=P.current)||void 0===e||e.abort(),(null==m?void 0:m.id)&&((0,eK.fJ)(c,eK.ju.app_stop_message_stream,{appId:m.id}),(0,eK.S_)(c,eK.ju.app_stop_message_stream,{appId:m.id}))},[null==m?void 0:m.id,c]),ex=(0,i.useCallback)(async(e,t)=>{if(!(null==m?void 0:m.id))return;let r={state:"createSchema"};if(e){var n;let t={...e,loops:null===(n=e.loops)||void 0===n?void 0:n.map(e=>({...e,description:e.description}))};r.schema=t,w(t)}t&&(r.description=t,f(t)),h(await (0,eX.z3)(m.id,r))},[null==m?void 0:m.id,w,f,h]),eb=(0,i.useCallback)(async(e,t)=>{if(!(null==m?void 0:m.id))return;let r=b.replace(e,t),n=await (0,eX.z3)(m.id,{description:r,state:"createSchema"});f(r),h(n)},[null==m?void 0:m.id,b,f,h]);return{appGen:m,messages:g,preview:_,description:b,questions:v,schema:k,loading:N,error:C,progress:L,isStep:X,isStatus:$,isProcessing:K,showCompletionModal:R,setShowCompletionModal:H,sendMessage:et,finalizeApp:eo,updateHtml:em,restoreVersion:eh,fixResponse:eu,stopMessageStream:eg,createdLoops:Z,setCreatedLoops:U,activeLoopId:q,setActiveLoopId:B,handleFinishLoop:ed,handleSubmitQuestions:ei,confirmStepTransition:J,cancelStepTransition:V,setDescription:f,setAppGen:h,setSchema:w,handleSchemaUpdate:ex,handleDescriptionSectionUpdate:eb,addErrorMessage:ec,setMessages:x,elementEditingMode:I.mode,setElementEditingMode:e=>A(t=>({...t,mode:e})),addElementMessage:ep,selectedElement:I.selectedElement,clearSelectedElement:()=>A(e=>({...e,selectedElement:null}))}}({appGenSubdomain:$,setActiveTab:A,setDesignView:M,setInput:F,isSmallScreen:P}),{imageErrorQueue:eF,currentImageError:eP,showImageSelector:eR,setShowImageSelector:eH,hasMoreErrors:eZ,errorProgress:eq,currentErrorIndex:eB,handleIframeError:eW,handleSelectImage:eQ,handleImageSelected:e0,handleSkipImageError:e1,handleFixImageError:e2}=function(e){let{appGen:t,preview:r,description:n,setMessages:a,setDescription:l,updateHtml:s,addErrorMessage:o,sendMessage:d,iframeRef:c}=e,{toast:p}=(0,N.pm)(),[u,m]=(0,i.useState)([]),[h,g]=(0,i.useState)(0),[x,b]=(0,i.useState)(!1),[f,v]=(0,i.useState)([]),y=u[h]||null,k=h<u.length-1,w=u.length>0?"".concat(h+1," of ").concat(u.length):"",_=(0,i.useCallback)(e=>{try{let{type:t,payload:r}=e.data;"resource-error"===t&&"img"===r.tag?m(e=>e.find(e=>e.payload.src===r.src)?e:[...e,{type:t,payload:r}]):o(e.data)}catch(e){console.error("Couldn't handle iFrame error"),console.error(e)}},[o]);(0,i.useEffect)(()=>{a(e=>{let t=e.filter(e=>{if(!e||!e.type)return!0;if("app-error"===e.type)try{let t="string"==typeof e.content?JSON.parse(e.content):e.content;return"resource-error-queue"!==t.type}catch(e){}return!0});return u.length>0?[...t,{type:"app-error",role:"ai",content:JSON.stringify({type:"resource-error-queue",payload:{queue:u,totalErrors:u.length}})}]:t})},[u,a]);let j=(0,i.useCallback)(()=>{y&&b(!0)},[y]),E=(0,i.useCallback)(async(e,o)=>{if(y&&(null==t?void 0:t.id)){let d=y.payload.src;if(v(t=>[...t,{oldSrc:d,newSrc:e,altText:o}]),c){var i;null===(i=c.contentWindow)||void 0===i||i.postMessage({type:"replace-image",payload:{oldSrc:d,newSrc:e,altText:o}},"*")}if(r)try{let n=r.replaceAll(d,e);if(n===r){let t=r.match(/https?:\/\/[^\s"']+\.(jpg|jpeg|png|gif|webp)/gi)||[],a=d.split("?")[0],l=t.filter(e=>e.includes(a.split("/").pop()||"")),s=r;for(let t of l)if(t!==d&&(s=s.replaceAll(t,e))!==r){n=s;break}}if(await s(n),(null==t?void 0:t.id)&&await (0,eX.z3)(t.id,{html:n}),h>=u.length-1){let t=f.concat([{oldSrc:d,newSrc:e,altText:o}]),r=t.map(e=>"- ".concat(e.oldSrc.split("/").pop()," → ").concat(e.newSrc.split("/").pop()).concat(e.altText?" (".concat(e.altText,")"):"")).join("\n");a(e=>[...e,{type:"update_html",role:"ai",content:n,metadata:{replacementSummary:"Replaced ".concat(t.length," broken images:\n").concat(r)}}]),v([])}}catch(e){console.error("Failed to update HTML:",e)}if(n)try{let r="\n\n## Selected Images\n- ".concat(e).concat(o?" (".concat(o,")"):""),a=n.includes("## Selected Images")?n+"\n- ".concat(e).concat(o?" (".concat(o,")"):""):n+r;await (0,eX.z3)(t.id,{description:a}),l(a)}catch(e){console.error("Failed to update description:",e)}let x=h+1;g(x),x>=u.length&&(m([]),g(0),v([]),u.length>1&&p({title:"Images Fixed",description:"Fixed ".concat(u.length," broken images"),duration:2e3,className:"bg-green-50 border-green-200 text-green-800"}))}},[y,t,c,r,n,h,u.length,f,s,a,l,p]),C=(0,i.useCallback)(()=>{let e=h+1;if(g(e),e<u.length){let t=u[e],r="".concat(e+1," of ").concat(u.length);o(JSON.stringify({type:"resource-error",payload:{...t.payload,message:"Failed to load (image) - ".concat(r)}}))}else m([]),g(0),v([])},[h,u,o]),S=(0,i.useCallback)(()=>{d("The image at ".concat(null==y?void 0:y.payload.src," is broken. Please fix this or suggest a replacement."));let e=h+1;if(g(e),e<u.length){let t=u[e],r="".concat(e+1," of ").concat(u.length);o(JSON.stringify({type:"resource-error",payload:{...t.payload,message:"Failed to load (image) - ".concat(r)}}))}else m([]),g(0),v([])},[y,h,u,d,o]);return{imageErrorQueue:u,currentImageError:y,showImageSelector:x,setShowImageSelector:b,hasMoreErrors:k,errorProgress:w,currentErrorIndex:h,handleIframeError:_,handleSelectImage:j,handleImageSelected:E,handleSkipImageError:C,handleFixImageError:S}}({appGen:Q,preview:et,description:er,setMessages:ez,setDescription:eT,updateHtml:ep,addErrorMessage:eS,sendMessage:ec,iframeRef:Y}),e4=(0,i.useCallback)(e=>{F(t=>t?"".concat(t," ").concat(e):e)},[F]),e5=(0,i.useCallback)(async e=>{if(Q)try{let t=await (0,eX.N0)(Q,e);if(!t){a.push("/");return}o({title:"Error",description:(0,e$.f0)(t)})}catch(e){o({title:"Error",description:(0,e$.f0)(e)})}},[Q,a,o]);(0,i.useEffect)(()=>{Q&&"done"===Q.state&&!Q.lastPublishedAt&&ew(!0)},[Q]),(0,i.useEffect)(()=>{Q&&!T.current&&(null==ee?void 0:ee.length)===1&&Q.userInput&&(ec(Q.userInput),T.current=!0)},[Q,ee]);let e3=(0,i.useCallback)(()=>{ej(),et&&["generateHtml","finalize"].includes(ei.step)&&(A("design"),eD(!0))},[ej,et,ei.step]),e6=()=>{eD(!eL)},{dividerPosition:e8,isDragging:e9,handleMouseDown:e7}=function(e){let[t,r]=(0,i.useState)(35),[n,a]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{let e=e=>{if(!n)return;let t=document.body.getBoundingClientRect();r(Math.min(Math.max((e.clientX-t.left)/t.width*100,20),80))},t=()=>{a(!1)};return document.addEventListener("mousemove",e),document.addEventListener("mouseup",t),()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",t)}},[n]),{dividerPosition:t,setDividerPosition:r,isDragging:n,handleMouseDown:()=>{a(!0)}}}(0),te=eg.find(e=>e.loop.id===eb),{t:tt}=(0,s.Z)("apps"),tr=(0,i.useCallback)(async()=>{let e=K();await navigator.clipboard.writeText(e),q(!0),o({title:tt("builder.actions.copied"),description:tt("builder.actions.copiedToClipboard"),duration:2e3,className:"border-2 border-black bg-yellow-300 font-bold text-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] dark:border-gray-200 dark:bg-yellow-600 dark:text-white dark:shadow-[4px_4px_0px_0px_rgba(255,255,255,0.3)]"}),setTimeout(()=>{q(!1)},2e3)},[K,o,tt]);return es?(0,n.jsx)("div",{className:"flex h-[91vh] items-center justify-center dark:bg-[#1a1a1a]",children:(0,n.jsx)(E.Z,{className:"h-8 w-8 dark:text-gray-200"})}):(0,n.jsxs)("div",{className:"flex h-full flex-col overflow-y-auto border-t-2 border-black bg-gray-50 dark:border-gray-600 dark:bg-[#1a1a1a] md:flex-row",children:[(0,n.jsxs)("div",{className:"flex flex-1 overflow-hidden",children:[(0,n.jsx)(eE,{isVisible:!P,widthPercentage:P?100:e8,messages:ee,input:z,setInput:F,error:eo,onSend:e=>ec(e),streaming:ed("gatherReqs","generateHtml","finalize"),imageErrorQueue:eF,onRestoreVersion:eu,onFixResponse:em,onSelectImage:eQ,getAppUrl:K,appId:null==Q?void 0:Q.id,onVoiceInput:e4,setCreatedLoops:ex,setActiveLoopId:ef,setActiveTab:A,userProfile:l,confirmStepTransition:e_,cancelStepTransition:e3,progress:ei,selectedElement:eA,clearSelectedElement:eO,elementEditingMode:eL}),!P&&(0,n.jsx)(eC,{onMouseDown:e7,isDragging:e9}),(0,n.jsx)("div",{className:"flex flex-1 flex-col bg-[#FEFCF8] dark:bg-gray-800 md:w-auto",style:{width:"".concat(100-e8,"%")},children:(0,n.jsxs)(D.mQ,{value:c,onValueChange:e=>{"design"!==e&&eD(!1),A(e)},className:"flex h-full flex-1 flex-col",children:[(0,n.jsx)("div",{className:"border-b-2 border-black dark:border-gray-600 sm:px-4",children:(0,n.jsxs)(D.dr,{className:"my-2 flex w-full justify-between gap-2 overflow-x-scroll bg-transparent [&::-webkit-scrollbar]:hidden",children:[(0,n.jsxs)("div",{className:"flex gap-2",children:[!eL&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(D.SP,{value:"chat",className:"border-2 border-black bg-white data-[state=active]:border-black data-[state=active]:bg-yellow-300 data-[state=active]:text-black dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200 hover:dark:bg-gray-700 dark:data-[state=active]:border-gray-600 dark:data-[state=active]:bg-cyan-700 dark:data-[state=active]:text-white lg:hidden",children:tt("builder.tabs.chat")}),(0,n.jsxs)(D.SP,{value:"schema",className:"border-2 border-black bg-white data-[state=active]:border-black data-[state=active]:bg-yellow-300 data-[state=active]:text-black dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200 hover:dark:bg-gray-700 dark:data-[state=active]:border-gray-600 dark:data-[state=active]:bg-cyan-700 dark:data-[state=active]:text-white",children:[!P&&(ed("gatherReqs","createSchema")?(0,n.jsx)(E.Z,{className:"mr-2 h-4 w-4 dark:text-gray-200"}):(0,n.jsx)(m.Z,{className:"mr-2 h-4 w-4"})),tt("builder.tabs.plan")]}),(0,n.jsxs)(D.SP,{value:"design",className:"border-2 border-black bg-white pr-1 data-[state=active]:border-black data-[state=active]:bg-yellow-300 data-[state=active]:text-black dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200 hover:dark:bg-gray-700 dark:data-[state=active]:border-gray-600 dark:data-[state=active]:bg-cyan-700 dark:data-[state=active]:text-white md:pr-2",onClick:()=>{("html"!==O||et)&&M("html"===O?"ui":"html")},children:[!P&&(ed("generateHtml","finalize")?(0,n.jsx)(E.Z,{className:"mr-2 h-4 w-4 dark:text-gray-200"}):"ui"===O?(0,n.jsx)(h.Z,{className:"mr-2 h-4 w-4"}):(0,n.jsx)(g.Z,{className:"mr-2 h-4 w-4"})),"ui"===O?tt("builder.tabs.code"):et?tt("builder.tabs.preview"):"".concat(tt("builder.tabs.preview")," (pending)")]}),(0,n.jsxs)(D.SP,{value:"loops",className:"border-2 border-black bg-white data-[state=active]:border-black data-[state=active]:bg-yellow-300 data-[state=active]:text-black dark:border-gray-600 dark:bg-gray-800 dark:text-gray-200 hover:dark:bg-gray-700 dark:data-[state=active]:border-gray-600 dark:data-[state=active]:bg-cyan-700 dark:data-[state=active]:text-white",onClick:()=>ef(null),children:[!P&&(ed("generateLoops")?(0,n.jsx)(E.Z,{className:"mr-2 h-4 w-4 dark:text-gray-200"}):(0,n.jsx)(x.Z,{className:"mr-2 h-4 w-4"})),"Loops"]})]}),eL&&(0,n.jsxs)(S.Z,{onClick:e6,className:"h-[36px] bg-red-300 font-medium hover:bg-red-400 dark:bg-red-600 dark:text-white dark:hover:bg-red-700",children:[(0,n.jsx)(b.Z,{className:"mr-2 h-4 w-4"}),"Exit Edit Mode"]}),!eL&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p(),{href:"".concat(K()),target:"_blank",children:(0,n.jsx)(S.Z,{className:"h-[36px] bg-sky-300 font-medium hover:bg-sky-400 dark:bg-sky-600 dark:text-white dark:hover:bg-sky-700",disabled:!(et&&(null==Q?void 0:Q.state)==="done"),children:tt("builder.actions.viewApp")})}),"design"===c&&et&&(0,n.jsxs)(S.Z,{onClick:e6,className:"h-[36px] bg-purple-300 font-medium hover:bg-purple-400 dark:bg-purple-600 dark:text-white dark:hover:bg-purple-700",children:[(0,n.jsx)(f.Z,{className:"mr-2 h-4 w-4"}),"Edit"]}),(0,n.jsx)(S.Z,{className:"ml-2 flex h-9 w-9 items-center justify-center rounded-full bg-transparent transition hover:text-sky-900 dark:text-white dark:hover:text-sky-300",onClick:()=>V(!0),"aria-label":"Show QR Code",title:"Show QR Code",style:{padding:0,border:"none",boxShadow:"none",background:"none"},children:(0,n.jsx)(v.Z,{className:"h-5 w-5"})}),(0,n.jsx)(I.Z,{mode:"button",active:!0,context:"app",appSubdomain:$})]})]}),(0,n.jsx)("div",{className:"flex items-center",children:(0,n.jsxs)(tg.h_,{children:[(0,n.jsx)(tg.$F,{asChild:!0,children:(0,n.jsx)(L.z,{variant:"ghost",className:"h-9 w-9 p-0",children:(0,n.jsx)(y.Z,{className:"h-4 w-4"})})}),(0,n.jsxs)(tg.AW,{className:"w-48 rounded-lg border-2 border-black bg-white p-0 shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] dark:border-black dark:bg-slate-800 dark:shadow-[2px_2px_0px_0px_rgba(0,0,0,1)]",children:[(0,n.jsx)(tg.Xi,{onClick:tr,className:"cursor-pointer px-3 py-2 text-black hover:bg-yellow-200 dark:text-white dark:hover:bg-purple-700",children:U?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(k.Z,{className:"mr-2 h-4 w-4"}),tt("builder.actions.copied")]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(w.Z,{className:"mr-2 h-4 w-4"}),tt("builder.actions.shareApp")]})}),Q&&(0,n.jsxs)(n.Fragment,{children:[Q.schema&&(0,n.jsxs)(tg.Xi,{onClick:()=>Z(!0),className:"cursor-pointer px-3 py-2 text-black hover:bg-yellow-200 dark:text-white dark:hover:bg-purple-700",children:[(0,n.jsx)(_.Z,{className:"mr-2 h-4 w-4"}),tt("builder.actions.updateLink")]}),(0,n.jsxs)(tg.Xi,{onClick:()=>W(!0),className:"cursor-pointer px-3 py-2 text-red-600 hover:bg-red-100 dark:text-red-400 dark:hover:bg-red-900",children:[(0,n.jsx)(j.Z,{className:"mr-2 h-4 w-4"}),tt("builder.actions.delete")]})]})]})]})})]})}),(0,n.jsx)(D.nU,{value:"chat",className:"m-0 h-full overflow-auto dark:text-gray-200 md:hidden",forceMount:!0,hidden:"chat"!==c,children:(0,n.jsx)(eE,{isVisible:!0,isSmallScreen:P,widthPercentage:100,messages:ee,input:z,setInput:F,error:eo,onSend:e=>ec(e),onVoiceInput:e4,setCreatedLoops:ex,setActiveLoopId:ef,setActiveTab:A,userProfile:l,streaming:ed("gatherReqs","generateHtml","finalize"),imageErrorQueue:eF,onRestoreVersion:eu,onFixResponse:em,onSelectImage:eQ,getAppUrl:K,appId:null==Q?void 0:Q.id,confirmStepTransition:e_,cancelStepTransition:e3,progress:ei,selectedElement:eA,clearSelectedElement:eO,elementEditingMode:eL})}),(0,n.jsx)(D.nU,{value:"schema",className:"m-0 flex-1 overflow-auto dark:text-gray-200",forceMount:!0,hidden:"schema"!==c,children:(0,n.jsx)("div",{className:"h-full",children:en.length?(0,n.jsx)("div",{className:"p-6",children:(0,n.jsx)(G,{questions:en,handleSubmit:ey})}):er?(0,n.jsx)("div",{className:"p-6",children:(0,n.jsx)(eU,{data:ea,description:er,onUpdate:eN,streaming:ed("createSchema","gatherReqs")})}):(0,n.jsx)("div",{className:"bg-radial-dots flex h-full items-center justify-center dark:bg-gray-900",children:(0,n.jsxs)("div",{className:"border-2 border-black bg-white p-8 text-center shadow-[8px_8px_0px_0px_rgba(0,0,0,1)] dark:border-gray-600 dark:bg-gray-800 dark:shadow-[8px_8px_0px_0px_rgba(75,85,99,1)]",children:[(0,n.jsx)(m.Z,{className:"mx-auto mb-4 h-12 w-12 dark:text-gray-200"}),(0,n.jsx)("p",{className:"text-lg font-bold text-black dark:text-gray-200",children:tt("builder.emptyStates.description")})]})})})}),(0,n.jsx)(D.nU,{value:"design",className:"m-0 flex-1 overflow-auto dark:text-gray-200",forceMount:!0,hidden:"design"!==c,children:(0,n.jsx)(tc,{preview:null!=et?et:"",designView:O,updateHtml:ep,streaming:ed("gatherReqs","generateHtml","finalize","updateHtml"),messages:ee,elementEditingMode:eL,onElementSelected:e=>{try{var t;(null===(t=e.data)||void 0===t?void 0:t.type)==="element-selected"&&eI(e.data.payload)}catch(e){console.error("Couldn't handle iframe element selection",e)}},onImageError:e=>{try{eW(e)}catch(e){console.error("Couldn't handle iframe image error",e)}},onOtherError:e=>{try{eS(e.data)}catch(e){console.error("Couldn't handle iframe error",e)}},onIframeReady:X})}),(0,n.jsx)(D.nU,{value:"loops",className:"m-0 flex-1 overflow-auto p-0",forceMount:!0,hidden:"loops"!==c,children:eb&&te?(0,n.jsx)(C.Z,{loop:te.loop,initLoopGen:te.loopGen,refetchOnLoad:!0,onPublish:()=>ev(te.loop.id),showChat:!1,autoGen:!0},eb):(null==eg?void 0:eg.length)?(0,n.jsx)(eM,{loops:eg.map(e=>e.loop),handleLoopSelect:e=>ef(e)}):(0,n.jsx)("div",{className:"bg-radial-dots flex h-full items-center justify-center dark:bg-gray-900",children:(0,n.jsxs)("div",{className:"border-2 border-black bg-white p-8 text-center shadow-[8px_8px_0px_0px_rgba(0,0,0,1)] dark:border-gray-600 dark:bg-gray-800 dark:shadow-[8px_8px_0px_0px_rgba(75,85,99,1)]",children:[(0,n.jsx)(x.Z,{className:"mx-auto mb-4 h-12 w-12 dark:text-gray-200"}),(0,n.jsx)("p",{className:"text-lg font-bold text-black dark:text-gray-200",children:tt("builder.emptyStates.loops")})]})})})]})})]}),(()=>{var e,t;let r=(null==eP?void 0:null===(e=eP.payload)||void 0===e?void 0:e.alt)||"web design";return(0,n.jsx)(eG,{isOpen:eR,onClose:()=>eH(!1),onSelectImage:e0,searchQuery:r,progress:eq,totalErrors:eF.length,currentErrorIndex:eB,currentErrorSrc:null==eP?void 0:null===(t=eP.payload)||void 0===t?void 0:t.src})})(),Q&&(ek||H)&&(0,n.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70",children:(0,n.jsxs)("div",{className:"relative w-full max-w-lg rounded-lg border-4 border-black bg-white p-0 shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] dark:border-cyan-500 dark:bg-[#2a2a2a] dark:shadow-[4px_4px_0px_0px_rgba(6,182,212,1)]",children:[(0,n.jsx)("button",{className:"absolute right-4 top-4 text-2xl font-bold text-black hover:opacity-80 dark:text-white",onClick:()=>{ek&&ew(!1),H&&Z(!1)},"aria-label":tt("builder.modals.close"),children:"\xd7"}),ek&&"done"===Q.state?(0,n.jsx)(tw,{open:!0,onClose:()=>ew(!1),onViewLayout:()=>{window.open(K(),"_blank"),ew(!1)},app:Q,toast:o}):(0,n.jsx)(th,{app:Q,toast:o,onCancel:()=>Z(!1),variant:"modal"})]})}),(0,n.jsx)(tx.Z,{isOpen:B,onClose:()=>W(!1),onConfirm:e5,itemType:"app",itemName:null==Q?void 0:null===(t=Q.schema)||void 0===t?void 0:t.appName}),J&&(0,n.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70",children:(0,n.jsxs)("div",{className:"relative w-full max-w-xs rounded-lg border-4 border-black bg-white p-6 shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] dark:border-cyan-500 dark:bg-[#2a2a2a] dark:shadow-[4px_4px_0px_0px_rgba(6,182,212,1)]",children:[(0,n.jsx)("button",{className:"absolute right-4 top-4 text-2xl font-bold text-black hover:opacity-80 dark:text-white",onClick:()=>V(!1),"aria-label":"Close QR Code Modal",children:"\xd7"}),(0,n.jsxs)("div",{className:"flex flex-col items-center",children:[(0,n.jsx)(tk.ZP,{value:K(),size:200}),(0,n.jsx)("div",{className:"mt-4 text-center text-sm text-black dark:text-white",children:"Scan to open this app on your phone"})]})]})})]})}var tN=r(88943),tE=!0,tC=function(e){let{user:t}=e,{t:r}=(0,s.Z)("common");return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(l(),{children:[(0,n.jsx)("title",{children:"Magic Loops"}),(0,n.jsx)("meta",{name:"description",content:"Loops"}),(0,n.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,n.jsxs)(o.Z,{activeMenuItem:"loops",breadcrumbs:[{label:r("nav.dashboard"),href:"/dashboard"},{label:"App Builder"}],containedScroll:!0,footerPadding:!1,children:[(0,n.jsx)(tj,{user:t}),(0,n.jsx)(tN.H,{})]})]})}},4901:function(e,t,r){"use strict";r.d(t,{AO:function(){return o},Ae:function(){return n},Am:function(){return m},GK:function(){return g},SC:function(){return s},Tr:function(){return a},U1:function(){return f},c_:function(){return h},de:function(){return x},fl:function(){return c},ih:function(){return u},kD:function(){return l},m2:function(){return b},mF:function(){return i},zD:function(){return p}});let n=["time","sms-trigger","whatsapp-trigger","email-trigger","hook","api-trigger"],a=["scrape","code","llm","perplexity","fetch","exit-if","diff","update-var","image-generation","user-block","google-sheets"],l=["email","sms","whatsapp","hook-notify","api-notify"],s=e=>{for(let t of l)if(e.type===t)return!0;return!1};[...n,...a,...l];let o=["GET","POST","PUT","PATCH","DELETE"],i=["python","javascript"],d="HINT: Use the `Generate` button to write code for you!\n",c={python:"# ".concat(d,'print(f"Hello World from: {BLOCK_INPUT}")\n'),javascript:"// ".concat(d,"console.log(`HELLO WORLD from ${BLOCK_INPUT}`);\n")},p={python:"# ".concat(d,'\nif int(BLOCK_INPUT) > int(PREVIOUS_BLOCK_INPUT):\n    print("Greater than previous run")\nelse:\n    print("Less than or equal to previous run")')},u=["sonar","sonar-reasoning"],m=["fast","simple","advanced"],h=["markdown","text","html"],g=["extractus","none","readableText"],x=["exact","regExp","code"],b=["read","update","append","clear","create"],f=()=>({id:"user-block-".concat(Date.now()),type:"user-block",outputName:"userBlockOutput",code:c.javascript,language:"javascript",version:"1.0.0",config:{variables:{}},inputSchema:{fields:{input:{type:"string",label:"Input",description:"Default input field",required:!0,validation:{maxLength:1e3}}}}})},32014:function(e,t,r){"use strict";r.d(t,{Af:function(){return b},Es:function(){return S},HL:function(){return d},Jd:function(){return u},Jz:function(){return y},Sb:function(){return i},ZH:function(){return v},bj:function(){return D},h_:function(){return j},ig:function(){return I},jS:function(){return h},mR:function(){return p},nF:function(){return c},s4:function(){return k},sz:function(){return f},ue:function(){return _},wZ:function(){return M},x3:function(){return g},xW:function(){return m},zm:function(){return A}});var n=r(61861),a=r(4901),l=r(42390),s=r(78301),o=r(30836);let i=[{pretty:"+1 (248) 422-2414 - Troy, MI",e164:"+12484222414"},{pretty:"+1 (415) 909-5435 - San Francisco, CA",e164:"+14159095435"},{pretty:"+1 (213) 616-7868 - Los Angeles, CA",e164:"+12136167868"},{pretty:"+1 (929) 565-6420 - New York City, NY",e164:"+19295656420"},{pretty:"+1 (417) 744-6969 - Billings, MO",e164:"+14177446969"}],d=i[0].e164,c=[{pretty:"+1 (248) 422-2414 - Magic Loops (WhatsApp)",e164:"+12484222414"},{pretty:"+1 (415) 909-5435 - Magic Loops (WhatsApp #2)",e164:"+14159095435"}],p=c[0].e164,u=e=>{for(let t of a.Ae)if(e.type===t)return!0;return!1},m=(e,t,r,s,u)=>{var m,h,g,x;let b=w(null!==(m=null==t?void 0:t.blocks)&&void 0!==m?m:[],r),f=d;for(let e of null!==(h=null==t?void 0:t.blocks)&&void 0!==h?h:[]){let t=f;if("sms-trigger"===e.type)t=e.toNumber;else{if("sms"!==e.type)continue;t=e.from}if(i.some(e=>e.e164===t)){f=t;break}}let v=p;for(let e of null!==(g=null==t?void 0:t.blocks)&&void 0!==g?g:[]){let t=v;if("whatsapp-trigger"===e.type)t=e.toNumber;else{if("whatsapp"!==e.type)continue;t=e.from}if(c.some(e=>e.e164===t)){v=t;break}}let y=(0,n.Z)();switch(r){case"time":return{id:y,outputName:b,type:"time",cron:"30 7 * * *",description:"Run every day at 7:30am",timezone:null!=s?s:(0,o.EP)()};case"hook":return{id:y,outputName:b,description:"Run every time the Loop's webhook is called",type:"hook",hookUrl:(0,l.U_)(t.id)};case"email-trigger":return{id:y,outputName:b,description:"Run every time the Loop is emailed",type:"email-trigger",emailAddress:(0,l.Ov)(t.id)};case"sms-trigger":return{id:y,outputName:b,description:"Run every time the Loop is texted",type:"sms-trigger",toNumber:f,fromNumber:""};case"whatsapp-trigger":return{id:y,outputName:b,description:"Run every time the Loop is messaged on WhatsApp",type:"whatsapp-trigger",toNumber:f,fromNumber:""};case"api-trigger":return{id:y,outputName:b,description:null!=u?u:"Run every time the Loop's API is called",type:"api-trigger"};case"api-notify":return{id:y,outputName:b,description:null!=u?u:"Send the last block's output as the API response",type:"api-notify",response:"$BLOCK_INPUT"};case"fetch":return{id:y,outputName:b,type:"fetch",description:null!=u?u:"Get the weather for San Francisco",url:"https://api.openweathermap.org/data/2.5/weather?q=San%20Francisco&units=imperial",method:"GET",headers:"",body:""};case"code":return{id:y,outputName:b,type:"code",language:a.mF[0],description:u||'Print "Hello World from: <input>" to the console',code:a.fl[a.mF[0]]};case"llm":return{id:y,outputName:b,type:"llm",description:null!=u?u:"Write a haiku about:\n$BLOCK_INPUT",jsonMode:!1,history:!1,example:"An old silent pond\nA frog jumps into the pond,\nsplash! Silence again."};case"perplexity":return{id:y,outputName:b,type:"perplexity",description:null!=u?u:"What are the latest news headlines from the BBC World News today?"};case"scrape":return{id:y,outputName:b,type:"scrape",description:null!=u?u:"Scrape Hacker News",mode:"fast",url:"https://news.ycombinator.com/"};case"exit-if":return{id:y,outputName:b,type:"exit-if",description:null!=u?u:"Exit the Loop if input is greater than 0.5",code:"# HINT: Use the Loop Creator (above) to write code for you!\nreturn float(BLOCK_INPUT) > 0.5",mode:"code"};case"diff":return{id:y,outputName:b,description:null!=u?u:"Find differences in input compared to the last run",type:"diff",language:"python",code:a.zD.python};case"update-var":return{id:y,outputName:b,description:null!=u?u:"Update the Loop Variable 'TEST' with \"Hello World\" (must already exist)",type:"update-var",key:"TEST",newVal:"Hello World"};case"email":return{id:y,outputName:b,type:"email",description:null!=u?u:"Send an email with the Loop results",to:null!==(x=null==e?void 0:e.email)&&void 0!==x?x:"",subject:"Magic Loop Result",content:"Hi! Here's your Magic Loop result:\n$BLOCK_INPUT"};case"sms":return{id:y,outputName:b,type:"sms",description:null!=u?u:"Send a text with the Loop results",from:f,to:"",content:"Hi! Here's your Magic Loop result:\n$BLOCK_INPUT"};case"whatsapp":return{id:y,outputName:b,type:"whatsapp",description:"Send a WhatsApp message with the Loop results",from:v,content:"$BLOCK_INPUT"};case"hook-notify":return{id:y,outputName:b,type:"hook-notify",description:"Send a webhook with the Loop Results to the Magic Loops Discord",url:"https://discord.com/api/webhooks/1176663170379685959/z2IVVVb5DdkQOywKLrZzyHZ0vx5WfnzPpEojqGGsl4gZ3D3NlqieCNNOcvn5YjI_TYYb",headers:'{ "Content-Type": "application/json" }',body:'{ "content": "Magic Loop results: $BLOCK_INPUT", "username": "Magic Loops Example Webhook" }'};case"image-generation":return{id:y,outputName:b,type:"image-generation",description:null!=u?u:"Generate an image based on a prompt",prompt:"A mystical and ethereal digital art of infinite interlocking loops and symbols, representing magic and infinite possibilities.",model:"gpt-image-1",n:1,size:"1024x1024",quality:"medium"};case"user-block":let k=(0,a.U1)();return k.id=y,k.outputName=b,u?k.description=u:k.description="Execute a custom user-defined block",k;case"google-sheets":return{id:y,outputName:b,type:"google-sheets",operation:"read",description:u||"Interact with Google Sheets data",spreadsheetId:"",range:"A1:E10",suggestedSpreadsheetName:""};default:throw Error("Unknown block type: ".concat(r))}},h=function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return"time"===e?"Time"+(t?" Trigger":""):"email-trigger"===e?"Email"+(t?" Trigger":""):"sms-trigger"===e?"Text Message"+(t?" Trigger":""):"whatsapp-trigger"===e?"WhatsApp Message"+(t?" Trigger":""):"hook"===e?"Webhook"+(t?" Trigger":""):"api-trigger"===e?"API Call"+(t?" \uD83D\uDE87":""):"api-notify"===e?"API Response"+(t?" \uD83D\uDE87":""):"fetch"===e?"Fetch"+(t?" \uD83D\uDDDD️":""):"code"===e?"Code"+(t?" </>":""):"llm"===e?"LLM"+(t?" \uD83E\uDE84":""):"perplexity"===e?"Perplexity Search"+(t?" \uD83C\uDF10":""):"scrape"===e?"Scrape"+(t?" \uD83D\uDD0E":""):"exit-if"===e?"Exit"+(t?" ?":""):"diff"===e?"Diff"+(t?" ⚖️":""):"update-var"===e?"Update Variable"+(t?" \uD83D\uDCBE":""):"email"===e?"Send Email"+(t?" \uD83D\uDCEB":""):"sms"===e?"Send Text"+(t?" \uD83D\uDCAC":""):"whatsapp"===e?"Send WhatsApp"+(t?" \uD83D\uDCAC":""):"hook-notify"===e?"Send Webhook"+(t?" \uD83C\uDF0E":""):"image-generation"===e?"Generate Image"+(t?" \uD83D\uDDBC️":""):"user-block"===e?"User Block"+(t?" \uD83E\uDDD1‍\uD83D\uDCBB":""):"google-sheets"===e?"Google Sheets"+(t?" \uD83D\uDCCA":""):"Misc"},g=e=>{var t;return"sms"!==e.type&&("email"!==e.type||null!==(t=e.markdown)&&void 0!==t&&t)},x=e=>"email-trigger"!==e&&"hook"!==e,b=e=>x(e)&&"sms-trigger"!==e&&"whatsapp-trigger"!==e,f=e=>"time"===e?"When should this Loop run?":"What should this ".concat(h(e,!1)," block do?"),v=e=>!x(e)||"time"===e||"api-trigger"===e||"sms"===e||"whatsapp"===e||"sms-trigger"===e||"whatsapp-trigger"===e,y=e=>!u(e)||"api-trigger"===e.type,k=e=>"time"===e?"The time the Loop was ran will appear here...":"hook"===e?"Webhook body will appear here...":"sms-trigger"===e?"Text message contents will appear here...":"whatsapp-trigger"===e?"WhatsApp message contents will appear here...":"email-trigger"===e?"Email body will appear here...":"api-trigger"===e?"API request body will appear here...":"fetch"===e?"API response...":"code"===e?"Code output...":"llm"===e?"LLM reply...":"perplexity"===e?"Perplexity reply...":"api-notify"===e?"API response to send to caller...":"".concat(h(e,!1)," result..."),w=(e,t)=>{let r=t.toUpperCase().replaceAll("-","_"),n="".concat(r,"_BLOCK_OUTPUT"),a=1;for(;e.some(e=>e.outputName===n);)a++,n="".concat(r,"_BLOCK_OUTPUT_").concat(a);return n},_=(e,t)=>{var r;let a=w(null!==(r=null==e?void 0:e.blocks)&&void 0!==r?r:[],t.type),l=(0,n.Z)();return{...t,id:l,outputName:a}},j=(e,t)=>{var r;let a=w(null!==(r=null==e?void 0:e.blocks)&&void 0!==r?r:[],t.type),l=(0,n.Z)();return{...t,id:l,outputName:a}},N=/\$([A-Z0-9_]+)((?:\.(?:[A-Za-z_$][\w$-]*|\d+)|\[['"][A-Za-z0-9_$-]{1,64}['"]\]|\[\d+\])*)/g,E=/(?:\.([A-Za-z_$][\w$-]*|\d+)|\[(?:'([A-Za-z0-9_$-]{1,64})'|"([A-Za-z0-9_$-]{1,64})"|(\d+))\])/gy,C=new Set(["__proto__","prototype","constructor"]);function S(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"none";if(!t)return n;if(t.length>64e3)throw Error("placeholder input too large");let a=Object.fromEntries(r.map(e=>[e.key.toUpperCase(),e.value]));return t.replace(N,(r,l,o)=>{let i=a[l];o&&(i=D(i));let d=function(e,t){if(t.length>4096)return;if(""===t)return e;E.lastIndex=0;let r=e,n;for(;n=E.exec(t);){var a,l,s;let[,e,t,o,i]=n,d=null!==(l=null!==(a=null!=e?e:t)&&void 0!==a?a:o)&&void 0!==l?l:void 0!==i?Number(i):void 0;if(s=String(d),C.has(s)||null==r||!L(r,d))return;let c=Object.getOwnPropertyDescriptor(r,d);if(c&&("function"==typeof c.get||"function"==typeof c.set))return;r=r[d]}return r}(i,o);if(null==d&&(d=n),"url"===e)return r===t.trim()?String(d):encodeURIComponent(String(d));if("json"===e){let e=(0,s.tC)(t,r);return r===t.trim()?("string"==typeof d&&(d=D(d)),JSON.stringify(d)):e?(0,s.ss)(String(d),n):"string"==typeof d?(0,s.Vx)(d)?d:'"'.concat((0,s.ss)(d,n),'"'):JSON.stringify(d)}return String(d)})}let L=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),D=e=>{if("string"==typeof e){let t=e.trim();if(t.startsWith("{")&&t.endsWith("}")||t.startsWith("[")&&t.endsWith("]"))try{e=JSON.parse(t)}catch(e){}}if("object"==typeof e&&null!==e){if("function"==typeof structuredClone)return structuredClone(e);let t=e=>{if(Array.isArray(e))return e.map(t);if(e&&"object"==typeof e){let r=Object.create(null);for(let n of Object.keys(e)){let a=Object.getOwnPropertyDescriptor(e,n);"value"in a&&(r[n]=t(a.value))}return r}return e};return t(e)}return e},I=e=>{var t;let r=[{key:"BLOCK_INPUT",value:e.blockInput},{key:"LOOP_INPUT",value:e.loopInput},...null!==(t=e.otherVars)&&void 0!==t?t:[]];if(e.loopVariables)for(let t of e.loopVariables)t.key&&r.push({key:t.key,value:t.value});return r};function A(e){return void 0!==e.language}let O={time:203956,scrape:89112,llm:216075,email:161942,code:276962,"exit-if":52901,sms:156921,fetch:96213,diff:12380,"api-trigger":46267,"api-notify":46545,"hook-notify":15468,hook:16190,"api-request":1473,"api-response":1473,"email-trigger":881,"update-var":28021,whatsapp:2368,notify:104,"sms-trigger":372,perplexity:7387,"whatsapp-trigger":14};function M(e){var t;return null!==(t=O[e])&&void 0!==t?t:0}},48192:function(e){e.exports={svg:"LoadingBoxes_svg__VtdP2",rect:"LoadingBoxes_rect__6TCVc",fade:"LoadingBoxes_fade__vCUgA",rect1:"LoadingBoxes_rect1__Wio2e",rect2:"LoadingBoxes_rect2__0ltfW",rect3:"LoadingBoxes_rect3__bMHUa",rect4:"LoadingBoxes_rect4__BmyXs",rect5:"LoadingBoxes_rect5__LICpu",rect6:"LoadingBoxes_rect6__S_1al",rect7:"LoadingBoxes_rect7__Y_IPE",rect8:"LoadingBoxes_rect8__M_9UT",rect9:"LoadingBoxes_rect9__WNCJb"}}},function(e){e.O(0,[3662,9225,5762,7182,5909,3686,7518,3209,8362,1791,3319,2027,1020,2904,4308,3373,8087,8977,6841,5833,7073,3603,6054,8025,8125,2170,9008,1942,2888,9774,179],function(){return e(e.s=60824)}),_N_E=e.O()}]);