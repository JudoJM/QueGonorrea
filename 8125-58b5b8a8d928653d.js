"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8125],{50141:function(e,t,o){o.d(t,{s:function(){return r}});var n=o(71248),a=o(72904);let r=(0,n.memo)(a.UG)},27019:function(e,t,o){var n=o(74817),a=o(38829),r=o.n(a);o(71248);var l=o(36497);t.Z=e=>{let{className:t,sizeMultiplier:o=1,animate:a,disableClick:i}=e,s=(0,l.useRouter)();return(0,n.jsx)("h1",{className:"".concat(r().variable," select-none font-title ").concat(o<=1?"py-6":"py-8"," overflow text-center leading-none ").concat(a?"":"text-gray-800 dark:text-white"," ").concat(i?"cursor-default":"cursor-pointer"," ").concat(t||""),onClick:()=>{i||s.push("/")},style:a?{background:"linear-gradient(90deg, black, black, black, black, black, black, black, black, red, orange, green, blue, indigo, black, black, black, black, black, black, black, black)",backgroundSize:"300% auto",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",animation:"rainbow 6s ease-in-out",fontSize:3.75*o+"rem"}:{fontSize:3.75*o+"rem"},children:"magic loops"})}},81173:function(e,t,o){var n=o(74817),a=o(71248),r=o(65414),l=o(2002);let i=a.forwardRef((e,t)=>{let{children:o,className:a,...i}=e;return(0,n.jsx)(r.z,{variant:"outline",className:(0,l.cn)("flex items-center justify-center\n          rounded-none border-2 border-black bg-slate-300 px-2 py-1\n          font-medium text-black shadow-[2px_2px_0_0_rgba(0,0,0,1)] transition-all\n          hover:text-black\n          enabled:hover:translate-x-[1px] enabled:hover:translate-y-[1px]\n          enabled:hover:bg-slate-400 enabled:hover:shadow-[1px_1px_0_0_rgba(0,0,0,1)]\n          disabled:opacity-50",a),ref:t,...i,children:o})});i.displayName="NeoButton",t.Z=i},12957:function(e,t,o){var n=o(74817),a=o(71248),r=o(2002);let l=a.forwardRef((e,t)=>{let{className:o,label:a,id:l,...i}=e;return(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("input",{ref:t,id:l,type:"checkbox",className:(0,r.cn)("h-4 w-4 cursor-pointer rounded-none border-2 border-black bg-white p-2 shadow-[2px_2px_0_0_rgba(0,0,0,1)] outline-none transition-all hover:translate-x-[1px] hover:translate-y-[1px] hover:shadow-[1px_1px_0_0_rgba(0,0,0,1)] enabled:hover:outline-none",o),...i}),a&&(0,n.jsx)("label",{htmlFor:l,className:"ml-2 cursor-pointer",children:a})]})});l.displayName="NeoCheckbox",t.Z=l},7988:function(e,t,o){var n=o(74817),a=o(71248),r=o(2002);let l=(0,a.forwardRef)((e,t)=>{let{className:o,...a}=e;return(0,n.jsx)("input",{ref:t,className:(0,r.cn)("cursor-text rounded-none border-2 border-black bg-white p-2 text-sm text-black shadow-[2px_2px_0_0_rgba(0,0,0,1)] outline-none transition-all dark:bg-[#212121] dark:text-white/80",o),...a})});l.displayName="NeoInput",t.Z=l},75334:function(e,t,o){var n=o(74817),a=o(71248),r=o(2002);let l=(0,a.forwardRef)((e,t)=>{let{children:o,className:a,...l}=e;return(0,n.jsx)("label",{ref:t,className:(0,r.cn)("text-black/80 dark:text-white/80",a),...l,children:o})});l.displayName="NeoLabel",t.Z=l},91835:function(e,t,o){var n=o(74817);o(71248),t.Z=e=>{let{children:t,className:o="",content:a,disabled:r,hoverTimeMs:l}=e;return(0,n.jsx)("div",{className:"inline-block ".concat(o),"data-tooltip-delay-show":"long"===l?1e3:"short"===l?500:"none"===l?0:l,"data-tooltip-id":"tooltip","data-tooltip-content":r?void 0:a,"data-tooltip-class-name":"z-[1000]",children:t})}},34880:function(e,t,o){o.d(t,{Ol:function(){return i},SZ:function(){return u},Zb:function(){return l},aY:function(){return c},eW:function(){return d},ll:function(){return s}});var n=o(74817),a=o(71248),r=o(2002);let l=a.forwardRef((e,t)=>{let{className:o,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,r.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",o),...a})});l.displayName="Card";let i=a.forwardRef((e,t)=>{let{className:o,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",o),...a})});i.displayName="CardHeader";let s=a.forwardRef((e,t)=>{let{className:o,...a}=e;return(0,n.jsx)("h3",{ref:t,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",o),...a})});s.displayName="CardTitle";let u=a.forwardRef((e,t)=>{let{className:o,...a}=e;return(0,n.jsx)("p",{ref:t,className:(0,r.cn)("text-sm text-muted-foreground",o),...a})});u.displayName="CardDescription";let c=a.forwardRef((e,t)=>{let{className:o,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,r.cn)("p-6 pt-0",o),...a})});c.displayName="CardContent";let d=a.forwardRef((e,t)=>{let{className:o,...a}=e;return(0,n.jsx)("div",{ref:t,className:(0,r.cn)("flex items-center p-6 pt-0",o),...a})});d.displayName="CardFooter"},19760:function(e,t,o){o.d(t,{Hh:function(){return k},N3:function(){return v},Iu:function(){return w},uW:function(){return m}});var n=o(32014),a=o(42390),r=o(20117),l=o(82681);let i=async()=>{try{let e=await fetch("/api/phone/defaultNumber",{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));return(await e.json()).defaultNumber}catch(e){throw console.error("Error fetching default number:",e),Error("Failed to fetch default number")}},s=async()=>{try{let e=await fetch("/api/whatsapp/defaultWhatsAppNumber",{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));return(await e.json()).defaultWhatsAppNumber}catch(e){throw console.error("Error fetching default number:",e),Error("Failed to fetch default number")}};var u=o(74870),c=o(63063),d=o(29386),p=o(78301);class f{constructor(e,t,o,a,r){this.curBlockIndex=-1,this.streamRaw="",this.overwriteLoop=e=>{this.responseLoop=e,this.streamLoop(this.responseLoop,null)},this.emitEvent=e=>{var t,o,a,r,l,i,s,u;if("error"===e.type)throw Error(e.data);if("overwrite"===e.type)e.data.loop&&(this.responseLoop=e.data.loop),e.data.blockResults&&(this.responseLoop.testRunResult={blockResults:e.data.blockResults});else if("start"===e.type){if(this.curRunRes&&(this.curRunRes.status="success"),this.action=e.data.action,this.streamRaw="","msg"===this.action)this.streamRaw=null!==(t=e.data.content)&&void 0!==t?t:"",this.message={role:"ai",type:null!==(o=e.data.type)&&void 0!==o?o:"text",content:this.streamRaw,blockId:e.data.blockId},this.streamMessage(this.message,!1,!1);else{if(this.curBlockIndex=this.responseLoop.blocks.findIndex(t=>t.id===e.data.blockId),this.curBlockIndex<0)throw Error("Got reference to an unknown block (start)");"run"===this.action&&(this.responseLoop.testRunResult||(this.responseLoop.testRunResult={blockResults:{}}),this.curRunRes=this.responseLoop.testRunResult.blockResults[e.data.blockId],this.curRunRes.status="running")}}else if("end"===e.type)"msg"===this.action&&this.message&&this.streamMessage(this.message,!0,!0);else if("output"===e.type){if(this.curBlockIndex<0)throw Error("Got output to an unknown block (".concat(this.action,")"));let t=this.responseLoop.blocks[this.curBlockIndex];if("gen"===this.action||"fix"===this.action){this.streamRaw+=null!==(a=e.data.stdout)&&void 0!==a?a:"";let o=function(e){let t=(0,p.OA)(e);if(t){for(let e in t){let o=t[e];if(!("image-generation"===t.type&&"inputImages"===e&&Array.isArray(o))){if("api-trigger"===t.type&&"files"===e&&Array.isArray(o))continue;if("user-block"===t.type&&("inputSchema"===e||"config"===e||"exampleInputValues"===e)&&"object"==typeof o&&null!==o)continue;("object"==typeof o&&null!==o||Array.isArray(o))&&(t[e]=JSON.stringify(o))}}return"user-block"===t.type&&(t=function(e){if("user-block"!==e.type)throw Error("Block is not a user-block");return e.inputSchema&&"object"==typeof e.inputSchema||(e.inputSchema={fields:{}}),e.inputSchema.fields&&"object"==typeof e.inputSchema.fields||(e.inputSchema.fields={}),e.config&&"object"==typeof e.config||(e.config={variables:{}}),e.config.variables&&"object"==typeof e.config.variables||(e.config.variables={}),Object.keys(e.config.variables).forEach(t=>{let o=e.config.variables[t];"object"==typeof o&&null!==o&&(void 0===o.value&&(o.value=""),void 0===o.label&&(o.label=t),void 0===o.description&&(o.description=""),void 0===o.required&&(o.required=!1),void 0===o.public&&(o.public=!0))}),e.code&&"string"==typeof e.code||(e.code='// Generated code here\nconsole.log("UserBlock executed");'),e.language&&"string"==typeof e.language||(e.language="javascript"),e}(t)),t}}(this.streamRaw);if(o){if(o.id=t.id,o.type=t.type,o.description=t.description,o.outputName=t.outputName,"code"===o.type);else if("diff"===o.type);else if("user-block"===o.type){if(o.suggestedName&&o.suggestedName.trim()){o.blockName=o.suggestedName;let e=(0,p.LW)(o.suggestedName);o.outputName=e||o.outputName,delete o.suggestedName}}else"sms"===o.type&&"sms"===t.type?t.to||(o.to=this.userDefaultPhoneNumber):"whatsapp"===o.type&&"whatsapp"===t.type?t.to||(o.to=this.userDefaultWhatsAppNumber):"sms-trigger"===o.type&&"sms-trigger"===t.type?(t.fromNumber||(o.fromNumber=this.userDefaultPhoneNumber),o.toNumber||(o.toNumber=n.HL)):"whatsapp-trigger"!==o.type||"whatsapp-trigger"!==t.type||(t.fromNumber||(o.fromNumber=this.userDefaultWhatsAppNumber),o.toNumber||(o.toNumber=n.mR));this.responseLoop.blocks[this.curBlockIndex]={...t,...o}}}else if("msg"===this.action)this.streamRaw+=null!==(l=e.data.stdout)&&void 0!==l?l:"",this.message={role:"ai",type:null!==(i=null===(r=this.message)||void 0===r?void 0:r.type)&&void 0!==i?i:"text",content:this.streamRaw,blockId:t.id},this.streamMessage(this.message,!0,!1);else if("run"===this.action){if(!this.curRunRes)throw Error("Got output to an unknown block (".concat(this.action,")"));this.curRunRes.stdout+=null!==(s=e.data.stdout)&&void 0!==s?s:"",this.curRunRes.stderr+=null!==(u=e.data.stderr)&&void 0!==u?u:""}}let c=-1===this.curBlockIndex?null:{blockId:this.responseLoop.blocks[this.curBlockIndex].id,output:"output"===e.type};this.streamLoop(this.responseLoop,c)},this.close=()=>{this.streamLoop(this.responseLoop,null)},this.responseLoop=e,this.streamMessage=t,this.streamLoop=o,this.userDefaultPhoneNumber=a,this.userDefaultWhatsAppNumber=r}}var b=o(90335),h=o(30836);let k=3,m=async(e,t,o,n,p,b)=>{let h;let m=e=>{S.signal.aborted||n(e)},v=e=>{S.signal.aborted||p(e)},O=(e,t,o)=>{S.signal.aborted||b(e,t,o)},S=new AbortController,I=(0,r.eL)(o);m(I);let B=await i(),L=await s(),C=new f(I.loop,async(e,t,o)=>{O({...e},t,o)},async e=>{I.loop=e,I.loop&&v((0,a.p$)(I.loop))},B,L),j=async()=>{S.signal.aborted||"running"!==I.status||(I.error=void 0,I.status="pausing",m(I),h&&await h,I.status="paused",m(I))},T=async e=>{let t=!1;if(!S.signal.aborted){if("running"===I.status)return h;if("pausing"===I.status&&await h,"done"!==I.status){try{let{loop:e}=await (0,u.gk)(I.loop.id);e&&_(e,!0)}catch(e){(0,c.q)("Warning: Could not fetch fresh loop state before resume:",e)}"paused"===I.status&&(I.status="running",t=!0),"fix"===e?(I.numFixesOnBlock=0,I.blockStatus="block-fix",t=!0):"rerun"===e?(I.blockResult=void 0,I.numFixesOnBlock=0,I.blockStatus="block-run",t=!0):"next"===e&&(P(),t=!0),t&&(I.error=void 0,m(I)),await D()}}},E=async e=>{var o;if(S.signal.aborted)return;if((0,r.lU)(I))throw new r.Om("Can't create a new Loop while the Loop creator is running");(0,c.q)("CREATING LOOP FROM OUTLINE...");let n=null!==(o=await g(S.signal,t,e))&&void 0!==o?o:void 0;I.error=void 0,I.loop=n,m(I),C.overwriteLoop(I.loop)},_=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!S.signal.aborted){if((0,r.lU)(I))throw new r.Om("Can't set the Loop while the Loop creator is running");if(t||JSON.stringify(e.variables)===JSON.stringify(I.loop.variables)){let a="";for(let u=0;u<I.curBlockIndex;u++){var o,n,l,i,s;let c=e.blocks[u],d=I.loop.blocks[u],p=null===(n=e.testRunResult)||void 0===n?void 0:null===(o=n.blockResults)||void 0===o?void 0:o[c.id],f=null===(i=I.loop.testRunResult)||void 0===i?void 0:null===(l=i.blockResults)||void 0===l?void 0:l[d.id];if(!t&&(JSON.stringify(c)!==JSON.stringify(d)||JSON.stringify(p)!==JSON.stringify(f))){(I=(0,r.eL)(e)).status="paused",I.curBlockIndex=u,I.blockStatus="block-gen",I.blockInput=a;break}a=null!==(s=null==p?void 0:p.stdout)&&void 0!==s?s:""}}else I=(0,r.eL)(e);C.overwriteLoop((0,a.p$)(e)),I.error=void 0,m(I)}},F=async(e,t,o)=>{var n,a,l,i,s,u;if(S.signal.aborted)return;if((0,c.q)("STATUS",I.status),(0,r.lU)(I))throw new r.Om("Can't update a Block while the Loop Creator is running");let d=I,p=(0,r.eL)(o),f=Math.max(e-1,0),b=null===(a=o.blocks)||void 0===a?void 0:null===(n=a[f])||void 0===n?void 0:n.id;switch(p.status="running",p.curBlockIndex=e,p.blockInput=null!==(u=null===(s=o.testRunResult)||void 0===s?void 0:null===(i=s.blockResults)||void 0===i?void 0:null===(l=i[b])||void 0===l?void 0:l.stdout)&&void 0!==u?u:"",t){case"gen":p.blockStatus="block-gen";break;case"fix":p.blockStatus="block-fix"}switch(I=p,C.overwriteLoop(I.loop),m(I),t){case"gen":h=(async()=>{"block-gen"===I.blockStatus&&await W(!0),"block-run"===I.blockStatus&&await W(!0)})(),await h;break;case"fix":h=(async()=>{"block-fix"===I.blockStatus&&await W(!0),"block-run"===I.blockStatus&&await W(!0)})(),await h}d.loop=I.loop,d.error=void 0,I=d,C.overwriteLoop(I.loop),m(I)},q=async function(e,t,o){var n,l,i,s;let c=!(arguments.length>3)||void 0===arguments[3]||arguments[3];(0,r.lU)(I)&&await j();let d=[...o.blocks];d.splice(e,0,t);let p={...o,blocks:d};await (0,u.Ot)(p),C.overwriteLoop((0,a.p$)(p)),I.loop=p,I.error=void 0,I.status="paused",I.curBlockIndex=e,I.blockStatus="block-gen",I.numFixesOnBlock=0;let f=d[Math.max(e-1,0)].id;I.blockInput=null!==(s=null===(i=p.testRunResult)||void 0===i?void 0:null===(l=i.blockResults)||void 0===l?void 0:null===(n=l[f])||void 0===n?void 0:n.stdout)&&void 0!==s?s:"",m(I),c&&await T()},A=async()=>{!S.signal.aborted&&(0,r.lU)(I)&&(0,l._$)(e,"generate loop",{reason:"killed",genId:t}),S.abort(),h&&await h},P=()=>{if(I.curBlockIndex+1<I.loop.blocks.length){var o,n;I.blockInput=null!==(n=null===(o=I.blockResult)||void 0===o?void 0:o.stdout)&&void 0!==n?n:"",I.blockResult=void 0,I.curBlockIndex++,I.numFixesOnBlock=0,I.blockStatus="block-gen"}else I.status="done",I.blockStatus=void 0,(0,l.S_)(e,"generate loop",{genId:t}),N(C,S.signal,t)},U=e=>function(){for(var t=arguments.length,o=Array(t),n=0;n<t;n++)o[n]=arguments[n];try{let t=e(...o);if(t instanceof Promise)return t.catch(e=>{J(e)});return t}catch(e){J(e)}},J=o=>{if(S.signal.aborted)return;let n=o instanceof r.Om?o:new r.Om((0,d.f0)(o),!1,o);n.resumeable?I.status="paused":(I.status="done",I.blockStatus=void 0),I.error=n,m(I),(0,l.gT)(e,"generate loop",{error:n.message,genId:t,resumeable:n.resumeable},!n.resumeable)},D=async()=>{h=(async()=>{do await W();while("running"===I.status&&!S.signal.aborted)})(),await h},M=async()=>{S.signal.aborted||("pausing"===I.status&&await h,("paused"===I.status||"not-started"===I.status)&&("paused"===I.status&&(I.status="running",m(I)),await W(),"running"===I.status&&(I.status="paused",m(I))))},W=async o=>{if(!S.signal.aborted){if("not-started"===I.status){var n,a,r,i,s,u;(0,l.fJ)(e,"generate loop",{genId:t}),I.status="running";let o=null===(a=I.loop.blocks)||void 0===a?void 0:null===(n=a[0])||void 0===n?void 0:n.id;I.blockInput=null!==(u=null===(s=I.loop.testRunResult)||void 0===s?void 0:null===(i=s.blockResults)||void 0===i?void 0:null===(r=i[o])||void 0===r?void 0:r.stdout)&&void 0!==u?u:"",I.curBlockIndex=0,I.numFixesOnBlock=0,I.blockStatus="block-gen",m(I)}if("running"===I.status&&I.blockStatus)switch(I.blockStatus){case"block-gen":await G(o),I.blockStatus="block-run";break;case"block-run":await z(),I.blockStatus="block-validate";break;case"block-validate":await Z()?I.blockStatus="block-fix":P();break;case"block-fix":await H(o),I.blockStatus="block-run"}"pausing"===I.status&&(I.status="paused"),m(I)}},G=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!I.loop)throw new r.Om("Could not find Loop");let t=I.loop.blocks[I.curBlockIndex];if(!t)throw new r.Om("Could not find block");(0,c.q)("BLOCK #".concat(I.curBlockIndex,"...")),(0,c.q)(t),(e||!w(t))&&((0,c.q)("...this block isn't complete, generating it"),await y(C,S.signal,I.loop.id,I.curBlockIndex,I.blockInput))},z=async()=>{var e,t;if(!I.loop)throw new r.Om("Could not find Loop");let o=I.loop.blocks[I.curBlockIndex];if(!o)throw new r.Om("Could not find block");(0,c.q)("...running ".concat(o.type," block with input: "),I.blockInput),await x(C,S.signal,I.loop.id,I.curBlockIndex,I.blockInput),I.blockResult=null===(t=I.loop.testRunResult)||void 0===t?void 0:null===(e=t.blockResults)||void 0===e?void 0:e[o.id],m(I)},Z=async()=>{if(!I.loop)throw new r.Om("Could not find Loop");let e=I.loop.blocks[I.curBlockIndex];if(!e)throw new r.Om("Could not find block");if("google-sheets"===e.type&&("append"===e.operation||"update"===e.operation)&&!e.spreadsheetId)throw new r.Om("Google Sheets block requires spreadsheet selection.",!0);let o="api-trigger"===e.type&&e.includeFileUpload&&(!e.exampleFiles||0===e.exampleFiles.length);if(!w(e)&&!o)throw new r.Om("Block isn't valid");(0,c.q)("...validating results:",null==I?void 0:I.blockResult);let n=await R(C,S.signal,I.loop.id,t,I.curBlockIndex,I.blockInput,I.numFixesOnBlock);if(!n)throw new r.Om("Could not validate block");if("correct"===n.decision)return!1;if((0,c.q)("...block failed:",n),"incorrect-needs-rewrite"===n.decision)throw new r.Om("Requesting to regenerate block #".concat(I.curBlockIndex+1,"."),!0);if("incorrect-needs-variable"===n.decision)throw new r.Om("Requesting variables for block #".concat(I.curBlockIndex+1,"."),!0);if("incorrect-needs-user-intervention"===n.decision)throw new r.Om("Ran into issue generating block #".concat(I.curBlockIndex+1,"."),!0);if("incorrect-needs-file-upload"===n.decision)throw new r.Om("Block #".concat(I.curBlockIndex+1," requires file uploads to continue."),!0);return!0},H=async e=>{if(!I.loop)throw new r.Om("Could not find Loop");if(!e&&I.numFixesOnBlock>=k)throw(0,c.q)("...bailing on fixing, too many attempts (".concat(I.numFixesOnBlock,")")),I.status="done",I.blockStatus=void 0,m(I),await (0,u.Ot)(I.loop),new r.Om("Ran into issue generating block #".concat(I.curBlockIndex+1,". The Loop Creator tried to fix it, but couldn't."));(0,c.q)("...attempting to fix"),I.numFixesOnBlock++,m(I),await y(C,S.signal,I.loop.id,I.curBlockIndex,I.blockInput)};return{start:U(async()=>{if(!S.signal.aborted){if((0,r.lU)(I))return h;I.error=void 0,I.status="not-started",m(I),await D()}}),pause:U(j),resume:U(T),runOneStep:U(M),setLoop:U(_),createLoop:U(E),updateBlock:U(F),addBlock:U(q),kill:U(A),creatorState:()=>I,clearError:()=>{I.error=void 0}}},g=async(e,t,o)=>{let n=await fetch("/api/loopCreator/outlineToLoop",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({genId:t,messageIndex:o,timezone:(0,h.EP)()}),signal:e});if(!n.ok)throw new r.Om(await n.text());let a=await n.json();if(!(null==a?void 0:a.loop))throw new r.Om("Could not create Loop from Outline");return a.loop},v=e=>null!=e&&!!e.type&&("api-trigger"!==e.type||!e.includeFileUpload),w=e=>{if(!(null==e?void 0:e.type))return!1;switch(e.type){case"time":return!!(null==e?void 0:e.cron);case"hook":return!!(null==e?void 0:e.hookUrl);case"email-trigger":return!!(null==e?void 0:e.emailAddress);case"sms-trigger":return!!(null==e?void 0:e.fromNumber)&&n.Sb.some(t=>t.e164===(null==e?void 0:e.toNumber));case"whatsapp-trigger":return!!(null==e?void 0:e.fromNumber)&&n.nF.some(t=>t.e164===(null==e?void 0:e.toNumber));case"api-trigger":if(null==e?void 0:e.includeFileUpload)return!!((null==e?void 0:e.exampleFiles)&&e.exampleFiles.length>0);return!0;case"api-notify":return!!(null==e?void 0:e.response);case"diff":return!!(null==e?void 0:e.code);case"llm":return!!(null==e?void 0:e.description)&&(null==e?void 0:e.example)!==void 0;case"perplexity":return!!(null==e?void 0:e.description)&&!!(null==e?void 0:e.prompt);case"exit-if":let t=null==e?void 0:e.mode;if("exact"===t)return(null==e?void 0:e.inputMatch)!==void 0;if("regExp"===t)return!!(null==e?void 0:e.regExp);if("code"===t)return!!(null==e?void 0:e.code);return!1;case"code":return!!(null==e?void 0:e.code)&&!!(null==e?void 0:e.language);case"user-block":return"user-block"===e.type&&!!(null==e?void 0:e.code)&&!!(null==e?void 0:e.language)&&!!(null==e?void 0:e.inputSchema)&&!!(null==e?void 0:e.config)&&"object"==typeof(null==e?void 0:e.inputSchema)&&"object"==typeof(null==e?void 0:e.inputSchema.fields)&&"object"==typeof(null==e?void 0:e.config)&&"object"==typeof(null==e?void 0:e.config.variables);case"fetch":case"scrape":case"hook-notify":return!!(null==e?void 0:e.url);case"whatsapp":case"email":case"sms":return!!(null==e?void 0:e.to)&&!!(null==e?void 0:e.content);case"update-var":return!!(null==e?void 0:e.key)&&(null==e?void 0:e.newVal)!==void 0;case"image-generation":return!!(null==e?void 0:e.prompt)&&!!(null==e?void 0:e.model)&&!!(null==e?void 0:e.size)&&!!(null==e?void 0:e.quality)&&(null==e?void 0:e.n)!==void 0&&(null==e?void 0:e.n)>=1&&(null==e?void 0:e.n)<=10;case"google-sheets":if(!(null==e?void 0:e.operation))return!1;if("create"===e.operation)return!!e.sheetTitle;if(("read"===e.operation||"clear"===e.operation)&&!e.spreadsheetId)return!1;if("update"===e.operation||"append"===e.operation)return!!e.values;return!0;default:return!1}},y=async(e,t,o,n,a)=>{let l=await fetch("/api/loopCreator/generateBlock",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({loopId:o,blockIndex:n,blockInput:a,timezone:(0,h.EP)()}),signal:t});if(!l.ok||!l.body)throw new r.Om(await l.text());let i=new b.M(t=>{e.emitEvent(t)}),s=!1,u=l.body.getReader(),c=new TextDecoder;for(;!s;){let e=await u.read(),t=c.decode(e.value,{stream:!0});i.ingestChunk(t,s),s=e.done}},x=async(e,t,o,n,a)=>{let l=await fetch("/api/loopCreator/runBlock",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({loopId:o,blockIndex:n,blockInput:a}),signal:t});if(!l.ok||!l.body)throw new r.Om(await l.text());let i=new b.M(t=>{e.emitEvent(t)}),s=!1,u=l.body.getReader(),c=new TextDecoder;for(;!s;){let e=await u.read(),t=c.decode(e.value,{stream:!0});i.ingestChunk(t,s),s=e.done}},R=async(e,t,o,n,a,l,i)=>{let s;let u=await fetch("/api/loopCreator/validateBlock",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({loopId:o,genId:n,blockIndex:a,blockInput:l,numFixesOnBlock:i,timezone:(0,h.EP)()}),signal:t});if(!u.ok||!u.body)throw new r.Om(await u.text());let c=new b.M(t=>{"metadata"===t.type?s=t.data:e.emitEvent(t)}),d=!1,p=u.body.getReader(),f=new TextDecoder;for(;!d;){let e=await p.read(),t=f.decode(e.value,{stream:!0});c.ingestChunk(t,d),d=e.done}return s},N=async(e,t,o)=>{let n;let a=await fetch("/api/loopCreator/success",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({genId:o}),signal:t});if(!a.ok||!a.body)throw new r.Om(await a.text());let l=new b.M(t=>{e.emitEvent(t)}),i=!1,s=a.body.getReader(),u=new TextDecoder;for(;!i;){let e=await s.read(),t=u.decode(e.value,{stream:!0});l.ingestChunk(t,i),i=e.done}return n}},63063:function(e,t,o){o.d(t,{q:function(){return a}});var n=o(71390);function a(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];"true"===n.env.NEXT_PUBLIC_DEBUG&&console.log("\x1b[31m%s\x1b[0m",t.map(e=>"object"==typeof e?JSON.stringify(e,null,2):e).join(" "))}}}]);